# Build Failure Analysis: 2025_05_02_patch_980

## First error

Overlapping replacements: ./services/device/usb/usb_descriptors_unittest.cc at offset 9924, length 26: "(kConfig2Descriptor.size() * sizeof(decltype(kConfig2Descriptor)::value_type))" and offset 9930, length 0: ".data()"

## Category
Overlapping replacements between RewriteArraySizeof and AppendDataCall.

## Reason
The rewriter attempted to apply two conflicting replacements to the same region of code. The first replacement was generated by the `RewriteArraySizeof` matcher, which rewrites `sizeof(kConfig2Descriptor)` to `(kConfig2Descriptor.size() * sizeof(decltype(kConfig2Descriptor)::value_type))`. The second replacement, generated by the `AppendDataCall` matcher, attempts to add `.data()` to `kConfig2Descriptor`. Because these replacements overlap, the rewriter fails. This means that the AppendDataCall occurred inside of RewriteArraySizeof.

## Solution
The rewriter should avoid applying both transformations to the same expression. It should prioritize adding `.data()` over rewriting `sizeof` when both transformations are applicable. One way to ensure this is to make the `AppendDataCall` matcher more specific to avoid triggering on code that will be rewritten by the `RewriteArraySizeof` matcher.

## Note
N/A