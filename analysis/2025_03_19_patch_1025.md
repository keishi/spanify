# Build Failure: 2025_03_19_patch_1025

## Chromium Revision

`ae47ae4e0c13026d1824b4cf4b9cea834dfd0cf4`

## Code Changes (Diff)

```diff
diff --git a/chrome/browser/devtools/device/adb/adb_client_socket.cc b/chrome/browser/devtools/device/adb/adb_client_socket.cc
index f74de49922e97..bd1f4c09ab9a9 100644
--- a/chrome/browser/devtools/device/adb/adb_client_socket.cc
+++ b/chrome/browser/devtools/device/adb/adb_client_socket.cc
@@ -272,7 +272,7 @@ void AdbClientSocket::OnResponseHeader(
     return;
   }
 
-  std::string data = std::string(response_buffer->data(), result);
+  std::string data = std::string(response_buffer->data().data(), result);
   if (result < 4) {
     std::move(callback).Run(net::ERR_FAILED, "Response is too short: " + data);
     return;
@@ -303,8 +303,8 @@ void AdbClientSocket::OnResponseData(
     return;
   }
 
-  std::string new_response = response +
-      std::string(response_buffer->data(), result);
+  std::string new_response =
+      response + std::string(response_buffer->data().data(), result);
 
   if (bytes_left == -1) {
     // First read the response header.
diff --git a/chrome/browser/devtools/device/android_device_manager.cc b/chrome/browser/devtools/device/android_device_manager.cc
index 2ec8d6eb138e7..987b01a916885 100644
--- a/chrome/browser/devtools/device/android_device_manager.cc
+++ b/chrome/browser/devtools/device/android_device_manager.cc
@@ -205,7 +205,7 @@ class HttpRequest {
     std::string request = base::StrCat(pieces);
     auto base_buffer =
         base::MakeRefCounted<net::IOBufferWithSize>(request.size());
-    memcpy(base_buffer->data(), request.data(), request.size());
+    memcpy(base_buffer->data().data(), request.data(), request.size());
     request_ = base::MakeRefCounted<net::DrainableIOBuffer>(
         std::move(base_buffer), request.size());
     timeout_timer_.Start(
@@ -240,7 +240,7 @@ class HttpRequest {
         return;
       }
 
-      response_.append(response_buffer_->data(), result);
+      response_.append(response_buffer_->data().data(), result);
 
       if (!headers) {
         header_size = response_.find("\r\n\r\n");
diff --git a/chrome/browser/devtools/device/android_web_socket.cc b/chrome/browser/devtools/device/android_web_socket.cc
index b09d0aff1b5a3..04340982c59f0 100644
--- a/chrome/browser/devtools/device/android_web_socket.cc
+++ b/chrome/browser/devtools/device/android_web_socket.cc
@@ -112,7 +112,7 @@ class AndroidDeviceManager::AndroidWebSocket::WebSocketImpl {
       Disconnect();
       return;
     }
-    response_buffer_.append(io_buffer->data(), result);
+    response_buffer_.append(io_buffer->data().data(), result);
 
     ProcessResponseBuffer(io_buffer);
   }
diff --git a/chrome/browser/devtools/device/usb/android_usb_socket.cc b/chrome/browser/devtools/device/usb/android_usb_socket.cc
index 9b50bed69f617..f1044bb5f909e 100644
--- a/chrome/browser/devtools/device/usb/android_usb_socket.cc
+++ b/chrome/browser/devtools/device/usb/android_usb_socket.cc
@@ -130,7 +130,7 @@ int AndroidUsbSocket::Read(net::IOBuffer* buffer,
 
   size_t bytes_to_copy = static_cast<size_t>(length) > read_buffer_.length() ?
       read_buffer_.length() : static_cast<size_t>(length);
-  memcpy(buffer->data(), read_buffer_.data(), bytes_to_copy);
+  memcpy(buffer->data().data(), read_buffer_.data(), bytes_to_copy);
   if (read_buffer_.length() > bytes_to_copy)
     read_buffer_ = read_buffer_.substr(bytes_to_copy);
   else
@@ -154,7 +154,7 @@ int AndroidUsbSocket::Write(
   write_callback_ = std::move(callback);
   write_length_ = length;
   device_->Send(AdbMessage::kCommandWRTE, local_id_, remote_id_,
-                std::string(buffer->data(), length));
+                std::string(buffer->data().data(), length));
   return net::ERR_IO_PENDING;
 }
 
@@ -241,7 +241,7 @@ void AndroidUsbSocket::RespondToReader(bool disconnect) {
   size_t bytes_to_copy =
       static_cast<size_t>(read_length_) > read_buffer_.length() ?
           read_buffer_.length() : static_cast<size_t>(read_length_);
-  memcpy(read_io_buffer_->data(), read_buffer_.data(), bytes_to_copy);
+  memcpy(read_io_buffer_->data().data(), read_buffer_.data(), bytes_to_copy);
   if (read_buffer_.length() > bytes_to_copy)
     read_buffer_ = read_buffer_.substr(bytes_to_copy);
   else
diff --git a/chrome/browser/devtools/device/usb/usb_device_provider.cc b/chrome/browser/devtools/device/usb/usb_device_provider.cc
index c6ab4cf3923a5..d1e91899312dc 100644
--- a/chrome/browser/devtools/device/usb/usb_device_provider.cc
+++ b/chrome/browser/devtools/device/usb/usb_device_provider.cc
@@ -45,7 +45,7 @@ void OnRead(net::StreamSocket* socket,
     return;
   }
 
-  std::string new_data = data + std::string(buffer->data(), result);
+  std::string new_data = data + std::string(buffer->data().data(), result);
   auto split_callback = base::SplitOnceCallback(
       base::BindOnce(&OnRead, socket, buffer, new_data, std::move(callback)));
   result =
diff --git a/chrome/browser/extensions/api/messaging/native_message_process_host.cc b/chrome/browser/extensions/api/messaging/native_message_process_host.cc
index 4f1cb27dff96f..3e4ee473ecb6a 100644
--- a/chrome/browser/extensions/api/messaging/native_message_process_host.cc
+++ b/chrome/browser/extensions/api/messaging/native_message_process_host.cc
@@ -196,7 +196,7 @@ void NativeMessageProcessHost::OnMessage(const std::string& json) {
   static_assert(sizeof(uint32_t) == kMessageHeaderSize,
                 "kMessageHeaderSize is incorrect");
   const uint32_t message_size = base::checked_cast<uint32_t>(json.size());
-  memcpy(buffer->data(), reinterpret_cast<const char*>(&message_size),
+  memcpy(buffer->data().data(), reinterpret_cast<const char*>(&message_size),
          kMessageHeaderSize);
 
   buffer->span()
diff --git a/chrome/browser/extensions/api/socket/tcp_socket_unittest.cc b/chrome/browser/extensions/api/socket/tcp_socket_unittest.cc
index 057129e9579c6..bdf7be054396a 100644
--- a/chrome/browser/extensions/api/socket/tcp_socket_unittest.cc
+++ b/chrome/browser/extensions/api/socket/tcp_socket_unittest.cc
@@ -95,7 +95,7 @@ class TCPSocketUnitTestBase : public extensions::ExtensionServiceTestBase {
       auto [net_error, io_buffer, socket_destroying] = read_future.Take();
       EXPECT_FALSE(socket_destroying);
       if (net_error > 0) {
-        received_data.append(io_buffer->data(), net_error);
+        received_data.append(io_buffer->data().data(), net_error);
       } else {
         break;
       }
@@ -288,7 +288,7 @@ TEST_P(TCPSocketUnitTest, SocketPartialRead) {
     auto [bytes_read, io_buffer, socket_destroying] = read_future.Take();
     EXPECT_FALSE(socket_destroying);
     if (bytes_read > 0) {
-      received_data.append(io_buffer->data(), bytes_read);
+      received_data.append(io_buffer->data().data(), bytes_read);
     } else {
       break;
     }
@@ -681,7 +681,8 @@ TEST_F(TCPSocketServerTest, ReadAndWrite) {
     auto [bytes_read, io_buffer_read, socket_destroying] = read_future.Take();
     ASSERT_GT(bytes_read, 0);
     EXPECT_FALSE(socket_destroying);
-    received_contents.append(std::string(io_buffer_read->data(), bytes_read));
+    received_contents.append(
+        std::string(io_buffer_read->data().data(), bytes_read));
   }
   EXPECT_EQ(kTestMsg, received_contents);
 
@@ -700,7 +701,8 @@ TEST_F(TCPSocketServerTest, ReadAndWrite) {
     auto [bytes_read, io_buffer_read, socket_destroying] = read_future.Take();
     ASSERT_GT(bytes_read, 0);
     EXPECT_FALSE(socket_destroying);
-    sent_contents.append(std::string(io_buffer_read->data(), bytes_read));
+    sent_contents.append(
+        std::string(io_buffer_read->data().data(), bytes_read));
   }
   EXPECT_EQ(kTestMsg, sent_contents);
 }
diff --git a/chrome/browser/extensions/api/socket/tls_socket_unittest.cc b/chrome/browser/extensions/api/socket/tls_socket_unittest.cc
index fe4d284e8819b..eb124a1050fa7 100644
--- a/chrome/browser/extensions/api/socket/tls_socket_unittest.cc
+++ b/chrome/browser/extensions/api/socket/tls_socket_unittest.cc
@@ -333,7 +333,7 @@ TEST_P(TLSSocketTest, ReadWrite) {
     auto [net_error, io_buffer, socket_destroying] = read_future.Take();
     EXPECT_FALSE(socket_destroying);
     if (net_error > 0) {
-      received_data.append(io_buffer->data(), net_error);
+      received_data.append(io_buffer->data().data(), net_error);
     } else {
       break;
     }
@@ -373,7 +373,7 @@ TEST_P(TLSSocketTest, PartialRead) {
     auto [net_error, io_buffer, socket_destroying] = read_future.Take();
     EXPECT_FALSE(socket_destroying);
     if (net_error > 0) {
-      received_data.append(io_buffer->data(), net_error);
+      received_data.append(io_buffer->data().data(), net_error);
     } else {
       break;
     }
diff --git a/chrome/browser/extensions/api/socket/udp_socket_unittest.cc b/chrome/browser/extensions/api/socket/udp_socket_unittest.cc
index f429646cc4f2e..d8ab36c674a13 100644
--- a/chrome/browser/extensions/api/socket/udp_socket_unittest.cc
+++ b/chrome/browser/extensions/api/socket/udp_socket_unittest.cc
@@ -168,7 +168,8 @@ static void OnMulticastReadCompleted(base::OnceClosure quit_run_loop,
                                      const std::string& ip,
                                      uint16_t port) {
   EXPECT_EQ(kTestMessageLength, count);
-  EXPECT_EQ(0, strncmp(io_buffer->data(), kTestMessage, kTestMessageLength));
+  EXPECT_EQ(
+      0, strncmp(io_buffer->data().data(), kTestMessage, kTestMessageLength));
   *packet_received = true;
   std::move(quit_run_loop).Run();
 }
diff --git a/chrome/browser/media/router/discovery/dial/dial_service_impl.cc b/chrome/browser/media/router/discovery/dial/dial_service_impl.cc
index 22e99aa6dcf29..ef3869f29d857 100644
--- a/chrome/browser/media/router/discovery/dial/dial_service_impl.cc
+++ b/chrome/browser/media/router/discovery/dial/dial_service_impl.cc
@@ -327,7 +327,7 @@ void DialServiceImpl::DialSocket::HandleResponse(int bytes_read) {
     return;
   }
 
-  std::string response(recv_buffer_->data(), bytes_read);
+  std::string response(recv_buffer_->data().data(), bytes_read);
   Time response_time = Time::Now();
 
   // Attempt to parse response, notify client if successful.
diff --git a/chrome/browser/media/router/discovery/dial/dial_service_impl_unittest.cc b/chrome/browser/media/router/discovery/dial/dial_service_impl_unittest.cc
index a2cbc9746eebe..68208d703ede3 100644
--- a/chrome/browser/media/router/discovery/dial/dial_service_impl_unittest.cc
+++ b/chrome/browser/media/router/discovery/dial/dial_service_impl_unittest.cc
@@ -167,7 +167,8 @@ TEST_F(DialServiceImplTest, TestOnDeviceDiscovered) {
   int response_size = std::size(kValidResponse) - 1;
   dial_socket_->recv_buffer_ =
       base::MakeRefCounted<net::IOBufferWithSize>(response_size);
-  strncpy(dial_socket_->recv_buffer_->data(), kValidResponse, response_size);
+  strncpy(dial_socket_->recv_buffer_->data().data(), kValidResponse,
+          response_size);
   dial_socket_->recv_address_ =
       net::IPEndPoint(net::IPAddress::IPv4Localhost(), 12345);
 
diff --git a/chrome/browser/media_galleries/fileapi/readahead_file_stream_reader.cc b/chrome/browser/media_galleries/fileapi/readahead_file_stream_reader.cc
index c1fcb2f085494..949f1a61fede2 100644
--- a/chrome/browser/media_galleries/fileapi/readahead_file_stream_reader.cc
+++ b/chrome/browser/media_galleries/fileapi/readahead_file_stream_reader.cc
@@ -81,8 +81,9 @@ int ReadaheadFileStreamReader::FinishReadFromCacheOrStoredError(
 
     int copy_len = std::min(source_buffer->BytesRemaining(),
                             sink->BytesRemaining());
-    std::copy(source_buffer->data(), source_buffer->data() + copy_len,
-              sink->data());
+    std::copy(source_buffer->data().data(),
+              source_buffer->data().subspan(copy_len).data(),
+              sink->data().data());
 
     source_buffer->DidConsume(copy_len);
     sink->DidConsume(copy_len);
diff --git a/chrome/test/chromedriver/net/adb_client_socket.cc b/chrome/test/chromedriver/net/adb_client_socket.cc
index 730ccfc87ea34..17b960c194a8e 100644
--- a/chrome/test/chromedriver/net/adb_client_socket.cc
+++ b/chrome/test/chromedriver/net/adb_client_socket.cc
@@ -196,7 +196,7 @@ class HttpOverAdbSocket {
       return;
     }
 
-    response_ += std::string(response_buffer->data(), result);
+    response_ += std::string(response_buffer->data().data(), result);
     int expected_length = 0;
     if (bytes_total < 0) {
       size_t content_pos = response_.find("Content-Length:");
@@ -572,7 +572,7 @@ void AdbClientSocket::ReadStatusOutput(
   // Sometimes adb-server responds with the 8 char string "OKAY\0\0\0\0" instead
   // of the expected "OKAY".
   if (socket_result >= 4 &&
-      std::string(socket_buffer->data(), 4) == kOkayResponse) {
+      std::string(socket_buffer->data().data(), 4) == kOkayResponse) {
     response_callback.Run(kAdbSuccess, kOkayResponse);
     return;
   }
diff --git a/chrome/test/chromedriver/net/adb_client_socket_unittest.cc b/chrome/test/chromedriver/net/adb_client_socket_unittest.cc
index e82c952df8231..caa63004e7660 100644
--- a/chrome/test/chromedriver/net/adb_client_socket_unittest.cc
+++ b/chrome/test/chromedriver/net/adb_client_socket_unittest.cc
@@ -54,11 +54,12 @@ class MockSocket : public net::MockClientSocket {
     }
     int chunk_length = return_values_array.front().length();
     if (chunk_length > buf_len) {
-      strncpy(buf->data(), return_values_array.front().data(), buf_len);
+      strncpy(buf->data().data(), return_values_array.front().data(), buf_len);
       return_values_array.front() = return_values_array.front().substr(buf_len);
       return buf_len;
     }
-    strncpy(buf->data(), return_values_array.front().data(), chunk_length);
+    strncpy(buf->data().data(), return_values_array.front().data(),
+            chunk_length);
     return_values_array = return_values_array.subspan<1>();
     if (chunk_length == 0) {
       return net::ERR_IO_PENDING;
@@ -110,7 +111,7 @@ class AdbClientSocketTest : public testing::Test {
     scoped_refptr<net::GrowableIOBuffer> buffer =
         base::MakeRefCounted<net::GrowableIOBuffer>();
     buffer->SetCapacity(100);
-    strcpy(buffer->data(), data_on_buffer);
+    strcpy(buffer->data().data(), data_on_buffer);
     buffer->set_offset(strlen(data_on_buffer));
 
     adb_socket.ReadUntilEOF(parse_callback.Get(), response_callback.Get(),
@@ -180,7 +181,7 @@ class AdbClientSocketTest : public testing::Test {
     int initial_capacity = 100;
     buffer->SetCapacity(initial_capacity);
     if (result > 0) {
-      strncpy(buffer->data(), buffer_data, result);
+      strncpy(buffer->data().data(), buffer_data, result);
     }
     AdbClientSocket::ReadStatusOutput(response_callback.Get(), buffer, result);
   }
diff --git a/chrome/test/chromedriver/net/pipe_reader_posix.cc b/chrome/test/chromedriver/net/pipe_reader_posix.cc
index dbfcdb0760fe7..a6069e9238cc8 100644
--- a/chrome/test/chromedriver/net/pipe_reader_posix.cc
+++ b/chrome/test/chromedriver/net/pipe_reader_posix.cc
@@ -137,7 +137,7 @@ void PipeReaderPosix::OnFileCanReadWithoutBlocking(int fd) {
 void PipeReaderPosix::OnFileCanWriteWithoutBlocking(int fd) {}
 
 int PipeReaderPosix::DoRead(net::IOBuffer* buf, int buf_len) {
-  int rv = HANDLE_EINTR(read(fd_.get(), buf->data(), buf_len));
+  int rv = HANDLE_EINTR(read(fd_.get(), buf->data().data(), buf_len));
   if (rv == 0) {
     return net::ERR_CONNECTION_CLOSED;
   }
diff --git a/chrome/test/chromedriver/net/pipe_reader_posix_unittest.cc b/chrome/test/chromedriver/net/pipe_reader_posix_unittest.cc
index 5fdb5cf9d7158..e977caf8cee8d 100644
--- a/chrome/test/chromedriver/net/pipe_reader_posix_unittest.cc
+++ b/chrome/test/chromedriver/net/pipe_reader_posix_unittest.cc
@@ -85,8 +85,8 @@ class PipeReaderPosixTest : public testing::Test {
       if (rv <= 0) {
         break;
       }
-      received_message.insert(received_message.end(), buffer->data(),
-                              buffer->data() + rv);
+      received_message.insert(received_message.end(), buffer->data().data(),
+                              buffer->data().subspan(rv).data());
     }
     return std::make_pair(std::move(received_message), rv);
   }
diff --git a/chrome/test/chromedriver/net/pipe_writer_posix.cc b/chrome/test/chromedriver/net/pipe_writer_posix.cc
index 76cbbe6688903..c92ac4abe645b 100644
--- a/chrome/test/chromedriver/net/pipe_writer_posix.cc
+++ b/chrome/test/chromedriver/net/pipe_writer_posix.cc
@@ -91,7 +91,7 @@ int PipeWriterPosix::WaitForWrite(net::IOBuffer* buf,
 }
 
 int PipeWriterPosix::DoWrite(net::IOBuffer* buf, int buf_len) {
-  int rv = HANDLE_EINTR(write(fd_.get(), buf->data(), buf_len));
+  int rv = HANDLE_EINTR(write(fd_.get(), buf->data().data(), buf_len));
   if (rv >= 0) {
     CHECK_LE(rv, buf_len);
   }
diff --git a/chrome/test/chromedriver/net/pipe_writer_posix_unittest.cc b/chrome/test/chromedriver/net/pipe_writer_posix_unittest.cc
index 1312ffdb04588..b098893a0a294 100644
--- a/chrome/test/chromedriver/net/pipe_writer_posix_unittest.cc
+++ b/chrome/test/chromedriver/net/pipe_writer_posix_unittest.cc
@@ -43,12 +43,12 @@ std::pair<std::string, int> ReadAll(base::File read_pipe) {
       base::MakeRefCounted<net::IOBufferWithSize>(4096);
   int rv = 0;
   while (true) {
-    rv = read_pipe.ReadAtCurrentPos(buffer->data(), buffer->size());
+    rv = read_pipe.ReadAtCurrentPos(buffer->data().data(), buffer->size());
     if (rv <= 0) {
       break;
     }
-    received_message.insert(received_message.end(), buffer->data(),
-                            buffer->data() + rv);
+    received_message.insert(received_message.end(), buffer->data().data(),
+                            buffer->data().subspan(rv).data());
   }
   return std::make_pair(std::move(received_message), rv);
 }
@@ -69,7 +69,7 @@ int WriteAll(std::unique_ptr<PipeWriterPosix> writer, std::string message) {
     int written = 0;
     int count = std::min(buffer->size(), to_send - sent);
     std::copy(std::next(message.begin(), sent),
-              std::next(message.begin(), sent + count), buffer->data());
+              std::next(message.begin(), sent + count), buffer->data().data());
     rv = writer->Write(
         buffer.get(), count,
         base::BindOnce(callback, run_loop.QuitClosure(), &written));
diff --git a/components/cronet/cronet_url_request.cc b/components/cronet/cronet_url_request.cc
index 6cccca847c463..7059211b30246 100644
--- a/components/cronet/cronet_url_request.cc
+++ b/components/cronet/cronet_url_request.cc
@@ -153,7 +153,7 @@ void CronetURLRequest::FollowDeferredRedirect() {
 bool CronetURLRequest::ReadData(net::IOBuffer* raw_read_buffer, int max_size) {
   // TODO(crbug.com/40847077): Change to DCHECK() or remove after bug
   // is fixed.
-  CHECK(max_size == 0 || (raw_read_buffer && raw_read_buffer->data()));
+  CHECK(max_size == 0 || (raw_read_buffer && !raw_read_buffer->data().empty()));
 
   scoped_refptr<net::IOBuffer> read_buffer(raw_read_buffer);
   context_->PostTaskToNetworkThread(
diff --git a/components/domain_reliability/uploader_unittest.cc b/components/domain_reliability/uploader_unittest.cc
index 44192e50f6989..864fca7001c16 100644
--- a/components/domain_reliability/uploader_unittest.cc
+++ b/components/domain_reliability/uploader_unittest.cc
@@ -87,7 +87,8 @@ class UploadMockURLRequestJob : public net::URLRequestJob {
   void OnStreamRead(int rv) {
     EXPECT_EQ(upload_buffer_->size(), rv);
 
-    upload_data_ = std::string(upload_buffer_->data(), upload_buffer_->size());
+    upload_data_ =
+        std::string(upload_buffer_->data().data(), upload_buffer_->size());
     upload_buffer_ = nullptr;
 
     if (result_.net_error == net::OK) {
diff --git a/components/download/internal/common/download_file_unittest.cc b/components/download/internal/common/download_file_unittest.cc
index 3133a28a492bd..80b57948b03e9 100644
--- a/components/download/internal/common/download_file_unittest.cc
+++ b/components/download/internal/common/download_file_unittest.cc
@@ -357,7 +357,7 @@ class DownloadFileTest : public testing::Test {
       const char* source_data = data_chunks[i];
       size_t length = strlen(source_data);
       auto data = base::MakeRefCounted<net::IOBufferWithSize>(length);
-      memcpy(data->data(), source_data, length);
+      memcpy(data->data().data(), source_data, length);
       EXPECT_CALL(*input_stream, Read(_, _))
           .InSequence(s)
           .WillOnce(DoAll(SetArgPointee<0>(data), SetArgPointee<1>(length),
diff --git a/components/grpc_support/bidirectional_stream.cc b/components/grpc_support/bidirectional_stream.cc
index a2ac5373b817d..3b6c9ae8b7fcf 100644
--- a/components/grpc_support/bidirectional_stream.cc
+++ b/components/grpc_support/bidirectional_stream.cc
@@ -237,7 +237,7 @@ void BidirectionalStream::OnDataSent() {
   std::vector<char*> buffer_ptrs;
   for (const scoped_refptr<net::IOBuffer>& buffer :
        sending_write_data_->buffers()) {
-    buffer_ptrs.push_back(buffer->data());
+    buffer_ptrs.push_back(buffer->data().data());
   }
   sending_write_data_->Clear();
 
diff --git a/components/media_router/common/providers/cast/channel/cast_socket_unittest.cc b/components/media_router/common/providers/cast/channel/cast_socket_unittest.cc
index ac3dd7de3e038..2bd629b90f6e8 100644
--- a/components/media_router/common/providers/cast/channel/cast_socket_unittest.cc
+++ b/components/media_router/common/providers/cast/channel/cast_socket_unittest.cc
@@ -1095,8 +1095,8 @@ TEST_F(SslCastSocketTest, MAYBE_TestConnectEndToEndWithRealSSL) {
                              server_socket_.get());
 
   EXPECT_EQ(challenge_buffer_length, read);
-  EXPECT_EQ(challenge_str,
-            std::string(challenge_buffer->data(), challenge_buffer_length));
+  EXPECT_EQ(challenge_str, std::string(challenge_buffer->data().data(),
+                                       challenge_buffer_length));
 
   // Set low-level auth reply expectations.
   CastMessage reply = CreateAuthReply();
@@ -1135,8 +1135,8 @@ TEST_F(SslCastSocketTest, DISABLED_TestMessageEndToEndWithRealSSL) {
                              server_socket_.get());
 
   EXPECT_EQ(challenge_buffer_length, read);
-  EXPECT_EQ(challenge_str,
-            std::string(challenge_buffer->data(), challenge_buffer_length));
+  EXPECT_EQ(challenge_str, std::string(challenge_buffer->data().data(),
+                                       challenge_buffer_length));
 
   // Set low-level auth reply expectations.
   CastMessage reply = CreateAuthReply();
@@ -1174,8 +1174,8 @@ TEST_F(SslCastSocketTest, DISABLED_TestMessageEndToEndWithRealSSL) {
                          server_socket_.get());
 
   EXPECT_EQ(test_message_length, read);
-  EXPECT_EQ(test_message_str,
-            std::string(test_message_buffer->data(), test_message_length));
+  EXPECT_EQ(test_message_str, std::string(test_message_buffer->data().data(),
+                                          test_message_length));
 
   EXPECT_EQ(ReadyState::OPEN, socket_->ready_state());
   EXPECT_EQ(ChannelError::NONE, socket_->error_state());
diff --git a/components/openscreen_platform/net_udp_socket.cc b/components/openscreen_platform/net_udp_socket.cc
index 733bf2d3da0be..7e40dfde42b05 100644
--- a/components/openscreen_platform/net_udp_socket.cc
+++ b/components/openscreen_platform/net_udp_socket.cc
@@ -80,8 +80,8 @@ bool NetUdpSocket::HandleRecvFromResult(int result) {
 
   DCHECK_GT(result, 0);
 
-  openscreen::UdpPacket packet(read_buffer_->data(),
-                               read_buffer_->data() + result);
+  openscreen::UdpPacket packet(read_buffer_->data().data(),
+                               read_buffer_->data().subspan(result).data());
   packet.set_source(openscreen_platform::ToOpenScreenEndPoint(from_address_));
   client_->OnRead(this, std::move(packet));
   return true;
@@ -179,7 +179,7 @@ void NetUdpSocket::SendMessage(openscreen::ByteView data,
   }
 
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(data.size());
-  memcpy(buffer->data(), data.data(), data.size());
+  memcpy(buffer->data().data(), data.data(), data.size());
 
   const int result = udp_socket_.SendTo(
       buffer.get(), data.size(), openscreen_platform::ToNetEndPoint(dest),
diff --git a/components/services/storage/service_worker/service_worker_resource_ops.cc b/components/services/storage/service_worker/service_worker_resource_ops.cc
index 971a6324d93f8..ce9d23695247c 100644
--- a/components/services/storage/service_worker/service_worker_resource_ops.cc
+++ b/components/services/storage/service_worker/service_worker_resource_ops.cc
@@ -516,7 +516,7 @@ void ServiceWorkerResourceReaderImpl::DidReadHttpResponseInfo(
 
   // Deserialize the http info structure, ensuring we got headers.
   base::Pickle pickle = base::Pickle::WithUnownedBuffer(base::as_bytes(
-      base::span(buffer->data(), base::checked_cast<size_t>(status))));
+      base::span(buffer->data().data(), base::checked_cast<size_t>(status))));
   auto http_info = std::make_unique<net::HttpResponseInfo>();
   bool response_truncated = false;
   if (!http_info->InitFromPickle(pickle, &response_truncated) ||
diff --git a/components/webrtc/fake_ssl_client_socket.cc b/components/webrtc/fake_ssl_client_socket.cc
index 445c358fd3f11..25400f56f333c 100644
--- a/components/webrtc/fake_ssl_client_socket.cc
+++ b/components/webrtc/fake_ssl_client_socket.cc
@@ -103,7 +103,8 @@ FakeSSLClientSocket::FakeSSLClientSocket(
       write_buf_(NewDrainableIOBufferWithSize(std::size(kSslClientHello))),
       read_buf_(NewDrainableIOBufferWithSize(std::size(kSslServerHello))) {
   CHECK(transport_socket_.get());
-  std::memcpy(write_buf_->data(), kSslClientHello, std::size(kSslClientHello));
+  std::memcpy(write_buf_->data().data(), kSslClientHello,
+              std::size(kSslClientHello));
 }
 
 FakeSSLClientSocket::~FakeSSLClientSocket() = default;
@@ -309,7 +310,7 @@ net::Error FakeSSLClientSocket::ProcessVerifyServerHelloDone(size_t read) {
   const uint8_t* expected_data_start =
       &kSslServerHello[std::size(kSslServerHello) -
                        read_buf_->BytesRemaining()];
-  if (std::memcmp(expected_data_start, read_buf_->data(), read) != 0) {
+  if (std::memcmp(expected_data_start, read_buf_->data().data(), read) != 0) {
     return net::ERR_UNEXPECTED;
   }
   if (read < static_cast<size_t>(read_buf_->BytesRemaining())) {
diff --git a/content/browser/cache_storage/cache_storage_blob_to_disk_cache_unittest.cc b/content/browser/cache_storage/cache_storage_blob_to_disk_cache_unittest.cc
index 16b267d3853eb..db81582fe8b6e 100644
--- a/content/browser/cache_storage/cache_storage_blob_to_disk_cache_unittest.cc
+++ b/content/browser/cache_storage/cache_storage_blob_to_disk_cache_unittest.cc
@@ -156,7 +156,7 @@ class CacheStorageBlobToDiskCacheTest : public testing::Test {
                                          buffer.get(), buffer->size(),
                                          base::DoNothing());
     EXPECT_EQ(bytes_to_read, rv);
-    return std::string(buffer->data(), bytes_to_read);
+    return std::string(buffer->data().data(), bytes_to_read);
   }
 
   bool Stream() {
diff --git a/content/browser/cache_storage/cache_storage_cache.cc b/content/browser/cache_storage/cache_storage_cache.cc
index cf93bcd69ba29..f0a7612c6834c 100644
--- a/content/browser/cache_storage/cache_storage_cache.cc
+++ b/content/browser/cache_storage/cache_storage_cache.cc
@@ -402,7 +402,7 @@ void ReadMetadataDidReadMetadata(disk_cache::Entry* entry,
 
   std::unique_ptr<proto::CacheMetadata> metadata(new proto::CacheMetadata());
 
-  if (!metadata->ParseFromArray(buffer->data(), buffer->size())) {
+  if (!metadata->ParseFromArray(buffer->data().data(), buffer->size())) {
     std::move(callback).Run(nullptr);
     return;
   }
diff --git a/content/browser/cache_storage/cache_storage_cache_unittest.cc b/content/browser/cache_storage/cache_storage_cache_unittest.cc
index c1d304735100e..a6d3cb8609c2e 100644
--- a/content/browser/cache_storage/cache_storage_cache_unittest.cc
+++ b/content/browser/cache_storage/cache_storage_cache_unittest.cc
@@ -1978,7 +1978,7 @@ TEST_P(CacheStorageCacheTestP, WriteSideData_QuotaExceeded) {
 
   const size_t kSize = 1024 * 1024;
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   EXPECT_FALSE(
       WriteSideData(no_body_request_->url, response_time, buffer, kSize));
   EXPECT_EQ(CacheStorageError::kErrorQuotaExceeded, callback_error_);
@@ -1998,7 +1998,7 @@ TEST_P(CacheStorageCacheTestP, WriteSideData_QuotaManagerModified) {
 
   const size_t kSize = 10;
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   EXPECT_TRUE(
       WriteSideData(no_body_request_->url, response_time, buffer, kSize));
   base::RunLoop().RunUntilIdle();
@@ -2014,7 +2014,7 @@ TEST_P(CacheStorageCacheTestP, WriteSideData_DifferentTimeStamp) {
 
   const size_t kSize = 10;
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   EXPECT_FALSE(WriteSideData(no_body_request_->url,
                              response_time + base::Seconds(1), buffer, kSize));
   EXPECT_EQ(CacheStorageError::kErrorNotFound, callback_error_);
@@ -2024,7 +2024,7 @@ TEST_P(CacheStorageCacheTestP, WriteSideData_DifferentTimeStamp) {
 TEST_P(CacheStorageCacheTestP, WriteSideData_NotFound) {
   const size_t kSize = 10;
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   EXPECT_FALSE(WriteSideData(GURL("http://www.example.com/not_exist"),
                              base::Time::Now(), buffer, kSize));
   EXPECT_EQ(CacheStorageError::kErrorNotFound, callback_error_);
diff --git a/content/browser/cache_storage/cache_storage_dispatcher_host.cc b/content/browser/cache_storage/cache_storage_dispatcher_host.cc
index 73a886dfa7fbc..5372a68da74ec 100644
--- a/content/browser/cache_storage/cache_storage_dispatcher_host.cc
+++ b/content/browser/cache_storage/cache_storage_dispatcher_host.cc
@@ -627,7 +627,7 @@ class CacheStorageDispatcherHost::CacheImpl
 
     auto buf = base::MakeRefCounted<net::IOBufferWithSize>(data.size());
     if (data.size())
-      memcpy(buf->data(), data.data(), data.size());
+      memcpy(buf->data().data(), data.data(), data.size());
 
     cache->WriteSideData(std::move(callback), url, expected_response_time,
                          trace_id, std::move(buf), data.size());
diff --git a/content/browser/devtools/devtools_stream_blob.cc b/content/browser/devtools/devtools_stream_blob.cc
index 6017c0edccb92..4c7cd620e8313 100644
--- a/content/browser/devtools/devtools_stream_blob.cc
+++ b/content/browser/devtools/devtools_stream_blob.cc
@@ -202,10 +202,11 @@ void DevToolsStreamBlob::OnReadComplete(int bytes_read) {
     status = blob_reader_->remaining_bytes() ? StatusSuccess : StatusEOF;
     if (is_binary_) {
       base64_encoded = true;
-      *data = base::Base64Encode(std::string_view(io_buf_->data(), bytes_read));
+      *data = base::Base64Encode(
+          std::string_view(io_buf_->data().data(), bytes_read));
     } else {
       // TODO(caseq): truncate at UTF8 boundary.
-      *data = std::string(io_buf_->data(), bytes_read);
+      *data = std::string(io_buf_->data().data(), bytes_read);
     }
   }
   GetUIThreadTaskRunner({})->PostTask(
diff --git a/content/browser/file_system/file_system_url_loader_factory.cc b/content/browser/file_system/file_system_url_loader_factory.cc
index b5d2eeb0d5387..f14e35b10dc2a 100644
--- a/content/browser/file_system/file_system_url_loader_factory.cc
+++ b/content/browser/file_system/file_system_url_loader_factory.cc
@@ -585,7 +585,7 @@ class FileSystemFileURLLoader final : public FileSystemEntryURLLoader {
         // Only sniff for mime-type in the first block of the file.
         std::string type_hint;
         GetMimeType(url_, &type_hint);
-        SniffMimeType(std::string_view(file_data_->data(), result),
+        SniffMimeType(std::string_view(file_data_->data().data(), result),
                       url_.ToGURL(), type_hint,
                       net::ForceSniffFileUrlsForHtml::kDisabled,
                       &head_->mime_type);
@@ -604,7 +604,7 @@ class FileSystemFileURLLoader final : public FileSystemEntryURLLoader {
   void WriteFileData(int bytes_read) {
     data_producer_->Write(
         std::make_unique<mojo::StringDataSource>(
-            std::string_view(file_data_->data(), bytes_read),
+            std::string_view(file_data_->data().data(), bytes_read),
             mojo::StringDataSource::AsyncWritingMode::
                 STRING_STAYS_VALID_UNTIL_COMPLETION),
         base::BindOnce(&FileSystemFileURLLoader::OnFileDataWritten,
diff --git a/content/browser/file_system_access/file_system_access_file_handle_impl_unittest.cc b/content/browser/file_system_access/file_system_access_file_handle_impl_unittest.cc
index e96bd8c702f06..4f1dae5093c3d 100644
--- a/content/browser/file_system_access/file_system_access_file_handle_impl_unittest.cc
+++ b/content/browser/file_system_access/file_system_access_file_handle_impl_unittest.cc
@@ -100,7 +100,7 @@ class FileSystemAccessFileHandleImplTest : public testing::Test {
       if (rv == 0) {
         return result;
       }
-      result.append(buf->data(), rv);
+      result.append(buf->data().data(), rv);
     }
   }
 
diff --git a/content/browser/file_system_access/file_system_access_file_writer_impl_unittest.cc b/content/browser/file_system_access/file_system_access_file_writer_impl_unittest.cc
index 39bcb650cea32..f24b616469595 100644
--- a/content/browser/file_system_access/file_system_access_file_writer_impl_unittest.cc
+++ b/content/browser/file_system_access/file_system_access_file_writer_impl_unittest.cc
@@ -201,7 +201,7 @@ class FileSystemAccessFileWriterImplTest : public testing::Test {
       if (rv == 0) {
         return result;
       }
-      result.append(buf->data(), rv);
+      result.append(buf->data().data(), rv);
     }
   }
 
diff --git a/content/browser/loader/cross_origin_read_blocking_checker.cc b/content/browser/loader/cross_origin_read_blocking_checker.cc
index 3aa3d7b1d10bc..b070d96c5ec6e 100644
--- a/content/browser/loader/cross_origin_read_blocking_checker.cc
+++ b/content/browser/loader/cross_origin_read_blocking_checker.cc
@@ -164,7 +164,7 @@ void CrossOriginReadBlockingChecker::OnReadComplete(
     return;
   }
 
-  std::string_view data(buffer->data(), bytes_read);
+  std::string_view data(buffer->data().data(), bytes_read);
   network::orb::ResponseAnalyzer::Decision orb_decision =
       orb_analyzer_->Sniff(data);
 
diff --git a/content/browser/service_worker/service_worker_installed_script_reader.cc b/content/browser/service_worker/service_worker_installed_script_reader.cc
index 01977c47f6a31..f59cdb1545ccb 100644
--- a/content/browser/service_worker/service_worker_installed_script_reader.cc
+++ b/content/browser/service_worker/service_worker_installed_script_reader.cc
@@ -175,7 +175,8 @@ void ServiceWorkerInstalledScriptReader::OnReadDataPrepared(
     // TODO(crbug.com/40120038): Avoid copying |metadata| if |client_| doesn't
     // need it.
     auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(metadata->size());
-    UNSAFE_TODO(memmove(buffer->data(), metadata->data(), metadata->size()));
+    UNSAFE_TODO(
+        memmove(buffer->data().data(), metadata->data(), metadata->size()));
     meta_data_sender_ = std::make_unique<MetaDataSender>(
         std::move(buffer), std::move(meta_producer_handle));
     meta_data_sender_->Start(base::BindOnce(
diff --git a/content/browser/web_package/mock_signed_exchange_handler.cc b/content/browser/web_package/mock_signed_exchange_handler.cc
index 3685c9d56df3b..c8c1a17b6a212 100644
--- a/content/browser/web_package/mock_signed_exchange_handler.cc
+++ b/content/browser/web_package/mock_signed_exchange_handler.cc
@@ -142,7 +142,7 @@ class PrefixStrippingSourceStream : public net::SourceStream {
     }
 
     // Strip `remaining_prefix_to_strip_` bytes from `bytes_read`.
-    std::string_view bytes_read(pending_read->dest_buffer->data(),
+    std::string_view bytes_read(pending_read->dest_buffer->data().data(),
                                 number_of_bytes_read);
     int maybe_consumed_bytes =
         std::min(bytes_read.size(), remaining_prefix_to_strip_.size());
@@ -161,7 +161,7 @@ class PrefixStrippingSourceStream : public net::SourceStream {
     bool maybe_incorrect_eof = bytes_read.empty() && MayHaveMoreBytes();
     if (remaining_prefix_to_strip_.empty() && !maybe_incorrect_eof) {
       // Source and destination may overlap - need to use `memmove`.
-      memmove(pending_read->dest_buffer->data(), bytes_read.data(),
+      memmove(pending_read->dest_buffer->data().data(), bytes_read.data(),
               bytes_read.size());
       return bytes_read.size();
     }
diff --git a/content/browser/web_package/signed_exchange_handler_unittest.cc b/content/browser/web_package/signed_exchange_handler_unittest.cc
index 0d10e73b19c27..000f07910792b 100644
--- a/content/browser/web_package/signed_exchange_handler_unittest.cc
+++ b/content/browser/web_package/signed_exchange_handler_unittest.cc
@@ -292,7 +292,7 @@ class SignedExchangeHandlerTest
       EXPECT_GT(rv, net::OK);
       bytes_read += rv;
       if (output)
-        output->append(output_buffer->data(), rv);
+        output->append(output_buffer->data().data(), rv);
     }
     return bytes_read;
   }
diff --git a/content/public/test/network_service_test_helper.cc b/content/public/test/network_service_test_helper.cc
index 589bd4e8989cc..11d4155451209 100644
--- a/content/public/test/network_service_test_helper.cc
+++ b/content/public/test/network_service_test_helper.cc
@@ -118,7 +118,7 @@ class SimpleCacheEntry : public network::mojom::SimpleCacheEntry {
 
     auto data_to_pass =
         base::MakeRefCounted<net::IOBufferWithSize>(data.size());
-    memcpy(data_to_pass->data(), data.data(), data.size());
+    memcpy(data_to_pass->data().data(), data.data(), data.size());
     int rv = entry_->WriteData(index, offset, data_to_pass.get(), data.size(),
                                base::BindOnce(&SimpleCacheEntry::OnDataWritten,
                                               weak_factory_.GetWeakPtr(),
@@ -167,7 +167,7 @@ class SimpleCacheEntry : public network::mojom::SimpleCacheEntry {
 
     auto data_to_pass =
         base::MakeRefCounted<net::IOBufferWithSize>(data.size());
-    memcpy(data_to_pass->data(), data.data(), data.size());
+    memcpy(data_to_pass->data().data(), data.data(), data.size());
     int rv =
         entry_->WriteSparseData(offset, data_to_pass.get(), data.size(),
                                 base::BindOnce(&SimpleCacheEntry::OnDataWritten,
@@ -226,7 +226,7 @@ class SimpleCacheEntry : public network::mojom::SimpleCacheEntry {
       return;
     }
     std::vector<uint8_t> data(result);
-    memcpy(data.data(), buffer->data(), result);
+    memcpy(data.data(), buffer->data().data(), result);
     std::move(callback).Run(data, result);
   }
 
diff --git a/device/bluetooth/bluez/bluetooth_socket_bluez_unittest.cc b/device/bluetooth/bluez/bluetooth_socket_bluez_unittest.cc
index 849b9b69b8392..3ca559349633b 100644
--- a/device/bluetooth/bluez/bluetooth_socket_bluez_unittest.cc
+++ b/device/bluetooth/bluez/bluetooth_socket_bluez_unittest.cc
@@ -280,7 +280,8 @@ TEST_F(BluetoothSocketBlueZTest, Connect) {
   success_callback_count_ = 0;
   error_callback_count_ = 0;
 
-  std::string data = std::string(read_buffer->data(), last_bytes_received_);
+  std::string data =
+      std::string(read_buffer->data().data(), last_bytes_received_);
   EXPECT_EQ("test", data);
 
   read_buffer = nullptr;
diff --git a/device/bluetooth/socket.cc b/device/bluetooth/socket.cc
index c62895726b1e5..322cf04d4f60f 100644
--- a/device/bluetooth/socket.cc
+++ b/device/bluetooth/socket.cc
@@ -119,12 +119,12 @@ void Socket::OnBluetoothSocketReceive(void* pending_write_buffer,
                                       int num_bytes_received,
                                       scoped_refptr<net::IOBuffer> io_buffer) {
   DCHECK_GT(num_bytes_received, 0);
-  DCHECK(io_buffer->data());
+  DCHECK(!io_buffer->data().empty());
 
   if (!receive_stream_.is_valid())
     return;
 
-  memcpy(pending_write_buffer, io_buffer->data(), num_bytes_received);
+  memcpy(pending_write_buffer, io_buffer->data().data(), num_bytes_received);
   receive_stream_->EndWriteData(static_cast<uint32_t>(num_bytes_received));
 
   ReceiveMore();
diff --git a/extensions/browser/api/socket/mojo_data_pump_unittest.cc b/extensions/browser/api/socket/mojo_data_pump_unittest.cc
index 1a59f26079380..07ad0ba2993be 100644
--- a/extensions/browser/api/socket/mojo_data_pump_unittest.cc
+++ b/extensions/browser/api/socket/mojo_data_pump_unittest.cc
@@ -46,7 +46,7 @@ TEST(MojoDataPumpTest, ReceiveStreamNotReady) {
                    callback_called = true;
                    ASSERT_EQ(static_cast<int>(data.size()), result);
                    EXPECT_EQ(data,
-                             std::string(io_buffer->data(), result));
+                             std::string(io_buffer->data().data(), result));
                    run_loop.Quit();
                  }));
 
diff --git a/extensions/browser/api/socket/udp_socket.cc b/extensions/browser/api/socket/udp_socket.cc
index b63e2a534dc45..48bbefefd13b0 100644
--- a/extensions/browser/api/socket/udp_socket.cc
+++ b/extensions/browser/api/socket/udp_socket.cc
@@ -238,7 +238,7 @@ void UDPSocket::OnReceived(int32_t result,
 
   auto io_buffer =
       base::MakeRefCounted<net::IOBufferWithSize>(data.value().size());
-  memcpy(io_buffer->data(), data.value().data(), data.value().size());
+  memcpy(io_buffer->data().data(), data.value().data(), data.value().size());
 
   if (!read_callback_.is_null()) {
     std::move(read_callback_)
diff --git a/google_apis/gcm/base/socket_stream.cc b/google_apis/gcm/base/socket_stream.cc
index 7d7b5ff9171fa..66be556748da5 100644
--- a/google_apis/gcm/base/socket_stream.cc
+++ b/google_apis/gcm/base/socket_stream.cc
@@ -65,7 +65,7 @@ bool SocketInputStream::Next(const void** data, int* size) {
   DCHECK_EQ(GetState(), READY)
       << " Input stream must have pending data before reading.";
   DCHECK_LT(next_pos_, read_buffer_->BytesConsumed());
-  *data = io_buffer_->data() + next_pos_;
+  *data = io_buffer_->data().subspan(next_pos_);
   *size = UnreadByteCount();
   next_pos_ = read_buffer_->BytesConsumed();
   DVLOG(1) << "Consuming " << *size << " bytes in input buffer.";
@@ -188,7 +188,7 @@ void SocketInputStream::RebuildBuffer() {
     // Move any remaining unread data to the start of the buffer;
     std::copy(static_cast<const char*>(unread_data_ptr),
               static_cast<const char*>(unread_data_ptr) + unread_data_size,
-              io_buffer_->data());
+              io_buffer_->data().data());
   } else {
     DVLOG(1) << "Have " << unread_data_size << " unread bytes remaining.";
   }
@@ -253,7 +253,7 @@ bool SocketOutputStream::Next(void** data, int* size) {
   if (next_pos_ == io_buffer_->size())
     return false;
 
-  *data = io_buffer_->data() + next_pos_;
+  *data = io_buffer_->data().subspan(next_pos_);
   *size = io_buffer_->size() - next_pos_;
   next_pos_ = io_buffer_->size();
   return true;
diff --git a/gpu/ipc/host/gpu_disk_cache.cc b/gpu/ipc/host/gpu_disk_cache.cc
index 9168fe80520fc..5bb39501881d6 100644
--- a/gpu/ipc/host/gpu_disk_cache.cc
+++ b/gpu/ipc/host/gpu_disk_cache.cc
@@ -358,7 +358,7 @@ int GpuDiskCacheReadHelper::ReadComplete(int rv) {
   DCHECK_CALLED_ON_VALID_THREAD(thread_checker_);
   if (rv && rv == buf_->size() && !blob_loaded_callback_.is_null()) {
     blob_loaded_callback_.Run(entry_->GetKey(),
-                              std::string(buf_->data(), buf_->size()));
+                              std::string(buf_->data().data(), buf_->size()));
   }
 
   buf_ = nullptr;
diff --git a/net/base/chunked_upload_data_stream_unittest.cc b/net/base/chunked_upload_data_stream_unittest.cc
index 8741d605d7372..1ae70e447f2e9 100644
--- a/net/base/chunked_upload_data_stream_unittest.cc
+++ b/net/base/chunked_upload_data_stream_unittest.cc
@@ -42,7 +42,7 @@ std::string ReadSync(UploadDataStream* stream, int buffer_size) {
                             buffer_size,
                             TestCompletionCallback().callback());
   EXPECT_GE(result, 0);
-  return std::string(buf->data(), result);
+  return std::string(buf->data().data(), result);
 }
 
 // Check the case data is added after the first read attempt.
@@ -65,7 +65,7 @@ TEST(ChunkedUploadDataStreamTest, AppendOnce) {
   stream.AppendData(base::byte_span_from_cstring(kTestData), true);
   int read = callback.WaitForResult();
   ASSERT_GE(read, 0);
-  EXPECT_EQ(kTestData, std::string(buf->data(), read));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read));
   EXPECT_EQ(0u, stream.size());  // Content-Length is 0 for chunked data.
   EXPECT_EQ(kTestDataSize, stream.position());
   EXPECT_TRUE(stream.IsEOF());
diff --git a/net/base/elements_upload_data_stream_unittest.cc b/net/base/elements_upload_data_stream_unittest.cc
index c47aceb93d6e6..39721340cf0ac 100644
--- a/net/base/elements_upload_data_stream_unittest.cc
+++ b/net/base/elements_upload_data_stream_unittest.cc
@@ -65,7 +65,7 @@ std::string ReadFromUploadDataStream(UploadDataStream* stream) {
         stream->Read(buf.get(), kTestBufferSize, callback.callback());
     const int bytes_read =
         result != ERR_IO_PENDING ? result : callback.WaitForResult();
-    data_read.append(buf->data(), bytes_read);
+    data_read.append(buf->data().data(), bytes_read);
   }
   return data_read;
 }
@@ -300,7 +300,7 @@ TEST_F(ElementsUploadDataStreamTest, ReadErrorSync) {
 
   // Prepare a buffer filled with non-zero data.
   auto buf = base::MakeRefCounted<IOBufferWithSize>(kTestBufferSize);
-  std::fill_n(buf->data(), kTestBufferSize, -1);
+  std::fill_n(buf->data().data(), kTestBufferSize, -1);
 
   // Read() results in success even when the reader returns error.
   EXPECT_EQ(ERR_FAILED,
@@ -309,7 +309,8 @@ TEST_F(ElementsUploadDataStreamTest, ReadErrorSync) {
   EXPECT_FALSE(stream->IsEOF());
 
   // The buffer is filled with zero.
-  EXPECT_EQ(0, std::count(buf->data(), buf->data() + kTestBufferSize, 0));
+  EXPECT_EQ(0,
+            std::count(buf->data().data(), buf->data() + kTestBufferSize, 0));
 }
 
 TEST_F(ElementsUploadDataStreamTest, ReadErrorAsync) {
@@ -338,7 +339,7 @@ TEST_F(ElementsUploadDataStreamTest, ReadErrorAsync) {
 
   // Prepare a buffer filled with non-zero data.
   auto buf = base::MakeRefCounted<IOBufferWithSize>(kTestBufferSize);
-  std::fill_n(buf->data(), kTestBufferSize, -1);
+  std::fill_n(buf->data().data(), kTestBufferSize, -1);
 
   // Read() results in success even when the reader returns error.
   TestCompletionCallback read_callback;
@@ -349,7 +350,8 @@ TEST_F(ElementsUploadDataStreamTest, ReadErrorAsync) {
   EXPECT_FALSE(stream->IsEOF());
 
   // The buffer is empty
-  EXPECT_EQ(0, std::count(buf->data(), buf->data() + kTestBufferSize, 0));
+  EXPECT_EQ(0,
+            std::count(buf->data().data(), buf->data() + kTestBufferSize, 0));
 }
 
 TEST_F(ElementsUploadDataStreamTest, FileAndBytes) {
diff --git a/net/base/file_stream_unittest.cc b/net/base/file_stream_unittest.cc
index 430a6360617a5..05ab59ee99b5f 100644
--- a/net/base/file_stream_unittest.cc
+++ b/net/base/file_stream_unittest.cc
@@ -64,7 +64,7 @@ constexpr int kTestDataSize = std::size(kTestData) - 1;
 scoped_refptr<IOBufferWithSize> CreateTestDataBuffer() {
   scoped_refptr<IOBufferWithSize> buf =
       base::MakeRefCounted<IOBufferWithSize>(kTestDataSize);
-  memcpy(buf->data(), kTestData, kTestDataSize);
+  memcpy(buf->data().data(), kTestData, kTestDataSize);
   return buf;
 }
 
@@ -150,7 +150,7 @@ TEST_F(FileStreamTest, UseFileHandle) {
       base::MakeRefCounted<IOBufferWithSize>(kTestDataSize);
   rv = read_stream->Read(read_buffer.get(), kTestDataSize, callback.callback());
   ASSERT_EQ(kTestDataSize, callback.GetResult(rv));
-  ASSERT_EQ(0, memcmp(kTestData, read_buffer->data(), kTestDataSize));
+  ASSERT_EQ(0, memcmp(kTestData, read_buffer->data().data(), kTestDataSize));
   read_stream.reset();
 
   // 2. Test writing with a file handle.
@@ -174,7 +174,7 @@ TEST_F(FileStreamTest, UseFileHandle) {
   ASSERT_EQ(kTestDataSize,
             base::ReadFile(temp_file_path(), read_buffer->data(),
                            kTestDataSize));
-  ASSERT_EQ(0, memcmp(kTestData, read_buffer->data(), kTestDataSize));
+  ASSERT_EQ(0, memcmp(kTestData, read_buffer->data().data(), kTestDataSize));
 }
 
 TEST_F(FileStreamTest, UseClosedStream) {
@@ -220,7 +220,7 @@ TEST_F(FileStreamTest, Read) {
     if (rv <= 0)
       break;
     total_bytes_read += rv;
-    data_read.append(buf->data(), rv);
+    data_read.append(buf->data().data(), rv);
   }
   EXPECT_EQ(file_size.value(), total_bytes_read);
   EXPECT_EQ(kTestData, data_read);
@@ -249,7 +249,7 @@ TEST_F(FileStreamTest, Read_EarlyDelete) {
     base::RunLoop().RunUntilIdle();
     EXPECT_FALSE(callback.have_result());
   } else {
-    EXPECT_EQ(std::string(kTestData, rv), std::string(buf->data(), rv));
+    EXPECT_EQ(std::string(kTestData, rv), std::string(buf->data().data(), rv));
   }
 }
 
@@ -285,7 +285,7 @@ TEST_F(FileStreamTest, Read_FromOffset) {
     if (rv <= 0)
       break;
     total_bytes_read += rv;
-    data_read.append(buf->data(), rv);
+    data_read.append(buf->data().data(), rv);
   }
   EXPECT_EQ(file_size.value() - kOffset, total_bytes_read);
   EXPECT_EQ(kTestData + kOffset, data_read);
@@ -412,7 +412,7 @@ TEST_F(FileStreamTest, BasicReadWrite) {
     if (rv <= 0)
       break;
     total_bytes_read += rv;
-    data_read.append(buf->data(), rv);
+    data_read.append(buf->data().data(), rv);
   }
   EXPECT_EQ(file_size, total_bytes_read);
   EXPECT_TRUE(data_read == kTestData);
@@ -499,7 +499,7 @@ TEST_F(FileStreamTest, BasicWriteRead) {
     if (rv <= 0)
       break;
     total_bytes_read += rv;
-    data_read.append(buf->data(), rv);
+    data_read.append(buf->data().data(), rv);
   }
   stream.reset();
 
@@ -564,7 +564,7 @@ class TestWriteReadCompletionCallback {
       if (rv <= 0)
         break;
       *total_bytes_read_ += rv;
-      data_read_->append(buf->data(), rv);
+      data_read_->append(buf->data().data(), rv);
     }
   }
 
diff --git a/net/base/io_buffer.h b/net/base/io_buffer.h
index ee5b7cdaf43b7..7a98cf34a4ad0 100644
--- a/net/base/io_buffer.h
+++ b/net/base/io_buffer.h
@@ -94,10 +94,10 @@ class NET_EXPORT IOBuffer : public base::RefCountedThreadSafe<IOBuffer> {
     return static_cast<int>(span_.size());
   }
 
-  char* data() { return reinterpret_cast<char*>(bytes()); }
+  base::span<char> data() { return reinterpret_cast<char*>(bytes()); }
   const char* data() const { return reinterpret_cast<const char*>(bytes()); }
 
-  uint8_t* bytes() { return span_.data(); }
+  base::span<uint8_t> bytes() { return span_; }
   const uint8_t* bytes() const { return span_.data(); }
 
   base::span<uint8_t> span() { return span_; }
diff --git a/net/base/io_buffer_unittest.cc b/net/base/io_buffer_unittest.cc
index 9366dce170544..269c804dd35ed 100644
--- a/net/base/io_buffer_unittest.cc
+++ b/net/base/io_buffer_unittest.cc
@@ -44,12 +44,13 @@ void CompareIOBufferToSpan(IOBuffer& io_buffer,
 
   ASSERT_EQ(io_buffer.span(), span);
   ASSERT_EQ(base::checked_cast<size_t>(io_buffer.size()), span.size());
-  EXPECT_EQ(base::span(reinterpret_cast<const uint8_t*>(io_buffer.bytes()),
-                       static_cast<size_t>(io_buffer.size())),
-            span);
   EXPECT_EQ(
-      base::span(io_buffer.bytes(), static_cast<size_t>(io_buffer.size())),
+      base::span(reinterpret_cast<const uint8_t*>(io_buffer.bytes().data()),
+                 static_cast<size_t>(io_buffer.size())),
       span);
+  EXPECT_EQ(base::span(io_buffer.bytes().data(),
+                       static_cast<size_t>(io_buffer.size())),
+            span);
   EXPECT_EQ(io_buffer.span(), span);
 }
 
@@ -235,7 +236,7 @@ TEST(IOBufferTest, WrappedIOBuffer) {
   CompareIOBufferToSpan(*buffer, data);
 
   // Check that the buffer does not have its own copy of the data.
-  EXPECT_EQ(buffer->bytes(), data.data());
+  EXPECT_EQ(buffer->bytes().data(), data.data());
 }
 
 }  // anonymous namespace
diff --git a/net/device_bound_sessions/registration_fetcher.cc b/net/device_bound_sessions/registration_fetcher.cc
index 0203f584687ca..1c36ef6f8f586 100644
--- a/net/device_bound_sessions/registration_fetcher.cc
+++ b/net/device_bound_sessions/registration_fetcher.cc
@@ -210,11 +210,11 @@ class RegistrationFetcherImpl : public URLRequest::Delegate {
   }
 
   void OnReadCompleted(URLRequest* request, int bytes_read) override {
-    data_received_.append(buf_->data(), bytes_read);
+    data_received_.append(buf_->data().data(), bytes_read);
     while (bytes_read > 0) {
       bytes_read = request->Read(buf_.get(), kBufferSize);
       if (bytes_read > 0) {
-        data_received_.append(buf_->data(), bytes_read);
+        data_received_.append(buf_->data().data(), bytes_read);
       }
     }
 
diff --git a/net/disk_cache/backend_unittest.cc b/net/disk_cache/backend_unittest.cc
index 13059233d36f4..ec5d27b97cb65 100644
--- a/net/disk_cache/backend_unittest.cc
+++ b/net/disk_cache/backend_unittest.cc
@@ -877,7 +877,8 @@ TEST_F(DiskCacheBackendTest, ExternalFiles) {
   auto buffer1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   CacheTestFillBuffer(buffer1->span(), false);
   ASSERT_TRUE(base::WriteFile(
-      filename, std::string_view(buffer1->data(), static_cast<size_t>(kSize))));
+      filename,
+      std::string_view(buffer1->data().data(), static_cast<size_t>(kSize))));
 
   // Now let's create a file with the cache.
   disk_cache::Entry* entry;
@@ -888,7 +889,7 @@ TEST_F(DiskCacheBackendTest, ExternalFiles) {
   // And verify that the first file is still there.
   auto buffer2(base::MakeRefCounted<net::IOBufferWithSize>(kSize));
   ASSERT_EQ(kSize, base::ReadFile(filename, buffer2->data(), kSize));
-  EXPECT_EQ(0, memcmp(buffer1->data(), buffer2->data(), kSize));
+  EXPECT_EQ(0, memcmp(buffer1->data().data(), buffer2->data().data(), kSize));
 }
 
 // Tests that we deal with file-level pending operations at destruction time.
@@ -1122,7 +1123,7 @@ void DiskCacheBackendTest::BackendSetSize() {
   ASSERT_THAT(CreateEntry(first, &entry), IsOk());
 
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(cache_size);
-  memset(buffer->data(), 0, cache_size);
+  memset(buffer->data().data(), 0, cache_size);
   EXPECT_EQ(cache_size / 10,
             WriteData(entry, 0, 0, buffer.get(), cache_size / 10, false))
       << "normal file";
@@ -1332,7 +1333,7 @@ void DiskCacheBackendTest::BackendValidEntry() {
 
   const int kSize = 50;
   auto buffer1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer1->data(), 0, kSize);
+  memset(buffer1->data().data(), 0, kSize);
   base::strlcpy(buffer1->data(), "And the data to save", kSize);
   EXPECT_EQ(kSize, WriteData(entry, 0, 0, buffer1.get(), kSize, false));
   entry->Close();
@@ -1341,10 +1342,10 @@ void DiskCacheBackendTest::BackendValidEntry() {
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
 
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer2->data(), 0, kSize);
+  memset(buffer2->data().data(), 0, kSize);
   EXPECT_EQ(kSize, ReadData(entry, 0, 0, buffer2.get(), kSize));
   entry->Close();
-  EXPECT_STREQ(buffer1->data(), buffer2->data());
+  EXPECT_STREQ(buffer1->data().data(), buffer2->data().data());
 }
 
 TEST_F(DiskCacheBackendTest, ValidEntry) {
@@ -1368,7 +1369,7 @@ void DiskCacheBackendTest::BackendInvalidEntry() {
 
   const int kSize = 50;
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   base::strlcpy(buffer->data(), "And the data to save", kSize);
   EXPECT_EQ(kSize, WriteData(entry, 0, 0, buffer.get(), kSize, false));
   SimulateCrash();
@@ -1412,7 +1413,7 @@ void DiskCacheBackendTest::BackendInvalidEntryRead() {
 
   const int kSize = 50;
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   base::strlcpy(buffer->data(), "And the data to save", kSize);
   EXPECT_EQ(kSize, WriteData(entry, 0, 0, buffer.get(), kSize, false));
   entry->Close();
@@ -1539,7 +1540,7 @@ void DiskCacheBackendTest::BackendTrimInvalidEntry() {
   ASSERT_THAT(CreateEntry(first, &entry), IsOk());
 
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   EXPECT_EQ(kSize, WriteData(entry, 0, 0, buffer.get(), kSize, false));
 
   // Simulate a crash.
@@ -1588,7 +1589,7 @@ void DiskCacheBackendTest::BackendTrimInvalidEntry2() {
   InitCache();
 
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer->data(), 0, kSize);
+  memset(buffer->data().data(), 0, kSize);
   disk_cache::Entry* entry;
 
   // Writing 32 entries to this cache chains most of them.
@@ -1859,7 +1860,7 @@ TEST_F(DiskCacheBackendTest, ShaderCacheEnumerationReadData) {
   auto buffer1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
 
   ASSERT_THAT(CreateEntry(first, &entry1), IsOk());
-  memset(buffer1->data(), 0, kSize);
+  memset(buffer1->data().data(), 0, kSize);
   base::strlcpy(buffer1->data(), "And the data to save", kSize);
   EXPECT_EQ(kSize, WriteData(entry1, 0, 0, buffer1.get(), kSize, false));
 
@@ -1893,7 +1894,7 @@ void DiskCacheBackendTest::BackendInvalidEntryEnumeration() {
 
   const int kSize = 50;
   auto buffer1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer1->data(), 0, kSize);
+  memset(buffer1->data().data(), 0, kSize);
   base::strlcpy(buffer1->data(), "And the data to save", kSize);
   EXPECT_EQ(kSize, WriteData(entry1, 0, 0, buffer1.get(), kSize, false));
   entry1->Close();
@@ -3234,7 +3235,7 @@ void DiskCacheBackendTest::BackendDisable4() {
 
   const int kBufSize = 20000;
   auto buf = base::MakeRefCounted<net::IOBufferWithSize>(kBufSize);
-  memset(buf->data(), 0, kBufSize);
+  memset(buf->data().data(), 0, kBufSize);
   EXPECT_EQ(100, WriteData(entry2, 0, 0, buf.get(), 100, false));
   EXPECT_EQ(kBufSize, WriteData(entry3, 0, 0, buf.get(), kBufSize, false));
 
@@ -4551,7 +4552,7 @@ TEST_F(DiskCacheBackendTest, SimpleFdLimit) {
     EXPECT_EQ(kSize, WriteData(entries[i], 1, 0, buf1.get(), kSize, true));
     auto read_buf = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
     ASSERT_EQ(kSize, ReadData(entries[i], 1, 0, read_buf.get(), kSize));
-    EXPECT_EQ(0, memcmp(read_buf->data(), buf1->data(), kSize));
+    EXPECT_EQ(0, memcmp(read_buf->data().data(), buf1->data().data(), kSize));
   }
 
   histogram_tester.ExpectBucketCount(
@@ -4568,11 +4569,11 @@ TEST_F(DiskCacheBackendTest, SimpleFdLimit) {
 
   auto read_buf = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   ASSERT_EQ(kSize, ReadData(entries[0], 1, 0, read_buf.get(), kSize));
-  EXPECT_EQ(0, memcmp(read_buf->data(), buf1->data(), kSize));
+  EXPECT_EQ(0, memcmp(read_buf->data().data(), buf1->data().data(), kSize));
 
   auto read_buf2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   ASSERT_EQ(kSize, ReadData(alt_entry, 1, 0, read_buf2.get(), kSize));
-  EXPECT_EQ(0, memcmp(read_buf2->data(), buf2->data(), kSize));
+  EXPECT_EQ(0, memcmp(read_buf2->data().data(), buf2->data().data(), kSize));
 
   // Two more things than last time --- entries[0] and |alt_entry|
   histogram_tester.ExpectBucketCount(
diff --git a/net/disk_cache/blockfile/entry_impl.cc b/net/disk_cache/blockfile/entry_impl.cc
index 0b5768eb580d6..108d462292abd 100644
--- a/net/disk_cache/blockfile/entry_impl.cc
+++ b/net/disk_cache/blockfile/entry_impl.cc
@@ -255,7 +255,7 @@ int EntryImpl::UserBuffer::Read(int offset, IOBuffer* buf, int len) {
   if (offset < offset_) {
     // We don't have a file so lets fill the first part with 0.
     clean_bytes = std::min(offset_ - offset, len);
-    memset(buf->data(), 0, clean_bytes);
+    memset(buf->data().data(), 0, clean_bytes);
     if (len == clean_bytes)
       return len;
     offset = offset_;
@@ -267,7 +267,7 @@ int EntryImpl::UserBuffer::Read(int offset, IOBuffer* buf, int len) {
   DCHECK_GE(start, 0);
   DCHECK_GE(available, 0);
   len = std::min(len, available);
-  memcpy(buf->data() + clean_bytes, &buffer_[start], len);
+  memcpy(buf->data().subspan(clean_bytes).data(), &buffer_[start], len);
   return len + clean_bytes;
 }
 
diff --git a/net/disk_cache/entry_unittest.cc b/net/disk_cache/entry_unittest.cc
index 5312643fb9963..2e207a0b279d0 100644
--- a/net/disk_cache/entry_unittest.cc
+++ b/net/disk_cache/entry_unittest.cc
@@ -118,27 +118,27 @@ void DiskCacheEntryTest::InternalSyncIOBackground(disk_cache::Entry* entry) {
   base::strlcpy(buffer1->data(), "the data", kSize1);
   EXPECT_EQ(10, entry->WriteData(0, 0, buffer1.get(), kSize1,
                                  net::CompletionOnceCallback(), false));
-  memset(buffer1->data(), 0, kSize1);
+  memset(buffer1->data().data(), 0, kSize1);
   EXPECT_EQ(10, entry->ReadData(0, 0, buffer1.get(), kSize1,
                                 net::CompletionOnceCallback()));
-  EXPECT_STREQ("the data", buffer1->data());
+  EXPECT_STREQ("the data", buffer1->data().data());
 
   const int kSize2 = 5000;
   const int kSize3 = 10000;
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize2);
   auto buffer3 = base::MakeRefCounted<net::IOBufferWithSize>(kSize3);
-  memset(buffer3->data(), 0, kSize3);
+  memset(buffer3->data().data(), 0, kSize3);
   CacheTestFillBuffer(buffer2->span(), false);
   base::strlcpy(buffer2->data(), "The really big data goes here", kSize2);
   EXPECT_EQ(5000, entry->WriteData(1, 1500, buffer2.get(), kSize2,
                                    net::CompletionOnceCallback(), false));
-  memset(buffer2->data(), 0, kSize2);
+  memset(buffer2->data().data(), 0, kSize2);
   EXPECT_EQ(4989, entry->ReadData(1, 1511, buffer2.get(), kSize2,
                                   net::CompletionOnceCallback()));
-  EXPECT_STREQ("big data goes here", buffer2->data());
+  EXPECT_STREQ("big data goes here", buffer2->data().data());
   EXPECT_EQ(5000, entry->ReadData(1, 0, buffer2.get(), kSize2,
                                   net::CompletionOnceCallback()));
-  EXPECT_EQ(0, memcmp(buffer2->data(), buffer3->data(), 1500));
+  EXPECT_EQ(0, memcmp(buffer2->data().data(), buffer3->data().data(), 1500));
   EXPECT_EQ(1500, entry->ReadData(1, 5000, buffer2.get(), kSize2,
                                   net::CompletionOnceCallback()));
 
@@ -243,7 +243,7 @@ void DiskCacheEntryTest::InternalAsyncIO() {
     expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  memset(buffer2->data(), 0, kSize2);
+  memset(buffer2->data().data(), 0, kSize2);
   ret = entry->ReadData(
       0, 0, buffer2.get(), kSize1,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback3)));
@@ -252,7 +252,7 @@ void DiskCacheEntryTest::InternalAsyncIO() {
     expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  EXPECT_STREQ("the data", buffer2->data());
+  EXPECT_STREQ("the data", buffer2->data().data());
 
   base::strlcpy(buffer2->data(), "The really big data goes here", kSize2);
   ret = entry->WriteData(
@@ -263,7 +263,7 @@ void DiskCacheEntryTest::InternalAsyncIO() {
     expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  memset(buffer3->data(), 0, kSize3);
+  memset(buffer3->data().data(), 0, kSize3);
   ret = entry->ReadData(
       1, 1511, buffer3.get(), kSize2,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback5)));
@@ -272,7 +272,7 @@ void DiskCacheEntryTest::InternalAsyncIO() {
     expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  EXPECT_STREQ("big data goes here", buffer3->data());
+  EXPECT_STREQ("big data goes here", buffer3->data().data());
   ret = entry->ReadData(
       1, 0, buffer2.get(), kSize2,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback6)));
@@ -280,10 +280,10 @@ void DiskCacheEntryTest::InternalAsyncIO() {
   if (net::ERR_IO_PENDING == ret)
     expected++;
 
-  memset(buffer3->data(), 0, kSize3);
+  memset(buffer3->data().data(), 0, kSize3);
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  EXPECT_EQ(0, memcmp(buffer2->data(), buffer3->data(), 1500));
+  EXPECT_EQ(0, memcmp(buffer2->data().data(), buffer3->data().data(), 1500));
   ret = entry->ReadData(
       1, 5000, buffer2.get(), kSize2,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback7)));
@@ -361,18 +361,18 @@ void DiskCacheEntryTest::ExternalSyncIOBackground(disk_cache::Entry* entry) {
   base::strlcpy(buffer1->data(), "the data", kSize1);
   EXPECT_EQ(17000, entry->WriteData(0, 0, buffer1.get(), kSize1,
                                     net::CompletionOnceCallback(), false));
-  memset(buffer1->data(), 0, kSize1);
+  memset(buffer1->data().data(), 0, kSize1);
   EXPECT_EQ(17000, entry->ReadData(0, 0, buffer1.get(), kSize1,
                                    net::CompletionOnceCallback()));
-  EXPECT_STREQ("the data", buffer1->data());
+  EXPECT_STREQ("the data", buffer1->data().data());
 
   base::strlcpy(buffer2->data(), "The really big data goes here", kSize2);
   EXPECT_EQ(25000, entry->WriteData(1, 10000, buffer2.get(), kSize2,
                                     net::CompletionOnceCallback(), false));
-  memset(buffer2->data(), 0, kSize2);
+  memset(buffer2->data().data(), 0, kSize2);
   EXPECT_EQ(24989, entry->ReadData(1, 10011, buffer2.get(), kSize2,
                                    net::CompletionOnceCallback()));
-  EXPECT_STREQ("big data goes here", buffer2->data());
+  EXPECT_STREQ("big data goes here", buffer2->data().data());
   EXPECT_EQ(25000, entry->ReadData(1, 0, buffer2.get(), kSize2,
                                    net::CompletionOnceCallback()));
   EXPECT_EQ(5000, entry->ReadData(1, 30000, buffer2.get(), kSize2,
@@ -461,7 +461,7 @@ void DiskCacheEntryTest::ExternalAsyncIO() {
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
 
-  memset(buffer2->data(), 0, kSize1);
+  memset(buffer2->data().data(), 0, kSize1);
   ret = entry->ReadData(
       0, 0, buffer2.get(), kSize1,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback2)));
@@ -470,7 +470,7 @@ void DiskCacheEntryTest::ExternalAsyncIO() {
     expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  EXPECT_STREQ("the data", buffer2->data());
+  EXPECT_STREQ("the data", buffer2->data().data());
 
   base::strlcpy(buffer2->data(), "The really big data goes here", kSize2);
   ret = entry->WriteData(
@@ -482,7 +482,7 @@ void DiskCacheEntryTest::ExternalAsyncIO() {
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
 
-  memset(buffer3->data(), 0, kSize3);
+  memset(buffer3->data().data(), 0, kSize3);
   ret = entry->ReadData(
       1, 10011, buffer3.get(), kSize3,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback4)));
@@ -491,7 +491,7 @@ void DiskCacheEntryTest::ExternalAsyncIO() {
     expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  EXPECT_STREQ("big data goes here", buffer3->data());
+  EXPECT_STREQ("big data goes here", buffer3->data().data());
   ret = entry->ReadData(
       1, 0, buffer2.get(), kSize2,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback5)));
@@ -500,8 +500,8 @@ void DiskCacheEntryTest::ExternalAsyncIO() {
     expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  memset(buffer3->data(), 0, kSize3);
-  EXPECT_EQ(0, memcmp(buffer2->data(), buffer3->data(), 10000));
+  memset(buffer3->data().data(), 0, kSize3);
+  EXPECT_EQ(0, memcmp(buffer2->data().data(), buffer3->data().data(), 10000));
   ret = entry->ReadData(
       1, 30000, buffer2.get(), kSize2,
       base::BindOnce(&CallbackTest::Run, base::Unretained(&callback6)));
@@ -609,10 +609,10 @@ void DiskCacheEntryTest::StreamAccess() {
     EXPECT_EQ(
         kBufferSize,
         WriteData(entry, i, 0, reference_buffers[i].get(), kBufferSize, false));
-    memset(buffer1->data(), 0, kBufferSize);
+    memset(buffer1->data().data(), 0, kBufferSize);
     EXPECT_EQ(kBufferSize, ReadData(entry, i, 0, buffer1.get(), kBufferSize));
-    EXPECT_EQ(
-        0, memcmp(reference_buffers[i]->data(), buffer1->data(), kBufferSize));
+    EXPECT_EQ(0, memcmp(reference_buffers[i]->data().data(),
+                        buffer1->data().data(), kBufferSize));
   }
   EXPECT_EQ(net::ERR_INVALID_ARGUMENT,
             ReadData(entry, kNumStreams, 0, buffer1.get(), kBufferSize));
@@ -627,21 +627,18 @@ void DiskCacheEntryTest::StreamAccess() {
                 "should be exactly two reads");
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kReadBufferSize);
   for (int i = 0; i < kNumStreams; i++) {
-    memset(buffer2->data(), 0, kReadBufferSize);
+    memset(buffer2->data().data(), 0, kReadBufferSize);
     EXPECT_EQ(kReadBufferSize,
               ReadData(entry, i, 0, buffer2.get(), kReadBufferSize));
-    EXPECT_EQ(
-        0,
-        memcmp(reference_buffers[i]->data(), buffer2->data(), kReadBufferSize));
+    EXPECT_EQ(0, memcmp(reference_buffers[i]->data().data(),
+                        buffer2->data().data(), kReadBufferSize));
 
-    memset(buffer2->data(), 0, kReadBufferSize);
+    memset(buffer2->data().data(), 0, kReadBufferSize);
     EXPECT_EQ(
         kFinalReadSize,
         ReadData(entry, i, kReadBufferSize, buffer2.get(), kReadBufferSize));
-    EXPECT_EQ(0,
-              memcmp(reference_buffers[i]->data() + kReadBufferSize,
-                     buffer2->data(),
-                     kFinalReadSize));
+    EXPECT_EQ(0, memcmp(reference_buffers[i]->data() + kReadBufferSize,
+                        buffer2->data().data(), kFinalReadSize));
   }
 
   entry->Close();
@@ -785,28 +782,28 @@ void DiskCacheEntryTest::GrowData(int stream_index) {
   auto buffer1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   CacheTestFillBuffer(buffer1->span(), false);
-  memset(buffer2->data(), 0, kSize);
+  memset(buffer2->data().data(), 0, kSize);
 
   base::strlcpy(buffer1->data(), "the data", kSize);
   EXPECT_EQ(10, WriteData(entry, stream_index, 0, buffer1.get(), 10, false));
   EXPECT_EQ(10, ReadData(entry, stream_index, 0, buffer2.get(), 10));
-  EXPECT_STREQ("the data", buffer2->data());
+  EXPECT_STREQ("the data", buffer2->data().data());
   EXPECT_EQ(10, entry->GetDataSize(stream_index));
 
   EXPECT_EQ(2000,
             WriteData(entry, stream_index, 0, buffer1.get(), 2000, false));
   EXPECT_EQ(2000, entry->GetDataSize(stream_index));
   EXPECT_EQ(2000, ReadData(entry, stream_index, 0, buffer2.get(), 2000));
-  EXPECT_TRUE(!memcmp(buffer1->data(), buffer2->data(), 2000));
+  EXPECT_TRUE(!memcmp(buffer1->data().data(), buffer2->data().data(), 2000));
 
   EXPECT_EQ(20000,
             WriteData(entry, stream_index, 0, buffer1.get(), kSize, false));
   EXPECT_EQ(20000, entry->GetDataSize(stream_index));
   EXPECT_EQ(20000, ReadData(entry, stream_index, 0, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer1->data(), buffer2->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer1->data().data(), buffer2->data().data(), kSize));
   entry->Close();
 
-  memset(buffer2->data(), 0, kSize);
+  memset(buffer2->data().data(), 0, kSize);
   std::string key2("Second key");
   ASSERT_THAT(CreateEntry(key2, &entry), IsOk());
   EXPECT_EQ(10, WriteData(entry, stream_index, 0, buffer1.get(), 10, false));
@@ -819,9 +816,9 @@ void DiskCacheEntryTest::GrowData(int stream_index) {
             WriteData(entry, stream_index, 0, buffer1.get(), 2000, false));
   EXPECT_EQ(2000, entry->GetDataSize(stream_index));
   EXPECT_EQ(2000, ReadData(entry, stream_index, 0, buffer2.get(), 2000));
-  EXPECT_TRUE(!memcmp(buffer1->data(), buffer2->data(), 2000));
+  EXPECT_TRUE(!memcmp(buffer1->data().data(), buffer2->data().data(), 2000));
   entry->Close();
-  memset(buffer2->data(), 0, kSize);
+  memset(buffer2->data().data(), 0, kSize);
 
   // Go from an internal address to an external one.
   ASSERT_THAT(OpenEntry(key2, &entry), IsOk());
@@ -829,7 +826,7 @@ void DiskCacheEntryTest::GrowData(int stream_index) {
             WriteData(entry, stream_index, 0, buffer1.get(), kSize, false));
   EXPECT_EQ(20000, entry->GetDataSize(stream_index));
   EXPECT_EQ(20000, ReadData(entry, stream_index, 0, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer1->data(), buffer2->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer1->data().data(), buffer2->data().data(), kSize));
   entry->Close();
 
   // Double check the size from disk.
@@ -874,7 +871,7 @@ void DiskCacheEntryTest::TruncateData(int stream_index) {
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize2);
 
   CacheTestFillBuffer(buffer1->span(), false);
-  memset(buffer2->data(), 0, kSize2);
+  memset(buffer2->data().data(), 0, kSize2);
 
   // Simple truncation:
   EXPECT_EQ(200, WriteData(entry, stream_index, 0, buffer1.get(), 200, false));
@@ -895,8 +892,8 @@ void DiskCacheEntryTest::TruncateData(int stream_index) {
             WriteData(entry, stream_index, 0, buffer1.get(), 20000, true));
   EXPECT_EQ(20000, entry->GetDataSize(stream_index));
   EXPECT_EQ(20000, ReadData(entry, stream_index, 0, buffer2.get(), 20000));
-  EXPECT_TRUE(!memcmp(buffer1->data(), buffer2->data(), 20000));
-  memset(buffer2->data(), 0, kSize2);
+  EXPECT_TRUE(!memcmp(buffer1->data().data(), buffer2->data().data(), 20000));
+  memset(buffer2->data().data(), 0, kSize2);
 
   // External file truncation
   EXPECT_EQ(18000,
@@ -913,9 +910,9 @@ void DiskCacheEntryTest::TruncateData(int stream_index) {
             WriteData(entry, stream_index, 1000, buffer1.get(), 600, true));
   EXPECT_EQ(1600, entry->GetDataSize(stream_index));
   EXPECT_EQ(600, ReadData(entry, stream_index, 1000, buffer2.get(), 600));
-  EXPECT_TRUE(!memcmp(buffer1->data(), buffer2->data(), 600));
+  EXPECT_TRUE(!memcmp(buffer1->data().data(), buffer2->data().data(), 600));
   EXPECT_EQ(1000, ReadData(entry, stream_index, 0, buffer2.get(), 1000));
-  EXPECT_TRUE(!memcmp(buffer1->data(), buffer2->data(), 1000))
+  EXPECT_TRUE(!memcmp(buffer1->data().data(), buffer2->data().data(), 1000))
       << "Preserves previous data";
 
   // Go from external file to zero length.
@@ -970,15 +967,15 @@ void DiskCacheEntryTest::ZeroLengthIO(int stream_index) {
 
   CacheTestFillBuffer(buffer->span(), false);
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 500, buffer.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer->data(), zeros, kSize));
+  EXPECT_TRUE(!memcmp(buffer->data().data(), zeros, kSize));
 
   CacheTestFillBuffer(buffer->span(), false);
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 5000, buffer.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer->data(), zeros, kSize));
+  EXPECT_TRUE(!memcmp(buffer->data().data(), zeros, kSize));
 
   CacheTestFillBuffer(buffer->span(), false);
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 50000, buffer.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer->data(), zeros, kSize));
+  EXPECT_TRUE(!memcmp(buffer->data().data(), zeros, kSize));
 
   entry->Close();
 }
@@ -1020,7 +1017,7 @@ void DiskCacheEntryTest::Buffering() {
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
   EXPECT_EQ(kSize, WriteData(entry, 1, 5000, buffer1.get(), kSize, false));
   EXPECT_EQ(kSize, ReadData(entry, 1, 0, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
 
   // Now go to an external file.
   EXPECT_EQ(kSize, WriteData(entry, 1, 18000, buffer1.get(), kSize, false));
@@ -1031,13 +1028,13 @@ void DiskCacheEntryTest::Buffering() {
   EXPECT_EQ(kSize, WriteData(entry, 1, 10000, buffer1.get(), kSize, false));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, 1, 5000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, 1, 0, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, 1, 18000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
 
   // Extend the file some more.
   EXPECT_EQ(kSize, WriteData(entry, 1, 23000, buffer1.get(), kSize, false));
@@ -1051,29 +1048,29 @@ void DiskCacheEntryTest::Buffering() {
   EXPECT_EQ(kSize, WriteData(entry, 1, 19000, buffer1.get(), kSize, false));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, 1, 18000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, 1, 17000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
 
   EXPECT_EQ(kSize, WriteData(entry, 1, 22900, buffer1.get(), kSize, false));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(100, ReadData(entry, 1, 23000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data() + 100, 100));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data() + 100, 100));
 
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(100, ReadData(entry, 1, 23100, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data() + 100, 100));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data() + 100, 100));
 
   // Extend the file again and read before without closing the entry.
   EXPECT_EQ(kSize, WriteData(entry, 1, 25000, buffer1.get(), kSize, false));
   EXPECT_EQ(kSize, WriteData(entry, 1, 45000, buffer1.get(), kSize, false));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, 1, 25000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, 1, 45000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data(), kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), buffer1->data().data(), kSize));
 
   entry->Close();
 }
@@ -1141,19 +1138,21 @@ void DiskCacheEntryTest::SizeChanges(int stream_index) {
             WriteData(entry, stream_index, 25000, buffer1.get(), kSize, true));
   EXPECT_EQ(25000 + kSize, entry->GetDataSize(stream_index));
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 24000, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), zeros, kSize));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), zeros, kSize));
 
   // Read at the end of the old file size.
   EXPECT_EQ(
       kSize,
       ReadData(entry, stream_index, 23000 + kSize - 35, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data() + kSize - 35, 35));
+  EXPECT_TRUE(
+      !memcmp(buffer2->data().data(), buffer1->data() + kSize - 35, 35));
 
   // Read slightly before the last write.
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 24900, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), zeros, 100));
-  EXPECT_TRUE(!memcmp(buffer2->data() + 100, buffer1->data(), kSize - 100));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), zeros, 100));
+  EXPECT_TRUE(
+      !memcmp(buffer2->data() + 100, buffer1->data().data(), kSize - 100));
 
   // Extend the entry a little more.
   EXPECT_EQ(kSize,
@@ -1161,8 +1160,9 @@ void DiskCacheEntryTest::SizeChanges(int stream_index) {
   EXPECT_EQ(26000 + kSize, entry->GetDataSize(stream_index));
   CacheTestFillBuffer(buffer2->span(), true);
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 25900, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), zeros, 100));
-  EXPECT_TRUE(!memcmp(buffer2->data() + 100, buffer1->data(), kSize - 100));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), zeros, 100));
+  EXPECT_TRUE(
+      !memcmp(buffer2->data() + 100, buffer1->data().data(), kSize - 100));
 
   // And now reduce the size.
   EXPECT_EQ(kSize,
@@ -1171,7 +1171,8 @@ void DiskCacheEntryTest::SizeChanges(int stream_index) {
   EXPECT_EQ(
       28,
       ReadData(entry, stream_index, 25000 + kSize - 28, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), buffer1->data() + kSize - 28, 28));
+  EXPECT_TRUE(
+      !memcmp(buffer2->data().data(), buffer1->data() + kSize - 28, 28));
 
   // Reduce the size with a buffer that is not extending the size.
   EXPECT_EQ(kSize,
@@ -1181,16 +1182,18 @@ void DiskCacheEntryTest::SizeChanges(int stream_index) {
             WriteData(entry, stream_index, 24500, buffer1.get(), kSize, true));
   EXPECT_EQ(24500 + kSize, entry->GetDataSize(stream_index));
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 23900, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), zeros, 100));
-  EXPECT_TRUE(!memcmp(buffer2->data() + 100, buffer1->data(), kSize - 100));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), zeros, 100));
+  EXPECT_TRUE(
+      !memcmp(buffer2->data() + 100, buffer1->data().data(), kSize - 100));
 
   // And now reduce the size below the old size.
   EXPECT_EQ(kSize,
             WriteData(entry, stream_index, 19000, buffer1.get(), kSize, true));
   EXPECT_EQ(19000 + kSize, entry->GetDataSize(stream_index));
   EXPECT_EQ(kSize, ReadData(entry, stream_index, 18900, buffer2.get(), kSize));
-  EXPECT_TRUE(!memcmp(buffer2->data(), zeros, 100));
-  EXPECT_TRUE(!memcmp(buffer2->data() + 100, buffer1->data(), kSize - 100));
+  EXPECT_TRUE(!memcmp(buffer2->data().data(), zeros, 100));
+  EXPECT_TRUE(
+      !memcmp(buffer2->data() + 100, buffer1->data().data(), kSize - 100));
 
   // Verify that the actual file is truncated.
   entry->Close();
@@ -1203,7 +1206,7 @@ void DiskCacheEntryTest::SizeChanges(int stream_index) {
       WriteData(entry, stream_index, 20000 + kSize, buffer1.get(), 0, false));
   EXPECT_EQ(kSize,
             ReadData(entry, stream_index, 19000 + kSize, buffer1.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer1->data(), zeros, kSize));
+  EXPECT_EQ(0, memcmp(buffer1->data().data(), zeros, kSize));
 
   entry->Close();
 }
@@ -1286,14 +1289,14 @@ void DiskCacheEntryTest::InvalidData(int stream_index) {
   auto buffer3 = base::MakeRefCounted<net::IOBufferWithSize>(kSize3);
 
   CacheTestFillBuffer(buffer1->span(), false);
-  memset(buffer2->data(), 0, kSize2);
+  memset(buffer2->data().data(), 0, kSize2);
 
   // Simple data grow:
   EXPECT_EQ(200,
             WriteData(entry, stream_index, 400, buffer1.get(), 200, false));
   EXPECT_EQ(600, entry->GetDataSize(stream_index));
   EXPECT_EQ(100, ReadData(entry, stream_index, 300, buffer3.get(), 100));
-  EXPECT_TRUE(!memcmp(buffer3->data(), buffer2->data(), 100));
+  EXPECT_TRUE(!memcmp(buffer3->data().data(), buffer2->data().data(), 100));
   entry->Close();
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
 
@@ -1302,7 +1305,7 @@ void DiskCacheEntryTest::InvalidData(int stream_index) {
             WriteData(entry, stream_index, 800, buffer1.get(), 200, false));
   EXPECT_EQ(1000, entry->GetDataSize(stream_index));
   EXPECT_EQ(100, ReadData(entry, stream_index, 700, buffer3.get(), 100));
-  EXPECT_TRUE(!memcmp(buffer3->data(), buffer2->data(), 100));
+  EXPECT_TRUE(!memcmp(buffer3->data().data(), buffer2->data().data(), 100));
   entry->Close();
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
 
@@ -1311,35 +1314,35 @@ void DiskCacheEntryTest::InvalidData(int stream_index) {
             WriteData(entry, stream_index, 1800, buffer1.get(), 200, true));
   EXPECT_EQ(2000, entry->GetDataSize(stream_index));
   EXPECT_EQ(100, ReadData(entry, stream_index, 1500, buffer3.get(), 100));
-  EXPECT_TRUE(!memcmp(buffer3->data(), buffer2->data(), 100));
+  EXPECT_TRUE(!memcmp(buffer3->data().data(), buffer2->data().data(), 100));
 
   // Go to an external file.
   EXPECT_EQ(200,
             WriteData(entry, stream_index, 19800, buffer1.get(), 200, false));
   EXPECT_EQ(20000, entry->GetDataSize(stream_index));
   EXPECT_EQ(4000, ReadData(entry, stream_index, 14000, buffer3.get(), 4000));
-  EXPECT_TRUE(!memcmp(buffer3->data(), buffer2->data(), 4000));
+  EXPECT_TRUE(!memcmp(buffer3->data().data(), buffer2->data().data(), 4000));
 
   // And back to an internal block.
   EXPECT_EQ(600,
             WriteData(entry, stream_index, 1000, buffer1.get(), 600, true));
   EXPECT_EQ(1600, entry->GetDataSize(stream_index));
   EXPECT_EQ(600, ReadData(entry, stream_index, 1000, buffer3.get(), 600));
-  EXPECT_TRUE(!memcmp(buffer3->data(), buffer1->data(), 600));
+  EXPECT_TRUE(!memcmp(buffer3->data().data(), buffer1->data().data(), 600));
 
   // Extend it again.
   EXPECT_EQ(600,
             WriteData(entry, stream_index, 2000, buffer1.get(), 600, false));
   EXPECT_EQ(2600, entry->GetDataSize(stream_index));
   EXPECT_EQ(200, ReadData(entry, stream_index, 1800, buffer3.get(), 200));
-  EXPECT_TRUE(!memcmp(buffer3->data(), buffer2->data(), 200));
+  EXPECT_TRUE(!memcmp(buffer3->data().data(), buffer2->data().data(), 200));
 
   // And again (with truncation flag).
   EXPECT_EQ(600,
             WriteData(entry, stream_index, 3000, buffer1.get(), 600, true));
   EXPECT_EQ(3600, entry->GetDataSize(stream_index));
   EXPECT_EQ(200, ReadData(entry, stream_index, 2800, buffer3.get(), 200));
-  EXPECT_TRUE(!memcmp(buffer3->data(), buffer2->data(), 200));
+  EXPECT_TRUE(!memcmp(buffer3->data().data(), buffer2->data().data(), 200));
 
   entry->Close();
 }
@@ -1410,7 +1413,7 @@ void DiskCacheEntryTest::DoomNormalEntry() {
   CacheTestFillBuffer(buffer->span(), true);
   buffer->data()[19999] = '\0';
 
-  key = buffer->data();
+  key = buffer->data().data();
   ASSERT_THAT(CreateEntry(key, &entry), IsOk());
   EXPECT_EQ(20000, WriteData(entry, 0, 0, buffer.get(), kSize, false));
   EXPECT_EQ(20000, WriteData(entry, 1, 0, buffer.get(), kSize, false));
@@ -1491,12 +1494,12 @@ void DiskCacheEntryTest::DoomedEntry(int stream_index) {
   auto buffer1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize1);
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize2);
   CacheTestFillBuffer(buffer1->span(), false);
-  memset(buffer2->data(), 0, kSize2);
+  memset(buffer2->data().data(), 0, kSize2);
 
   EXPECT_EQ(2000,
             WriteData(entry, stream_index, 0, buffer1.get(), 2000, false));
   EXPECT_EQ(2000, ReadData(entry, stream_index, 0, buffer2.get(), 2000));
-  EXPECT_EQ(0, memcmp(buffer1->data(), buffer2->data(), kSize1));
+  EXPECT_EQ(0, memcmp(buffer1->data().data(), buffer2->data().data(), kSize1));
   EXPECT_EQ(key, entry->GetKey());
   EXPECT_TRUE(initial < entry->GetLastModified());
   EXPECT_TRUE(initial < entry->GetLastUsed());
@@ -1592,7 +1595,7 @@ void VerifySparseIO(disk_cache::Entry* entry,
                     net::IOBuffer* buf_2) {
   net::TestCompletionCallback cb;
 
-  memset(buf_2->data(), 0, size);
+  memset(buf_2->data().data(), 0, size);
   const auto size_i = base::checked_cast<int>(size);
   int ret = entry->ReadSparseData(offset, buf_2, size_i, cb.callback());
   EXPECT_EQ(0, cb.GetResult(ret));
@@ -1603,7 +1606,7 @@ void VerifySparseIO(disk_cache::Entry* entry,
   ret = entry->ReadSparseData(offset, buf_2, size_i, cb.callback());
   EXPECT_EQ(size_i, cb.GetResult(ret));
 
-  EXPECT_EQ(0, memcmp(buf_1->data(), buf_2->data(), size));
+  EXPECT_EQ(0, memcmp(buf_1->data().data(), buf_2->data().data(), size));
 }
 
 // Reads |size| bytes from |entry| at |offset| and verifies that they are the
@@ -1615,11 +1618,11 @@ void VerifyContentSparseIO(disk_cache::Entry* entry,
   net::TestCompletionCallback cb;
 
   auto buf_1 = base::MakeRefCounted<net::IOBufferWithSize>(size);
-  memset(buf_1->data(), 0, size);
+  memset(buf_1->data().data(), 0, size);
   const auto size_i = base::checked_cast<int>(size);
   int ret = entry->ReadSparseData(offset, buf_1.get(), size_i, cb.callback());
   EXPECT_EQ(size_i, cb.GetResult(ret));
-  EXPECT_EQ(0, memcmp(buf_1->data(), buffer, size));
+  EXPECT_EQ(0, memcmp(buf_1->data().data(), buffer, size));
 }
 
 void DiskCacheEntryTest::BasicSparseIO() {
@@ -1924,7 +1927,8 @@ TEST_F(DiskCacheEntryTest, SparseWriteDropped) {
   EXPECT_EQ(1024 * 7, result.start);
   rv = entry->ReadSparseData(result.start, buf_2.get(), kSize, cb.callback());
   EXPECT_EQ(80, cb.GetResult(rv));
-  EXPECT_EQ(0, memcmp(buf_1.get()->data() + 100, buf_2.get()->data(), 80));
+  EXPECT_EQ(0,
+            memcmp(buf_1.get()->data() + 100, buf_2.get()->data().data(), 80));
 
   // And even that part is dropped when another write changes the offset.
   offset = result.start;
@@ -1968,7 +1972,8 @@ TEST_F(DiskCacheEntryTest, SparseSquentialWriteNotDropped) {
 
     rv = entry->ReadSparseData(offset, buf_2.get(), kSize, cb.callback());
     EXPECT_EQ(kSize, cb.GetResult(rv));
-    EXPECT_EQ(0, memcmp(buf_1.get()->data(), buf_2.get()->data(), kSize));
+    EXPECT_EQ(0, memcmp(buf_1.get()->data().data(), buf_2.get()->data().data(),
+                        kSize));
   }
 
   entry->Close();
@@ -1985,7 +1990,8 @@ TEST_F(DiskCacheEntryTest, SparseSquentialWriteNotDropped) {
 
   rv = entry->ReadSparseData(offset, buf_2.get(), kSize, cb.callback());
   EXPECT_EQ(kSize, cb.GetResult(rv));
-  EXPECT_EQ(0, memcmp(buf_1.get()->data(), buf_2.get()->data(), kSize));
+  EXPECT_EQ(
+      0, memcmp(buf_1.get()->data().data(), buf_2.get()->data().data(), kSize));
 
   entry->Close();
 }
@@ -2319,11 +2325,11 @@ void DiskCacheEntryTest::PartialSparseEntry() {
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
 
   auto buf2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buf2->data(), 0, kSize);
+  memset(buf2->data().data(), 0, kSize);
   EXPECT_EQ(0, ReadSparseData(entry, 8000, buf2.get(), kSize));
 
   EXPECT_EQ(500, ReadSparseData(entry, kSize, buf2.get(), kSize));
-  EXPECT_EQ(0, memcmp(buf2->data(), buf1->data() + kSize - 500, 500));
+  EXPECT_EQ(0, memcmp(buf2->data().data(), buf1->data() + kSize - 500, 500));
   EXPECT_EQ(0, ReadSparseData(entry, 0, buf2.get(), kSize));
 
   // This read should not change anything.
@@ -2394,8 +2400,8 @@ void DiskCacheEntryTest::PartialSparseEntry() {
   EXPECT_EQ(7 * 1024 + 500, result.available_len);
   EXPECT_EQ(1024, result.start);
   EXPECT_EQ(kSize, ReadSparseData(entry, kSize, buf2.get(), kSize));
-  EXPECT_EQ(0, memcmp(buf2->data(), buf1->data() + kSize - 500, 500));
-  EXPECT_EQ(0, memcmp(buf2->data() + 500, buf1->data(), kSize - 500));
+  EXPECT_EQ(0, memcmp(buf2->data().data(), buf1->data() + kSize - 500, 500));
+  EXPECT_EQ(0, memcmp(buf2->data() + 500, buf1->data().data(), kSize - 500));
 
   entry->Close();
 }
@@ -2487,7 +2493,7 @@ void DiskCacheEntryTest::SparseClipEnd(int64_t max_index,
     EXPECT_EQ(rv, net::ERR_CACHE_OPERATION_NOT_SUPPORTED);
   } else {
     EXPECT_EQ(kSize, rv);
-    EXPECT_EQ(0, memcmp(buf->data(), read_buf->data(), kSize));
+    EXPECT_EQ(0, memcmp(buf->data().data(), read_buf->data().data(), kSize));
   }
 
   TestRangeResultCompletionCallback cb;
@@ -2959,7 +2965,7 @@ bool DiskCacheEntryTest::SimpleCacheMakeBadChecksumEntry(const std::string& key,
   }
 
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(data_size);
-  memset(buffer->data(), 'A', data_size);
+  memset(buffer->data().data(), 'A', data_size);
 
   EXPECT_EQ(data_size, WriteData(entry, 1, 0, buffer.get(), data_size, false));
   entry->Close();
@@ -3280,9 +3286,8 @@ TEST_F(DiskCacheEntryTest,
 
   helper.WaitUntilCacheIoFinished(expected_callback_runs);
   ASSERT_EQ(read_buffer->size(), write_buffer->size());
-  EXPECT_EQ(
-      0,
-      memcmp(read_buffer->data(), write_buffer->data(), read_buffer->size()));
+  EXPECT_EQ(0, memcmp(read_buffer->data().data(), write_buffer->data().data(),
+                      read_buffer->size()));
 }
 
 TEST_F(DiskCacheEntryTest, SimpleCacheOptimistic) {
@@ -3336,7 +3341,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheOptimistic) {
                                            base::Unretained(&callback3))));
   expected++;
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  EXPECT_EQ(0, memcmp(buffer1->data(), buffer1_read->data(), kSize1));
+  EXPECT_EQ(
+      0, memcmp(buffer1->data().data(), buffer1_read->data().data(), kSize1));
 
   // At this point after waiting, the pending operations queue on the entry
   // should be empty, so the next Write operation must run as optimistic.
@@ -3355,7 +3361,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheOptimistic) {
   expected++;
 
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
-  EXPECT_EQ(0, memcmp(buffer2->data(), buffer2_read->data(), kSize2));
+  EXPECT_EQ(
+      0, memcmp(buffer2->data().data(), buffer2_read->data().data(), kSize2));
 
   // Check that we are not leaking.
   EXPECT_NE(entry, null);
@@ -3568,7 +3575,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheOptimistic6) {
   EXPECT_EQ(net::ERR_IO_PENDING,
             entry->ReadData(1, 0, buffer1_read.get(), kSize1, cb.callback()));
   EXPECT_EQ(kSize1, cb.GetResult(net::ERR_IO_PENDING));
-  EXPECT_EQ(0, memcmp(buffer1->data(), buffer1_read->data(), kSize1));
+  EXPECT_EQ(
+      0, memcmp(buffer1->data().data(), buffer1_read->data().data(), kSize1));
 
   entry->Doom();
 }
@@ -4015,8 +4023,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheInFlightTruncate)  {
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
   EXPECT_EQ(kReadBufferSize, read_callback.last_result());
   EXPECT_EQ(kReadBufferSize, truncate_callback.last_result());
-  EXPECT_EQ(0,
-            memcmp(write_buffer->data(), read_buffer->data(), kReadBufferSize));
+  EXPECT_EQ(0, memcmp(write_buffer->data().data(), read_buffer->data().data(),
+                      kReadBufferSize));
 }
 
 // Tests that if a write and a read dependant on it are both in flight
@@ -4059,7 +4067,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheInFlightRead) {
   EXPECT_TRUE(helper.WaitUntilCacheIoFinished(expected));
   EXPECT_EQ(kBufferSize, write_callback.last_result());
   EXPECT_EQ(kBufferSize, read_callback.last_result());
-  EXPECT_EQ(0, memcmp(write_buffer->data(), read_buffer->data(), kBufferSize));
+  EXPECT_EQ(0, memcmp(write_buffer->data().data(), read_buffer->data().data(),
+                      kBufferSize));
 }
 
 TEST_F(DiskCacheEntryTest, SimpleCacheOpenCreateRaceWithNoIndex) {
@@ -4157,15 +4166,16 @@ TEST_F(DiskCacheEntryTest, SimpleCacheReadCombineCRC) {
   int buf_len = kHalfSize;
   auto buffer1_read1 = base::MakeRefCounted<net::IOBufferWithSize>(buf_len);
   EXPECT_EQ(buf_len, ReadData(entry2, 1, offset, buffer1_read1.get(), buf_len));
-  EXPECT_EQ(0, memcmp(buffer1->data(), buffer1_read1->data(), buf_len));
+  EXPECT_EQ(
+      0, memcmp(buffer1->data().data(), buffer1_read1->data().data(), buf_len));
 
   // Read the second half of the data.
   offset = buf_len;
   buf_len = kHalfSize;
   auto buffer1_read2 = base::MakeRefCounted<net::IOBufferWithSize>(buf_len);
   EXPECT_EQ(buf_len, ReadData(entry2, 1, offset, buffer1_read2.get(), buf_len));
-  char* buffer1_data = buffer1->data() + offset;
-  EXPECT_EQ(0, memcmp(buffer1_data, buffer1_read2->data(), buf_len));
+  char* buffer1_data = buffer1->data().subspan(offset).data();
+  EXPECT_EQ(0, memcmp(buffer1_data, buffer1_read2->data().data(), buf_len));
 
   // Check that we are not leaking.
   EXPECT_NE(entry, null);
@@ -4191,8 +4201,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheNonSequentialWrite) {
   auto buffer1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   CacheTestFillBuffer(buffer1->span(), false);
-  char* buffer1_data = buffer1->data() + kHalfSize;
-  memcpy(buffer2->data(), buffer1_data, kHalfSize);
+  char* buffer1_data = buffer1->data().subspan(kHalfSize).data();
+  memcpy(buffer2->data().data(), buffer1_data, kHalfSize);
 
   disk_cache::Entry* entry = nullptr;
   ASSERT_THAT(CreateEntry(key, &entry), IsOk());
@@ -4216,7 +4226,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheNonSequentialWrite) {
 
     auto buffer1_read1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
     EXPECT_EQ(kSize, ReadData(entry, i, 0, buffer1_read1.get(), kSize));
-    EXPECT_EQ(0, memcmp(buffer1->data(), buffer1_read1->data(), kSize));
+    EXPECT_EQ(
+        0, memcmp(buffer1->data().data(), buffer1_read1->data().data(), kSize));
     // Check that we are not leaking.
     ASSERT_NE(entry, null);
     EXPECT_TRUE(static_cast<disk_cache::SimpleEntryImpl*>(entry)->HasOneRef());
@@ -4242,7 +4253,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheStream1SizeChanges) {
   // Write something into stream0.
   EXPECT_EQ(kSize, WriteData(entry, 0, 0, buffer.get(), kSize, false));
   EXPECT_EQ(kSize, ReadData(entry, 0, 0, buffer_read.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer->data(), buffer_read->data(), kSize));
+  EXPECT_EQ(0,
+            memcmp(buffer->data().data(), buffer_read->data().data(), kSize));
   entry->Close();
 
   // Extend stream1.
@@ -4279,7 +4291,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheStream1SizeChanges) {
 
   buffer_read = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   EXPECT_EQ(kSize, ReadData(entry, 0, 0, buffer_read.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer->data(), buffer_read->data(), kSize));
+  EXPECT_EQ(0,
+            memcmp(buffer->data().data(), buffer_read->data().data(), kSize));
 
   // Shrink stream1.
   stream1_size = 50;
@@ -4291,7 +4304,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheStream1SizeChanges) {
   buffer_read = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
   EXPECT_EQ(kSize, ReadData(entry, 0, 0, buffer_read.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer->data(), buffer_read->data(), kSize));
+  EXPECT_EQ(0,
+            memcmp(buffer->data().data(), buffer_read->data().data(), kSize));
   entry->Close();
   entry = nullptr;
 }
@@ -4336,10 +4350,10 @@ TEST_F(DiskCacheEntryTest, SimpleCacheCRCRewrite) {
 
     auto buffer1_read1 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
     EXPECT_EQ(kSize, ReadData(entry, i, 0, buffer1_read1.get(), kSize));
-    EXPECT_EQ(0, memcmp(buffer1->data(), buffer1_read1->data(), kHalfSize));
-    EXPECT_EQ(
-        0,
-        memcmp(buffer2->data(), buffer1_read1->data() + kHalfSize, kHalfSize));
+    EXPECT_EQ(0, memcmp(buffer1->data().data(), buffer1_read1->data().data(),
+                        kHalfSize));
+    EXPECT_EQ(0, memcmp(buffer2->data().data(),
+                        buffer1_read1->data() + kHalfSize, kHalfSize));
 
     entry->Close();
   }
@@ -4493,7 +4507,8 @@ TEST_F(DiskCacheEntryTest, SimpleCacheOmittedThirdStream3) {
 
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
   EXPECT_EQ(kHalfSize, ReadData(entry, 2, 0, buffer2.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer1->data(), buffer2->data(), kHalfSize));
+  EXPECT_EQ(0,
+            memcmp(buffer1->data().data(), buffer2->data().data(), kHalfSize));
   entry->Close();
   EXPECT_TRUE(SimpleCacheThirdStreamFileExists(key));
 
@@ -4856,7 +4871,7 @@ TEST_F(DiskCacheEntryTest, SimpleCacheReadWithoutKeySHA256) {
       static_cast<int>(stream_0_data.size()),
       ReadData(entry, 0, 0, check_stream_0_data.get(), stream_0_data.size()));
   EXPECT_EQ(0, stream_0_data.compare(0, std::string::npos,
-                                     check_stream_0_data->data(),
+                                     check_stream_0_data->data().data(),
                                      stream_0_data.size()));
 
   EXPECT_EQ(static_cast<int>(stream_1_data.size()), entry->GetDataSize(1));
@@ -4866,7 +4881,7 @@ TEST_F(DiskCacheEntryTest, SimpleCacheReadWithoutKeySHA256) {
       static_cast<int>(stream_1_data.size()),
       ReadData(entry, 1, 0, check_stream_1_data.get(), stream_1_data.size()));
   EXPECT_EQ(0, stream_1_data.compare(0, std::string::npos,
-                                     check_stream_1_data->data(),
+                                     check_stream_1_data->data().data(),
                                      stream_1_data.size()));
 }
 
@@ -5060,10 +5075,12 @@ TEST_F(DiskCacheEntryTest, SimpleCacheCreateCollision) {
   // re-open it).
   EXPECT_EQ(kSize, WriteData(entry1, 0, 0, buffer1.get(), kSize, false));
   EXPECT_EQ(kSize, ReadData(entry1, 0, 0, read_buffer.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer1->data(), read_buffer->data(), kSize));
+  EXPECT_EQ(0,
+            memcmp(buffer1->data().data(), read_buffer->data().data(), kSize));
 
   EXPECT_EQ(kSize, ReadData(entry2, 0, 0, read_buffer.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer2->data(), read_buffer->data(), kSize));
+  EXPECT_EQ(0,
+            memcmp(buffer2->data().data(), read_buffer->data().data(), kSize));
 
   entry1->Close();
   entry2->Close();
@@ -5095,7 +5112,7 @@ TEST_F(DiskCacheEntryTest, SimpleCacheConvertToSparseStream2LeftOver) {
   ASSERT_THAT(OpenEntry(key, &entry), IsOk());
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   EXPECT_EQ(kSize, ReadSparseData(entry, 5, buffer2.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer->data(), buffer2->data(), kSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), buffer2->data().data(), kSize));
   entry->Close();
 }
 
@@ -5165,9 +5182,10 @@ TEST_F(DiskCacheEntryTest, SimpleCacheChecksumpScrewUp) {
   ASSERT_THAT(OpenEntry(kKey, &entry), IsOk());
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
   EXPECT_EQ(kSize, ReadData(entry, 1, 0, buffer2.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer->data(), buffer2->data(), kSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), buffer2->data().data(), kSize));
   EXPECT_EQ(kSize, ReadData(entry, 1, kSize, buffer2.get(), kSize));
-  EXPECT_EQ(0, memcmp(big_buffer->data() + kSize, buffer2->data(), kSize));
+  EXPECT_EQ(0,
+            memcmp(big_buffer->data() + kSize, buffer2->data().data(), kSize));
   entry->Close();
 }
 
@@ -5253,22 +5271,24 @@ void DiskCacheEntryTest::TruncateBackwards() {
                                   /* offset = */ kBigSize, buffer.get(),
                                   /* size = */ kSmallSize,
                                   /* truncate = */ false));
-  memset(read_buf->data(), 0, kBigSize);
+  memset(read_buf->data().data(), 0, kBigSize);
   ASSERT_EQ(kSmallSize, ReadData(entry, /* index = */ 0,
                                  /* offset = */ kBigSize, read_buf.get(),
                                  /* size = */ kSmallSize));
-  EXPECT_EQ(0, memcmp(read_buf->data(), buffer->data(), kSmallSize));
+  EXPECT_EQ(0,
+            memcmp(read_buf->data().data(), buffer->data().data(), kSmallSize));
 
   // A partly overlapping truncate before the previous write.
   ASSERT_EQ(kBigSize,
             WriteData(entry, /* index = */ 0,
                       /* offset = */ 3, buffer.get(), /* size = */ kBigSize,
                       /* truncate = */ true));
-  memset(read_buf->data(), 0, kBigSize);
+  memset(read_buf->data().data(), 0, kBigSize);
   ASSERT_EQ(kBigSize,
             ReadData(entry, /* index = */ 0,
                      /* offset = */ 3, read_buf.get(), /* size = */ kBigSize));
-  EXPECT_EQ(0, memcmp(read_buf->data(), buffer->data(), kBigSize));
+  EXPECT_EQ(0,
+            memcmp(read_buf->data().data(), buffer->data().data(), kBigSize));
   EXPECT_EQ(kBigSize + 3, entry->GetDataSize(0));
   entry->Close();
 }
@@ -5440,9 +5460,9 @@ TEST_F(DiskCacheEntryTest, SimpleCacheCloseResurrection) {
 
   // Make sure |entry2| is still usable.
   auto buffer2 = base::MakeRefCounted<net::IOBufferWithSize>(kSize);
-  memset(buffer2->data(), 0, kSize);
+  memset(buffer2->data().data(), 0, kSize);
   EXPECT_EQ(kSize, ReadData(entry2, 1, 0, buffer2.get(), kSize));
-  EXPECT_EQ(0, memcmp(buffer->data(), buffer2->data(), kSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), buffer2->data().data(), kSize));
   entry2->Close();
 }
 
@@ -5576,7 +5596,8 @@ class DiskCacheSimplePrefetchTest : public DiskCacheEntryTest {
     // so that the only difference between here and InitCacheAndCreateEntry()
     // would be whether the result has a checkum or not.
     auto second_half = base::MakeRefCounted<net::IOBufferWithSize>(kRemSize);
-    memcpy(second_half->data(), payload_->data() + kHalfSize, kRemSize);
+    memcpy(second_half->data().data(),
+           payload_->data().subspan(kHalfSize).data(), kRemSize);
     ASSERT_EQ(kRemSize, WriteData(entry, 1, kHalfSize, second_half.get(),
                                   kRemSize, false));
     entry->Close();
@@ -5596,7 +5617,8 @@ class DiskCacheSimplePrefetchTest : public DiskCacheEntryTest {
       EXPECT_EQ(net::ERR_IO_PENDING, rv);
     rv = cb.GetResult(rv);
     EXPECT_EQ(kEntrySize, rv);
-    EXPECT_EQ(0, memcmp(read_buf->data(), payload_->data(), kEntrySize));
+    EXPECT_EQ(0, memcmp(read_buf->data().data(), payload_->data().data(),
+                        kEntrySize));
     entry->Close();
   }
 
@@ -5726,7 +5748,8 @@ TEST_F(DiskCacheSimplePrefetchTest, PrefetchReadsSync) {
   // if needed.
   EXPECT_EQ(kEntrySize, entry->ReadData(1, 0, read_buf.get(), kEntrySize,
                                         net::CompletionOnceCallback()));
-  EXPECT_EQ(0, memcmp(read_buf->data(), payload_->data(), kEntrySize));
+  EXPECT_EQ(
+      0, memcmp(read_buf->data().data(), payload_->data().data(), kEntrySize));
   entry->Close();
 }
 
diff --git a/net/dns/dns_query_unittest.cc b/net/dns/dns_query_unittest.cc
index 97e6b10eb7ce5..469e2300403dc 100644
--- a/net/dns/dns_query_unittest.cc
+++ b/net/dns/dns_query_unittest.cc
@@ -42,7 +42,7 @@ bool ParseAndCreateDnsQueryFromRawPacket(const uint8_t* data,
                                          size_t length,
                                          std::unique_ptr<DnsQuery>* out) {
   auto packet = base::MakeRefCounted<IOBufferWithSize>(length);
-  memcpy(packet->data(), data, length);
+  memcpy(packet->data().data(), data, length);
   *out = std::make_unique<DnsQuery>(packet);
   return (*out)->Parse(length);
 }
@@ -89,8 +89,9 @@ TEST(DnsQueryTest, CopiesAreIndependent) {
   DnsQuery q2(q1);
 
   EXPECT_EQ(q1.id(), q2.id());
-  EXPECT_EQ(std::string_view(q1.io_buffer()->data(), q1.io_buffer()->size()),
-            std::string_view(q2.io_buffer()->data(), q2.io_buffer()->size()));
+  EXPECT_EQ(
+      std::string_view(q1.io_buffer()->data().data(), q1.io_buffer()->size()),
+      std::string_view(q2.io_buffer()->data().data(), q2.io_buffer()->size()));
   EXPECT_NE(q1.io_buffer(), q2.io_buffer());
 }
 
@@ -326,7 +327,7 @@ TEST(DnsQueryParseTest, ParsesLongName) {
       4);
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(data.size());
-  memcpy(packet->data(), data.data(), data.size());
+  memcpy(packet->data().data(), data.data(), data.size());
   DnsQuery query(packet);
 
   EXPECT_TRUE(query.Parse(data.size()));
@@ -360,7 +361,7 @@ TEST(DnsQueryParseTest, FailsTooLongName) {
       4);
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(data.size());
-  memcpy(packet->data(), data.data(), data.size());
+  memcpy(packet->data().data(), data.data(), data.size());
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(data.size()));
@@ -393,7 +394,7 @@ TEST(DnsQueryParseTest, FailsTooLongSingleLabelName) {
       4);
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(data.size());
-  memcpy(packet->data(), data.data(), data.size());
+  memcpy(packet->data().data(), data.data(), data.size());
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(data.size()));
@@ -415,7 +416,7 @@ TEST(DnsQueryParseTest, FailsNonendedName) {
       "\003www\006google\006test";  // Nonended name.
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(sizeof(kData) - 1);
-  memcpy(packet->data(), kData, sizeof(kData) - 1);
+  memcpy(packet->data().data(), kData, sizeof(kData) - 1);
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(sizeof(kData) - 1));
@@ -440,7 +441,7 @@ TEST(DnsQueryParseTest, FailsNameWithoutTerminator) {
       "\x00\x01";                  // CLASS=IN
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(sizeof(kData) - 1);
-  memcpy(packet->data(), kData, sizeof(kData) - 1);
+  memcpy(packet->data().data(), kData, sizeof(kData) - 1);
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(sizeof(kData) - 1));
@@ -456,7 +457,7 @@ TEST(DnsQueryParseTest, FailsQueryWithNoQuestions) {
       "\x00\x00";  // 0 additional records
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(sizeof(kData) - 1);
-  memcpy(packet->data(), kData, sizeof(kData) - 1);
+  memcpy(packet->data().data(), kData, sizeof(kData) - 1);
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(sizeof(kData) - 1));
@@ -478,7 +479,7 @@ TEST(DnsQueryParseTest, FailsQueryWithMultipleQuestions) {
       "\x00\x01";                      // CLASS=IN
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(sizeof(kData) - 1);
-  memcpy(packet->data(), kData, sizeof(kData) - 1);
+  memcpy(packet->data().data(), kData, sizeof(kData) - 1);
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(sizeof(kData) - 1));
@@ -503,7 +504,7 @@ TEST(DnsQueryParseTest, IgnoresExtraQuestion) {
       "\x00\x01";                      // CLASS=IN
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(sizeof(kData) - 1);
-  memcpy(packet->data(), kData, sizeof(kData) - 1);
+  memcpy(packet->data().data(), kData, sizeof(kData) - 1);
   DnsQuery query(packet);
 
   EXPECT_TRUE(query.Parse(sizeof(kData) - 1));
@@ -529,7 +530,7 @@ TEST(DnsQueryParseTest, FailsQueryWithMissingQuestion) {
       "\x00\x00";  // 0 additional records
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(sizeof(kData) - 1);
-  memcpy(packet->data(), kData, sizeof(kData) - 1);
+  memcpy(packet->data().data(), kData, sizeof(kData) - 1);
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(sizeof(kData) - 1));
@@ -554,7 +555,7 @@ TEST(DnsQueryParseTest, FailsQueryWithNamePointer) {
       "\004test\000";              // Byte 29 (name pointer destination): test.
 
   auto packet = base::MakeRefCounted<IOBufferWithSize>(sizeof(kData) - 1);
-  memcpy(packet->data(), kData, sizeof(kData) - 1);
+  memcpy(packet->data().data(), kData, sizeof(kData) - 1);
   DnsQuery query(packet);
 
   EXPECT_FALSE(query.Parse(sizeof(kData) - 1));
diff --git a/net/dns/dns_response_unittest.cc b/net/dns/dns_response_unittest.cc
index 06ea398e09ab6..55b573ba5333f 100644
--- a/net/dns/dns_response_unittest.cc
+++ b/net/dns/dns_response_unittest.cc
@@ -558,7 +558,7 @@ TEST(DnsResponseTest, InitParse) {
   };
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), response_data, sizeof(response_data));
+  memcpy(resp.io_buffer()->data().data(), response_data, sizeof(response_data));
 
   EXPECT_FALSE(resp.id());
 
@@ -652,7 +652,7 @@ TEST(DnsResponseTest, InitParseInvalidFlags) {
   };
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), response_data, sizeof(response_data));
+  memcpy(resp.io_buffer()->data().data(), response_data, sizeof(response_data));
 
   EXPECT_FALSE(resp.InitParse(sizeof(response_data), *query));
   EXPECT_FALSE(resp.IsValid());
@@ -675,7 +675,7 @@ TEST(DnsResponseTest, InitParseRejectsResponseWithoutQuestions) {
       "\xa0\xa0\xa0\xa0";              // 10.10.10.10
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   // Validate that the response is fine if not matching against a query.
   ASSERT_TRUE(resp.InitParseWithoutQuery(sizeof(kResponse) - 1));
@@ -702,7 +702,7 @@ TEST(DnsResponseTest, InitParseRejectsResponseWithTooManyQuestions) {
       "\x00\x01";                        // CLASS=IN
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   // Validate that the response is fine if not matching against a query.
   ASSERT_TRUE(resp.InitParseWithoutQuery(sizeof(kResponse) - 1));
@@ -715,7 +715,7 @@ TEST(DnsResponseTest, InitParseRejectsResponseWithTooManyQuestions) {
 
 TEST(DnsResponseTest, InitParseWithoutQuery) {
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), kT0ResponseDatagram,
+  memcpy(resp.io_buffer()->data().data(), kT0ResponseDatagram,
          sizeof(kT0ResponseDatagram));
 
   // Accept matching question.
@@ -763,7 +763,7 @@ TEST(DnsResponseTest, InitParseWithoutQueryNoQuestions) {
   };
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), response_data, sizeof(response_data));
+  memcpy(resp.io_buffer()->data().data(), response_data, sizeof(response_data));
 
   EXPECT_TRUE(resp.InitParseWithoutQuery(sizeof(response_data)));
 
@@ -812,7 +812,7 @@ TEST(DnsResponseTest, InitParseWithoutQueryInvalidFlags) {
   };
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), response_data, sizeof(response_data));
+  memcpy(resp.io_buffer()->data().data(), response_data, sizeof(response_data));
 
   EXPECT_FALSE(resp.InitParseWithoutQuery(sizeof(response_data)));
   EXPECT_THAT(resp.id(), testing::Optional(0xcafe));
@@ -905,7 +905,7 @@ TEST(DnsResponseTest, InitParseWithoutQueryTwoQuestions) {
   };
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), response_data, sizeof(response_data));
+  memcpy(resp.io_buffer()->data().data(), response_data, sizeof(response_data));
 
   EXPECT_TRUE(resp.InitParseWithoutQuery(sizeof(response_data)));
 
@@ -943,7 +943,7 @@ TEST(DnsResponseTest, InitParseWithoutQueryPacketTooShort) {
   };
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), response_data, sizeof(response_data));
+  memcpy(resp.io_buffer()->data().data(), response_data, sizeof(response_data));
 
   EXPECT_FALSE(resp.InitParseWithoutQuery(sizeof(response_data)));
 }
@@ -970,7 +970,8 @@ TEST(DnsResponseTest, InitParseAllowsQuestionWithLongName) {
       4);
 
   DnsResponse resp1;
-  memcpy(resp1.io_buffer()->data(), response_data.data(), response_data.size());
+  memcpy(resp1.io_buffer()->data().data(), response_data.data(),
+         response_data.size());
 
   EXPECT_TRUE(resp1.InitParseWithoutQuery(response_data.size()));
 
@@ -1005,7 +1006,8 @@ TEST(DnsResponseTest, InitParseRejectsQuestionWithTooLongName) {
       4);
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), response_data.data(), response_data.size());
+  memcpy(resp.io_buffer()->data().data(), response_data.data(),
+         response_data.size());
 
   EXPECT_FALSE(resp.InitParseWithoutQuery(response_data.size()));
 
@@ -1036,7 +1038,7 @@ TEST(DnsResponseTest, InitParseRejectsQuestionWithNonendedName) {
       "\003www\006google\006test";  // Name extending past the end.
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   EXPECT_FALSE(resp.InitParseWithoutQuery(sizeof(kResponse) - 1));
 
@@ -1068,7 +1070,7 @@ TEST(DnsResponseTest, InitParseRejectsResponseWithMissingQuestions) {
   // Missing third question.
 
   DnsResponse resp;
-  memcpy(resp.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   EXPECT_FALSE(resp.InitParseWithoutQuery(sizeof(kResponse) - 1));
 
@@ -1133,7 +1135,7 @@ TEST(DnsResponseTest, ParserLimitedToNumClaimedRecords) {
       "\xc0\xa8\x00\x06";  // 192.168.0.6
 
   DnsResponse resp1;
-  memcpy(resp1.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp1.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   ASSERT_TRUE(resp1.InitParseWithoutQuery(sizeof(kResponse) - 1));
   DnsRecordParser parser1 = resp1.Parser();
@@ -1151,7 +1153,7 @@ TEST(DnsResponseTest, ParserLimitedToNumClaimedRecords) {
 
   // Repeat using InitParse()
   DnsResponse resp2;
-  memcpy(resp2.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp2.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   const char kQueryName[] = "\003www\006google\004test";
   DnsQuery query(
@@ -1202,7 +1204,7 @@ TEST(DnsResponseTest, ParserLimitedToBufferSize) {
       "\xc0\xa8\x00\x02";  // 192.168.0.2
 
   DnsResponse resp1;
-  memcpy(resp1.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp1.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   ASSERT_TRUE(resp1.InitParseWithoutQuery(sizeof(kResponse) - 1));
   DnsRecordParser parser1 = resp1.Parser();
@@ -1217,7 +1219,7 @@ TEST(DnsResponseTest, ParserLimitedToBufferSize) {
 
   // Repeat using InitParse()
   DnsResponse resp2;
-  memcpy(resp2.io_buffer()->data(), kResponse, sizeof(kResponse) - 1);
+  memcpy(resp2.io_buffer()->data().data(), kResponse, sizeof(kResponse) - 1);
 
   ASSERT_TRUE(resp2.InitParseWithoutQuery(sizeof(kResponse) - 1));
   DnsRecordParser parser2 = resp2.Parser();
@@ -1261,7 +1263,7 @@ TEST(DnsResponseWriteTest, SingleARecordAnswer) {
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1297,7 +1299,7 @@ TEST(DnsResponseWriteTest, SingleARecordAnswerWithFinalDotInName) {
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1351,7 +1353,7 @@ TEST(DnsResponseWriteTest, SingleARecordAnswerWithQuestion) {
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1417,7 +1419,7 @@ TEST(DnsResponseWriteTest,
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1455,7 +1457,7 @@ TEST(DnsResponseWriteTest, SingleQuadARecordAnswer) {
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1520,7 +1522,7 @@ TEST(DnsResponseWriteTest,
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1573,7 +1575,7 @@ TEST(DnsResponseWriteTest, TwoAnswersWithAAndQuadARecords) {
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1609,7 +1611,7 @@ TEST(DnsResponseWriteTest, AnswerWithAuthorityRecord) {
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
 }
@@ -1631,7 +1633,7 @@ TEST(DnsResponseWriteTest, AnswerWithRcode) {
   EXPECT_TRUE(response.IsValid());
   std::string expected_response(reinterpret_cast<const char*>(response_data),
                                 sizeof(response_data));
-  std::string actual_response(response.io_buffer()->data(),
+  std::string actual_response(response.io_buffer()->data().data(),
                               response.io_buffer_size());
   EXPECT_EQ(expected_response, actual_response);
   EXPECT_EQ(dns_protocol::kRcodeNXDOMAIN, response.rcode());
diff --git a/net/dns/dns_test_util.cc b/net/dns/dns_test_util.cc
index 5c6389b86f33e..1506028c19fe9 100644
--- a/net/dns/dns_test_util.cc
+++ b/net/dns/dns_test_util.cc
@@ -72,9 +72,9 @@ DnsResponse CreateMalformedResponse(std::string hostname, uint16_t type) {
   // responses received from the network.
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(
       sizeof(kMalformedResponseHeader) + query.question().size());
-  memcpy(buffer->data(), kMalformedResponseHeader,
+  memcpy(buffer->data().data(), kMalformedResponseHeader,
          sizeof(kMalformedResponseHeader));
-  memcpy(buffer->data() + sizeof(kMalformedResponseHeader),
+  memcpy(buffer->data().subspan(sizeof).data()(kMalformedResponseHeader),
          query.question().data(), query.question().size());
 
   DnsResponse response(buffer, buffer->size());
@@ -572,7 +572,7 @@ class MockDnsTransactionFactory::MockTransaction final : public DnsTransaction {
       // completes.
       auto buffer_copy = base::MakeRefCounted<IOBufferWithSize>(
           result->response->io_buffer_size());
-      memcpy(buffer_copy->data(), result->response->io_buffer()->data(),
+      memcpy(buffer_copy->data().data(), result->response->io_buffer()->data(),
              result->response->io_buffer_size());
       result_.response = DnsResponse(std::move(buffer_copy),
                                      result->response->io_buffer_size());
diff --git a/net/dns/dns_transaction.cc b/net/dns/dns_transaction.cc
index 6597830c641c9..d65ca36bc3b93 100644
--- a/net/dns/dns_transaction.cc
+++ b/net/dns/dns_transaction.cc
@@ -413,7 +413,7 @@ class DnsHTTPAttempt : public DnsAttempt, public URLRequest::Delegate {
       std::string url_string;
       std::unordered_map<string, string> parameters;
       std::string encoded_query;
-      base::Base64UrlEncode(std::string_view(query_->io_buffer()->data(),
+      base::Base64UrlEncode(std::string_view(query_->io_buffer()->data().data(),
                                              query_->io_buffer()->size()),
                             base::Base64UrlEncodePolicy::OMIT_PADDING,
                             &encoded_query);
@@ -555,7 +555,7 @@ class DnsHTTPAttempt : public DnsAttempt, public URLRequest::Delegate {
       buffer_->SetCapacity(kDnsOverHttpResponseMaximumSize + 1);
     }
 
-    DCHECK(buffer_->data());
+    DCHECK(!buffer_->data().empty());
     DCHECK_GT(buffer_->capacity(), 0);
 
     int bytes_read =
@@ -598,7 +598,7 @@ class DnsHTTPAttempt : public DnsAttempt, public URLRequest::Delegate {
         buffer_->SetCapacity(buffer_->capacity() + 16384);  // Grow by 16kb.
       }
 
-      DCHECK(buffer_->data());
+      DCHECK(!buffer_->data().empty());
       DCHECK_GT(buffer_->capacity(), 0);
 
       int read_result =
diff --git a/net/dns/dns_transaction_unittest.cc b/net/dns/dns_transaction_unittest.cc
index 1dff691bacdd7..683691aaea96c 100644
--- a/net/dns/dns_transaction_unittest.cc
+++ b/net/dns/dns_transaction_unittest.cc
@@ -142,7 +142,7 @@ class DnsSocketData {
                            sizeof(uint16_t), num_reads_and_writes());
       lengths_.push_back(std::move(length));
     }
-    writes_.emplace_back(mode, query_->io_buffer()->data(),
+    writes_.emplace_back(mode, query_->io_buffer()->data().data(),
                          query_->io_buffer()->size(), num_reads_and_writes());
   }
 
@@ -166,7 +166,7 @@ class DnsSocketData {
                           sizeof(uint16_t), num_reads_and_writes());
       lengths_.push_back(std::move(length));
     }
-    reads_.emplace_back(mode, response->io_buffer()->data(),
+    reads_.emplace_back(mode, response->io_buffer()->data().data(),
                         response->io_buffer_size(), num_reads_and_writes());
     responses_.push_back(std::move(response));
   }
@@ -586,12 +586,12 @@ class URLRequestMockDohJob : public URLRequestJob, public AsyncSocket {
                    IOBuffer* buf,
                    int buf_size) {
     if (data_len > buf_size) {
-      std::copy(data, data + buf_size, buf->data());
+      std::copy(data, data + buf_size, buf->data().data());
       leftover_data_ = data + buf_size;
       leftover_data_len_ = data_len - buf_size;
       return buf_size;
     }
-    std::copy(data, data + data_len, buf->data());
+    std::copy(data, data + data_len, buf->data().data());
     return data_len;
   }
 
diff --git a/net/dns/mdns_client_unittest.cc b/net/dns/mdns_client_unittest.cc
index d9b3c78709395..77438c15da8f0 100644
--- a/net/dns/mdns_client_unittest.cc
+++ b/net/dns/mdns_client_unittest.cc
@@ -1348,7 +1348,8 @@ class SimpleMockSocketFactory : public MDnsSocketFactory {
 class MockMDnsConnectionDelegate : public MDnsConnection::Delegate {
  public:
   void HandlePacket(DnsResponse* response, int size) override {
-    HandlePacketInternal(std::string(response->io_buffer()->data(), size));
+    HandlePacketInternal(
+        std::string(response->io_buffer()->data().data(), size));
   }
 
   MOCK_METHOD1(HandlePacketInternal, void(std::string packet));
diff --git a/net/dns/mock_mdns_socket_factory.cc b/net/dns/mock_mdns_socket_factory.cc
index 90cd128c0a563..4129df89b9d83 100644
--- a/net/dns/mock_mdns_socket_factory.cc
+++ b/net/dns/mock_mdns_socket_factory.cc
@@ -35,8 +35,8 @@ int MockMDnsDatagramServerSocket::SendTo(IOBuffer* buf,
                                          int buf_len,
                                          const IPEndPoint& address,
                                          CompletionOnceCallback callback) {
-  return SendToInternal(std::string(buf->data(), buf_len), address.ToString(),
-                        std::move(callback));
+  return SendToInternal(std::string(buf->data().data(), buf_len),
+                        address.ToString(), std::move(callback));
 }
 
 int MockMDnsDatagramServerSocket::GetLocalAddress(IPEndPoint* address) const {
@@ -56,7 +56,7 @@ int MockMDnsDatagramServerSocket::HandleRecvNow(
     CompletionOnceCallback callback) {
   int size_returned =
       std::min(response_packet_.size(), static_cast<size_t>(size));
-  memcpy(buffer->data(), response_packet_.data(), size_returned);
+  memcpy(buffer->data().data(), response_packet_.data(), size_returned);
   return size_returned;
 }
 
@@ -104,7 +104,7 @@ void MockMDnsSocketFactory::SimulateReceive(const uint8_t* packet, int size) {
   DCHECK(recv_buffer_.get());
   DCHECK(!recv_callback_.is_null());
 
-  memcpy(recv_buffer_->data(), packet, size);
+  memcpy(recv_buffer_->data().data(), packet, size);
   std::move(recv_callback_).Run(size);
 }
 
diff --git a/net/filter/brotli_source_stream.cc b/net/filter/brotli_source_stream.cc
index 1b569fc85dae7..ee80c97a03881 100644
--- a/net/filter/brotli_source_stream.cc
+++ b/net/filter/brotli_source_stream.cc
@@ -42,7 +42,7 @@ class BrotliSourceStream : public FilterSourceStream {
     if (dictionary_) {
       BROTLI_BOOL result = BrotliDecoderAttachDictionary(
           brotli_state_, BROTLI_SHARED_DICTIONARY_RAW, dictionary_size_,
-          reinterpret_cast<const unsigned char*>(dictionary_->data()));
+          reinterpret_cast<const unsigned char*>(dictionary_->data().data()));
       CHECK(result);
     }
   }
diff --git a/net/filter/brotli_source_stream_unittest.cc b/net/filter/brotli_source_stream_unittest.cc
index ccfb220618e80..30fe527596a45 100644
--- a/net/filter/brotli_source_stream_unittest.cc
+++ b/net/filter/brotli_source_stream_unittest.cc
@@ -227,11 +227,13 @@ TEST_F(BrotliSourceStreamTest, DecodeWithSmallBufferSync) {
     bytes_read = ReadStream(callback.callback());
     EXPECT_LE(OK, bytes_read);
     EXPECT_GE(kSmallBufferSize, static_cast<size_t>(bytes_read));
-    memcpy(buffer->data() + total_bytes_read, out_data(), bytes_read);
+    memcpy(buffer->data().subspan(total_bytes_read).data(), out_data(),
+           bytes_read);
     total_bytes_read += bytes_read;
   } while (bytes_read > 0);
   EXPECT_EQ(source_data_len(), total_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), source_data().c_str(), total_bytes_read));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), source_data().c_str(),
+                      total_bytes_read));
   EXPECT_EQ("BROTLI", brotli_stream()->Description());
 }
 
@@ -258,11 +260,13 @@ TEST_F(BrotliSourceStreamTest, DecodeWithSmallBufferAsync) {
       bytes_read = callback.WaitForResult();
     }
     EXPECT_GE(static_cast<int>(kSmallBufferSize), bytes_read);
-    memcpy(buffer->data() + total_bytes_read, out_data(), bytes_read);
+    memcpy(buffer->data().subspan(total_bytes_read).data(), out_data(),
+           bytes_read);
     total_bytes_read += bytes_read;
   } while (bytes_read > 0);
   EXPECT_EQ(source_data_len(), total_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), source_data().c_str(), total_bytes_read));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), source_data().c_str(),
+                      total_bytes_read));
   EXPECT_EQ("BROTLI", brotli_stream()->Description());
 }
 
@@ -284,12 +288,13 @@ TEST_F(BrotliSourceStreamTest, DecodeWithOneByteBuffer) {
     bytes_read = ReadStream(callback.callback());
     EXPECT_NE(ERR_IO_PENDING, bytes_read);
     EXPECT_GE(1, bytes_read);
-    memcpy(buffer->data() + total_bytes_read, out_data(), bytes_read);
+    memcpy(buffer->data().subspan(total_bytes_read).data(), out_data(),
+           bytes_read);
     total_bytes_read += bytes_read;
   } while (bytes_read > 0);
   EXPECT_EQ(source_data_len(), total_bytes_read);
-  EXPECT_EQ(0,
-            memcmp(buffer->data(), source_data().c_str(), source_data_len()));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), source_data().c_str(),
+                      source_data_len()));
   EXPECT_EQ("BROTLI", brotli_stream()->Description());
 }
 
@@ -395,8 +400,8 @@ TEST_F(BrotliSourceStreamTest, WithDictionary) {
                                        callback.callback());
 
   EXPECT_EQ(static_cast<int>(source_data_len()), bytes_read);
-  EXPECT_EQ(
-      0, memcmp(out_buffer->data(), source_data().c_str(), source_data_len()));
+  EXPECT_EQ(0, memcmp(out_buffer->data().data(), source_data().c_str(),
+                      source_data_len()));
   EXPECT_EQ("BROTLI", brotli_stream->Description());
 }
 
diff --git a/net/filter/filter_source_stream_unittest.cc b/net/filter/filter_source_stream_unittest.cc
index 78c37e442f4ed..e5d3b35a52513 100644
--- a/net/filter/filter_source_stream_unittest.cc
+++ b/net/filter/filter_source_stream_unittest.cc
@@ -56,7 +56,7 @@ class TestFilterSourceStreamBase : public FilterSourceStream {
   size_t WriteBufferToOutput(IOBuffer* output_buffer,
                              size_t output_buffer_size) {
     size_t bytes_to_filter = std::min(buffer_.length(), output_buffer_size);
-    memcpy(output_buffer->data(), buffer_.data(), bytes_to_filter);
+    memcpy(output_buffer->data().data(), buffer_.data(), bytes_to_filter);
     buffer_.erase(0, bytes_to_filter);
     return bytes_to_filter;
   }
@@ -89,7 +89,7 @@ class NeedsAllInputFilterSourceStream : public TestFilterSourceStreamBase {
                                            size_t input_buffer_size,
                                            size_t* consumed_bytes,
                                            bool upstream_eof_reached) override {
-    buffer_.append(input_buffer->data(), input_buffer_size);
+    buffer_.append(input_buffer->data().data(), input_buffer_size);
     EXPECT_GE(expected_input_bytes_, input_buffer_size);
     expected_input_bytes_ -= input_buffer_size;
     *consumed_bytes = input_buffer_size;
@@ -126,7 +126,7 @@ class MultiplySourceStream : public TestFilterSourceStreamBase {
       bool /*upstream_eof_reached*/) override {
     for (size_t i = 0; i < input_buffer_size; i++) {
       for (int j = 0; j < multiplier_; j++)
-        buffer_.append(input_buffer->data() + i, 1);
+        buffer_.append(input_buffer->data().subspan(i).data(), 1);
     }
     *consumed_bytes = input_buffer_size;
     return WriteBufferToOutput(output_buffer, output_buffer_size);
@@ -153,7 +153,7 @@ class PassThroughFilterSourceStream : public TestFilterSourceStreamBase {
       size_t input_buffer_size,
       size_t* consumed_bytes,
       bool /*upstream_eof_reached*/) override {
-    buffer_.append(input_buffer->data(), input_buffer_size);
+    buffer_.append(input_buffer->data().data(), input_buffer_size);
     *consumed_bytes = input_buffer_size;
     return WriteBufferToOutput(output_buffer, output_buffer_size);
   }
@@ -176,10 +176,10 @@ class ThrottleSourceStream : public TestFilterSourceStreamBase {
       size_t input_buffer_size,
       size_t* consumed_bytes,
       bool /*upstream_eof_reached*/) override {
-    buffer_.append(input_buffer->data(), input_buffer_size);
+    buffer_.append(input_buffer->data().data(), input_buffer_size);
     *consumed_bytes = input_buffer_size;
     size_t bytes_to_read = std::min(size_t{1}, buffer_.size());
-    memcpy(output_buffer->data(), buffer_.data(), bytes_to_read);
+    memcpy(output_buffer->data().data(), buffer_.data(), bytes_to_read);
     buffer_.erase(0, bytes_to_read);
     return bytes_to_read;
   }
@@ -301,7 +301,7 @@ TEST_P(FilterSourceStreamTest, FilterDataReturnNoBytesExceptLast) {
     if (rv == OK)
       break;
     ASSERT_GT(rv, OK);
-    actual_output.append(output_buffer->data(), rv);
+    actual_output.append(output_buffer->data().data(), rv);
   }
   EXPECT_EQ(input, actual_output);
 }
@@ -380,7 +380,7 @@ TEST_P(FilterSourceStreamTest, FilterDataReturnData) {
       break;
     ASSERT_GE(static_cast<int>(read_size), rv);
     ASSERT_GT(rv, OK);
-    actual_output.append(output_buffer->data(), rv);
+    actual_output.append(output_buffer->data().data(), rv);
   }
   EXPECT_EQ(input, actual_output);
 }
@@ -413,7 +413,7 @@ TEST_P(FilterSourceStreamTest, FilterDataReturnMoreData) {
       break;
     ASSERT_GE(static_cast<int>(read_size) * multiplier, rv);
     ASSERT_GT(rv, OK);
-    actual_output.append(output_buffer->data(), rv);
+    actual_output.append(output_buffer->data().data(), rv);
   }
   EXPECT_EQ("hheelllloo,,  wwoorrlldd!!", actual_output);
 }
@@ -449,7 +449,7 @@ TEST_P(FilterSourceStreamTest, FilterDataOutputSpace) {
       break;
     ASSERT_GT(rv, OK);
     ASSERT_GE(kSmallBufferSize, static_cast<size_t>(rv));
-    actual_output.append(output_buffer->data(), rv);
+    actual_output.append(output_buffer->data().data(), rv);
   }
   EXPECT_EQ(input, actual_output);
 }
@@ -506,7 +506,7 @@ TEST_P(FilterSourceStreamTest, FilterChaining) {
     if (rv == OK)
       break;
     ASSERT_GT(rv, OK);
-    actual_output.append(output_buffer->data(), rv);
+    actual_output.append(output_buffer->data().data(), rv);
   }
   EXPECT_EQ(input, actual_output);
   // Type string (from left to right) should be the order of data flow.
@@ -539,7 +539,7 @@ TEST_P(FilterSourceStreamTest, OutputSpaceForOneRead) {
       break;
     ASSERT_GT(rv, OK);
     ASSERT_GE(kSmallBufferSize, static_cast<size_t>(rv));
-    actual_output.append(output_buffer->data(), rv);
+    actual_output.append(output_buffer->data().data(), rv);
   }
   EXPECT_EQ(input, actual_output);
 }
@@ -568,7 +568,7 @@ TEST_P(FilterSourceStreamTest, ThrottleSourceStream) {
     ASSERT_GT(rv, OK);
     // ThrottleSourceStream returns 1 byte at a time.
     ASSERT_GE(1u, static_cast<size_t>(rv));
-    actual_output.append(output_buffer->data(), rv);
+    actual_output.append(output_buffer->data().data(), rv);
   }
   EXPECT_EQ(input, actual_output);
 }
diff --git a/net/filter/mock_source_stream.cc b/net/filter/mock_source_stream.cc
index 347f11fe3ec03..848081b6fe82e 100644
--- a/net/filter/mock_source_stream.cc
+++ b/net/filter/mock_source_stream.cc
@@ -49,7 +49,7 @@ int MockSourceStream::Read(IOBuffer* dest_buffer,
   }
 
   results_.pop();
-  std::copy(r.data, r.data + r.len, dest_buffer->data());
+  std::copy(r.data, r.data + r.len, dest_buffer->data().data());
   return r.error == OK ? r.len : r.error;
 }
 
@@ -103,7 +103,7 @@ void MockSourceStream::CompleteNextRead() {
   DCHECK_EQ(ASYNC, r.mode);
   results_.pop();
   DCHECK_GE(dest_buffer_size_, r.len);
-  std::copy(r.data, r.data + r.len, dest_buffer_->data());
+  std::copy(r.data, r.data + r.len, dest_buffer_->data().data());
   dest_buffer_ = nullptr;
   std::move(callback_).Run(r.error == OK ? r.len : r.error);
 }
diff --git a/net/filter/zstd_source_stream.cc b/net/filter/zstd_source_stream.cc
index 672701c0b5bf8..4beaf39288303 100644
--- a/net/filter/zstd_source_stream.cc
+++ b/net/filter/zstd_source_stream.cc
@@ -64,7 +64,8 @@ class ZstdSourceStream : public FilterSourceStream {
     ZSTD_DCtx_setParameter(dctx_.get(), ZSTD_d_windowLogMax, window_log_max);
     if (dictionary_) {
       size_t result = ZSTD_DCtx_loadDictionary_advanced(
-          dctx_.get(), reinterpret_cast<const void*>(dictionary_->data()),
+          dctx_.get(),
+          reinterpret_cast<const void*>(dictionary_->data().data()),
           dictionary_size_, ZSTD_dlm_byRef, ZSTD_dct_rawContent);
       DCHECK(!ZSTD_isError(result));
     }
diff --git a/net/filter/zstd_source_stream_unittest.cc b/net/filter/zstd_source_stream_unittest.cc
index 27c6f44f09905..6d07f44911cfe 100644
--- a/net/filter/zstd_source_stream_unittest.cc
+++ b/net/filter/zstd_source_stream_unittest.cc
@@ -257,7 +257,7 @@ TEST_F(ZstdSourceStreamTest, DecodeTwoConcatenatedFrames) {
     if (bytes_read <= OK) {
       break;
     }
-    actual_output.append(out_buffer->data(), bytes_read);
+    actual_output.append(out_buffer->data().data(), bytes_read);
   }
 
   EXPECT_EQ(source_data.length(), actual_output.size());
@@ -298,8 +298,8 @@ TEST_F(ZstdSourceStreamTest, WithDictionary) {
                                      callback.callback());
 
   EXPECT_EQ(static_cast<int>(source_data_len()), bytes_read);
-  EXPECT_EQ(
-      0, memcmp(out_buffer->data(), source_data().c_str(), source_data_len()));
+  EXPECT_EQ(0, memcmp(out_buffer->data().data(), source_data().c_str(),
+                      source_data_len()));
 }
 
 TEST_F(ZstdSourceStreamTest, WindowSizeTooBig) {
diff --git a/net/http/bidirectional_stream_unittest.cc b/net/http/bidirectional_stream_unittest.cc
index 2d4a0c0dee34d..1893f45f67b31 100644
--- a/net/http/bidirectional_stream_unittest.cc
+++ b/net/http/bidirectional_stream_unittest.cc
@@ -145,7 +145,7 @@ class TestDelegateBase : public BidirectionalStream::Delegate {
 
     ++on_data_read_count_;
     CHECK_GE(bytes_read, OK);
-    data_received_.append(read_buf_->data(), bytes_read);
+    data_received_.append(read_buf_->data().data(), bytes_read);
     if (!do_not_start_read_)
       StartOrContinueReading();
   }
@@ -225,7 +225,7 @@ class TestDelegateBase : public BidirectionalStream::Delegate {
     int rv = stream_->ReadData(read_buf_.get(), read_buf_len_);
     not_expect_callback_ = false;
     if (rv > 0)
-      data_received_.append(read_buf_->data(), rv);
+      data_received_.append(read_buf_->data().data(), rv);
     return rv;
   }
 
diff --git a/net/http/http_cache_unittest.cc b/net/http/http_cache_unittest.cc
index d083cded32dc3..e0260505b779a 100644
--- a/net/http/http_cache_unittest.cc
+++ b/net/http/http_cache_unittest.cc
@@ -3180,7 +3180,7 @@ TEST_F(HttpCacheRangeGetTest, ParallelValidationDifferentRanges) {
     c->result = c->trans->Read(buffer.get(), kBufferSize, cb.callback());
     EXPECT_EQ(kBufferSize, cb.GetResult(c->result));
 
-    std::string data_read(buffer->data(), kBufferSize);
+    std::string data_read(buffer->data().data(), kBufferSize);
     first_read = data_read;
 
     EXPECT_EQ(LOAD_STATE_IDLE, c->trans->GetLoadState());
@@ -3323,7 +3323,7 @@ TEST_F(HttpCacheRangeGetTest, ParallelValidationCacheLockTimeout) {
     c->result = c->trans->Read(buffer.get(), kBufferSize, cb.callback());
     EXPECT_EQ(kBufferSize, cb.GetResult(c->result));
 
-    std::string data_read(buffer->data(), kBufferSize);
+    std::string data_read(buffer->data().data(), kBufferSize);
     first_read = data_read;
 
     EXPECT_EQ(LOAD_STATE_IDLE, c->trans->GetLoadState());
@@ -3417,7 +3417,7 @@ TEST_F(HttpCacheRangeGetTest, ParallelValidationCouldntConditionalize) {
     c->result = c->trans->Read(buffer.get(), kBufferSize, cb.callback());
     EXPECT_EQ(kBufferSize, cb.GetResult(c->result));
 
-    std::string data_read(buffer->data(), kBufferSize);
+    std::string data_read(buffer->data().data(), kBufferSize);
     first_read = data_read;
 
     EXPECT_EQ(LOAD_STATE_IDLE, c->trans->GetLoadState());
@@ -3504,7 +3504,7 @@ TEST_F(HttpCacheRangeGetTest, ParallelValidationCouldConditionalize) {
     c->result = c->trans->Read(buffer.get(), kBufferSize, cb.callback());
     EXPECT_EQ(kBufferSize, cb.GetResult(c->result));
 
-    std::string data_read(buffer->data(), kBufferSize);
+    std::string data_read(buffer->data().data(), kBufferSize);
     first_read = data_read;
 
     EXPECT_EQ(LOAD_STATE_IDLE, c->trans->GetLoadState());
@@ -3580,7 +3580,7 @@ TEST_F(HttpCacheRangeGetTest, ParallelValidationOverlappingRanges) {
     c->result = c->trans->Read(buffer.get(), kBufferSize, cb.callback());
     EXPECT_EQ(kBufferSize, cb.GetResult(c->result));
 
-    std::string data_read(buffer->data(), kBufferSize);
+    std::string data_read(buffer->data().data(), kBufferSize);
     first_read = data_read;
 
     EXPECT_EQ(LOAD_STATE_IDLE, c->trans->GetLoadState());
@@ -3684,7 +3684,7 @@ TEST_F(HttpCacheRangeGetTest, ParallelValidationRestartDoneHeaders) {
     c->result = c->trans->Read(buffer.get(), kBufferSize, cb.callback());
     EXPECT_EQ(kBufferSize, cb.GetResult(c->result));
 
-    std::string data_read(buffer->data(), kBufferSize);
+    std::string data_read(buffer->data().data(), kBufferSize);
     first_read = data_read;
 
     EXPECT_EQ(LOAD_STATE_IDLE, c->trans->GetLoadState());
@@ -4515,7 +4515,7 @@ TEST_F(HttpCacheSimpleGetTest, ParallelWritingCancelWriter) {
       context_list[0].reset();
       base::RunLoop().RunUntilIdle();
       EXPECT_EQ(kBufferSize, cb.GetResult(c->result));
-      std::string data_read(buffer->data(), kBufferSize);
+      std::string data_read(buffer->data().data(), kBufferSize);
       first_read = data_read;
     }
   }
@@ -4693,7 +4693,7 @@ TEST_F(HttpCacheSimpleGetTest, ParallelWritingCacheWriteFailed) {
     c->result = c->callback.WaitForResult();
     if (i == 0) {
       EXPECT_EQ(5, c->result);
-      std::string data_read(buffer[i]->data(), kBufferSize);
+      std::string data_read(buffer[i]->data().data(), kBufferSize);
       first_read = data_read;
     } else {
       EXPECT_EQ(ERR_CACHE_WRITE_FAILURE, c->result);
@@ -4848,7 +4848,7 @@ TEST_F(HttpCacheSimpleGetTest, ParallelWritingSuccess) {
     auto& c = context_list[i];
     c->result = c->callback.WaitForResult();
     EXPECT_EQ(5, c->result);
-    std::string data_read(buffer[i]->data(), kBufferSize);
+    std::string data_read(buffer[i]->data().data(), kBufferSize);
     first_read[i] = data_read;
   }
   EXPECT_EQ(first_read[0], first_read[1]);
@@ -4927,7 +4927,7 @@ TEST_F(HttpCacheSimpleGetTest, ParallelWritingHuge) {
   base::RunLoop().RunUntilIdle();
   c->result = c->callback.WaitForResult();
   EXPECT_EQ(kBufferSize, c->result);
-  std::string data_read(buffer[0]->data(), kBufferSize);
+  std::string data_read(buffer[0]->data().data(), kBufferSize);
   first_read[0] = data_read;
   EXPECT_EQ("<html", first_read[0]);
 
diff --git a/net/http/http_cache_writers.cc b/net/http/http_cache_writers.cc
index 0df0ff35972e7..0c47f6cf0dfc1 100644
--- a/net/http/http_cache_writers.cc
+++ b/net/http/http_cache_writers.cc
@@ -585,7 +585,7 @@ void HttpCache::Writers::CompleteWaitingForReadTransactions(int result) {
     if (result >= 0) {  // success
       // Save the data in the waiting transaction's read buffer.
       it->second.write_len = std::min(it->second.read_buf_len, result);
-      memcpy(it->second.read_buf->data(), read_buf_->data(),
+      memcpy(it->second.read_buf->data().data(), read_buf_->data().data(),
              it->second.write_len);
       callback_result = it->second.write_len;
     }
diff --git a/net/http/http_cache_writers_unittest.cc b/net/http/http_cache_writers_unittest.cc
index 9ba736e5e4d6d..6dd18fd1c3e36 100644
--- a/net/http/http_cache_writers_unittest.cc
+++ b/net/http/http_cache_writers_unittest.cc
@@ -196,7 +196,7 @@ class WritersTest : public TestWithTaskEnvironment {
       }
 
       if (rv > 0) {
-        content.append(buf->data(), rv);
+        content.append(buf->data().data(), rv);
       } else if (rv < 0) {
         return rv;
       }
@@ -221,7 +221,7 @@ class WritersTest : public TestWithTaskEnvironment {
     }
 
     if (rv > 0) {
-      result->append(buf->data(), rv);
+      result->append(buf->data().data(), rv);
     } else if (rv < 0) {
       return rv;
     }
@@ -268,7 +268,7 @@ class WritersTest : public TestWithTaskEnvironment {
     for (size_t i = 0; i < callbacks.size(); i++) {
       rv = callbacks[i].WaitForResult();
       EXPECT_EQ(expected_lengths[i], rv);
-      results[i].append(bufs[i]->data(), expected_lengths[i]);
+      results[i].append(bufs[i]->data().data(), expected_lengths[i]);
     }
 
     EXPECT_EQ(results[0].substr(0, expected_lengths[1]), results[1]);
@@ -353,7 +353,7 @@ class WritersTest : public TestWithTaskEnvironment {
               deleteType != DeleteTransactionType::ACTIVE) {
             continue;
           }
-          results.at(i).append(bufs[i]->data(), rv);
+          results.at(i).append(bufs[i]->data().data(), rv);
         }
       }
       first_iter = false;
@@ -427,7 +427,7 @@ class WritersTest : public TestWithTaskEnvironment {
         if (i == 0) {
           active_transaction_rv = callbacks[i].WaitForResult();
           EXPECT_LE(0, active_transaction_rv);
-          results->at(0).append(bufs[i]->data(), active_transaction_rv);
+          results->at(0).append(bufs[i]->data().data(), active_transaction_rv);
         } else if (first_iter) {
           rv = callbacks[i].WaitForResult();
           EXPECT_EQ(ERR_CACHE_WRITE_FAILURE, rv);
diff --git a/net/http/http_network_transaction_unittest.cc b/net/http/http_network_transaction_unittest.cc
index e18dab134ff69..f7ffea8d3b033 100644
--- a/net/http/http_network_transaction_unittest.cc
+++ b/net/http/http_network_transaction_unittest.cc
@@ -12740,7 +12740,7 @@ TEST_P(HttpNetworkTransactionTest, CloseConnectionOnDestruction) {
           auto buf = base::MakeRefCounted<IOBufferWithSize>(5);
           rv = trans->Read(buf.get(), 5, callback.callback());
           ASSERT_EQ(5, callback.GetResult(rv));
-          response_data.assign(buf->data(), 5);
+          response_data.assign(buf->data().data(), 5);
           EXPECT_EQ("hello", response_data);
           break;
         }
diff --git a/net/http/http_response_body_drainer_unittest.cc b/net/http/http_response_body_drainer_unittest.cc
index 97978e0276e35..8189c48b836a7 100644
--- a/net/http/http_response_body_drainer_unittest.cc
+++ b/net/http/http_response_body_drainer_unittest.cc
@@ -223,7 +223,7 @@ int MockHttpStream::ReadResponseBodyImpl(IOBuffer* buf, int buf_len) {
   } else {
     if (buf_len > kMagicChunkSize)
       buf_len = kMagicChunkSize;
-    std::memset(buf->data(), 1, buf_len);
+    std::memset(buf->data().data(), 1, buf_len);
   }
   num_chunks_--;
   if (!num_chunks_)
diff --git a/net/http/http_stream_parser.cc b/net/http/http_stream_parser.cc
index 260f804203a26..10539d043d33f 100644
--- a/net/http/http_stream_parser.cc
+++ b/net/http/http_stream_parser.cc
@@ -267,7 +267,8 @@ int HttpStreamParser::SendRequest(
     request_headers_ = base::MakeRefCounted<DrainableIOBuffer>(
         merged_request_headers_and_body, merged_size);
 
-    memcpy(request_headers_->data(), request.data(), request_headers_length_);
+    memcpy(request_headers_->data().data(), request.data(),
+           request_headers_length_);
     request_headers_->DidConsume(request_headers_length_);
 
     uint64_t todo = upload_data_stream_->size();
@@ -549,7 +550,8 @@ int HttpStreamParser::DoSendRequestReadBodyComplete(int result) {
       sent_last_chunk_ = true;
     }
     // Encode the buffer as 1 chunk.
-    const std::string_view payload(request_body_read_buf_->data(), result);
+    const std::string_view payload(request_body_read_buf_->data().data(),
+                                   result);
     request_body_send_buf_->Clear();
     result = EncodeChunk(payload, request_body_send_buf_->span());
   }
@@ -588,7 +590,7 @@ int HttpStreamParser::DoReadHeaders() {
 
   // http://crbug.com/16371: We're seeing |user_buf_->data()| return NULL.
   // See if the user is passing in an IOBuffer with a NULL |data_|.
-  CHECK(read_buf_->data());
+  CHECK(!read_buf_->data().empty());
 
   return stream_socket_->Read(read_buf_.get(), read_buf_->RemainingCapacity(),
                               io_callback_);
diff --git a/net/http/http_stream_parser_unittest.cc b/net/http/http_stream_parser_unittest.cc
index 09aa67c9ad995..641c4709e890b 100644
--- a/net/http/http_stream_parser_unittest.cc
+++ b/net/http/http_stream_parser_unittest.cc
@@ -1265,7 +1265,7 @@ class SimpleGetRunner {
         EXPECT_EQ(read_lengths[i], rv);
       }
       if (rv > 0)
-        body.append(buffer->data(), rv);
+        body.append(buffer->data().data(), rv);
       i++;
       if (rv <= 0)
         return body;
diff --git a/net/http/http_transaction_test_util.cc b/net/http/http_transaction_test_util.cc
index fe14ec82c833a..8d24e11efb855 100644
--- a/net/http/http_transaction_test_util.cc
+++ b/net/http/http_transaction_test_util.cc
@@ -290,7 +290,7 @@ void TestTransactionConsumer::DidRead(int result) {
   if (result <= 0) {
     DidFinish(result);
   } else {
-    content_.append(read_buf_->data(), result);
+    content_.append(read_buf_->data().data(), result);
     Read();
   }
 }
@@ -414,7 +414,7 @@ int MockNetworkTransaction::Read(IOBuffer* buf,
       if (test_mode_ & TEST_MODE_SLOW_READ)
         num = std::min(num, 1);
       if (num) {
-        memcpy(buf->data(), data_.data() + data_cursor_, num);
+        memcpy(buf->data().data(), data_.data() + data_cursor_, num);
         data_cursor_ += num;
       }
     }
@@ -856,7 +856,7 @@ int ReadTransaction(HttpTransaction* trans, std::string* result) {
     }
 
     if (rv > 0)
-      content.append(buf->data(), rv);
+      content.append(buf->data().data(), rv);
     else if (rv < 0)
       return rv;
   } while (rv > 0);
diff --git a/net/http/http_transaction_test_util_unittest.cc b/net/http/http_transaction_test_util_unittest.cc
index 6f32dbd97f262..2f9c1e2f2430f 100644
--- a/net/http/http_transaction_test_util_unittest.cc
+++ b/net/http/http_transaction_test_util_unittest.cc
@@ -102,7 +102,7 @@ TEST_F(MockNetworkTransactionTest, Basic) {
   int read_result = read_callback.WaitForResult();
   ASSERT_THAT(read_result, std::string_view(mock_transaction.data).size());
   EXPECT_EQ(std::string_view(mock_transaction.data),
-            std::string_view(buf->data(), read_result));
+            std::string_view(buf->data().data(), read_result));
 }
 
 TEST_F(MockNetworkTransactionTest, SyncNetStart) {
@@ -125,7 +125,7 @@ TEST_F(MockNetworkTransactionTest, SyncNetStart) {
   int read_result = read_callback.WaitForResult();
   ASSERT_THAT(read_result, std::string_view(mock_transaction.data).size());
   EXPECT_EQ(std::string_view(mock_transaction.data),
-            std::string_view(buf->data(), read_result));
+            std::string_view(buf->data().data(), read_result));
 }
 
 TEST_F(MockNetworkTransactionTest, AsyncNetStartFailure) {
@@ -334,7 +334,8 @@ TEST_F(MockNetworkTransactionTest, ModifyRequestHeadersCallback) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   ASSERT_THAT(read_result, kTestResponseData.size());
-  EXPECT_EQ(kTestResponseData, std::string_view(buf->data(), read_result));
+  EXPECT_EQ(kTestResponseData,
+            std::string_view(buf->data().data(), read_result));
 }
 
 TEST_F(MockNetworkTransactionTest, CallbackOrder) {
diff --git a/net/http/mock_http_cache.cc b/net/http/mock_http_cache.cc
index 7a4c0bd5fb562..5a8eea0247e8f 100644
--- a/net/http/mock_http_cache.cc
+++ b/net/http/mock_http_cache.cc
@@ -110,7 +110,7 @@ int MockDiskEntry::ReadData(int index,
   }
 
   int num = std::min(buf_len, static_cast<int>(data_[index].size()) - offset);
-  memcpy(buf->data(), &data_[index][offset], num);
+  memcpy(buf->data().data(), &data_[index][offset], num);
 
   if (MockHttpCache::GetTestMode(test_mode_) & TEST_MODE_SYNC_CACHE_READ) {
     return num;
@@ -160,7 +160,7 @@ int MockDiskEntry::WriteData(int index,
 
   data_[index].resize(offset + buf_len);
   if (buf_len) {
-    memcpy(&data_[index][offset], buf->data(), buf_len);
+    memcpy(&data_[index][offset], buf->data().data(), buf_len);
   }
 
   if (MockHttpCache::GetTestMode(test_mode_) & TEST_MODE_SYNC_CACHE_WRITE) {
@@ -204,7 +204,7 @@ int MockDiskEntry::ReadSparseData(int64_t offset,
   }
 
   int num = std::min(static_cast<int>(data_[1].size()) - real_offset, buf_len);
-  memcpy(buf->data(), &data_[1][real_offset], num);
+  memcpy(buf->data().data(), &data_[1][real_offset], num);
 
   if (MockHttpCache::GetTestMode(test_mode_) & TEST_MODE_SYNC_CACHE_READ) {
     return num;
@@ -252,7 +252,7 @@ int MockDiskEntry::WriteSparseData(int64_t offset,
     data_[1].resize(real_offset + buf_len);
   }
 
-  memcpy(&data_[1][real_offset], buf->data(), buf_len);
+  memcpy(&data_[1][real_offset], buf->data().data(), buf_len);
   if (MockHttpCache::GetTestMode(test_mode_) & TEST_MODE_SYNC_CACHE_WRITE) {
     return buf_len;
   }
diff --git a/net/http/test_upload_data_stream_not_allow_http1.cc b/net/http/test_upload_data_stream_not_allow_http1.cc
index b45daa06ebfd5..8e01a094a2a7a 100644
--- a/net/http/test_upload_data_stream_not_allow_http1.cc
+++ b/net/http/test_upload_data_stream_not_allow_http1.cc
@@ -25,7 +25,7 @@ int UploadDataStreamNotAllowHTTP1::InitInternal(const NetLogWithSource&) {
 int UploadDataStreamNotAllowHTTP1::ReadInternal(IOBuffer* buf, int buf_len) {
   const size_t bytes_to_read =
       std::min(content_.length(), static_cast<size_t>(buf_len));
-  memcpy(buf->data(), content_.c_str(), bytes_to_read);
+  memcpy(buf->data().data(), content_.c_str(), bytes_to_read);
   content_ = content_.substr(bytes_to_read);
   if (!content_.length())
     SetIsFinalChunk();
diff --git a/net/proxy_resolution/pac_file_fetcher_impl.cc b/net/proxy_resolution/pac_file_fetcher_impl.cc
index 09dbb7e675656..a29440d925d28 100644
--- a/net/proxy_resolution/pac_file_fetcher_impl.cc
+++ b/net/proxy_resolution/pac_file_fetcher_impl.cc
@@ -367,7 +367,7 @@ bool PacFileFetcherImpl::ConsumeBytesRead(URLRequest* request, int num_bytes) {
     return false;
   }
 
-  bytes_read_so_far_.append(buf_->data(), num_bytes);
+  bytes_read_so_far_.append(buf_->data().data(), num_bytes);
   return true;
 }
 
diff --git a/net/quic/bidirectional_stream_quic_impl_unittest.cc b/net/quic/bidirectional_stream_quic_impl_unittest.cc
index 0794bbe9cf252..b13da9494d9a1 100644
--- a/net/quic/bidirectional_stream_quic_impl_unittest.cc
+++ b/net/quic/bidirectional_stream_quic_impl_unittest.cc
@@ -151,7 +151,7 @@ class TestDelegateBase : public BidirectionalStreamImpl::Delegate {
     }
     ++on_data_read_count_;
     CHECK_GE(bytes_read, OK);
-    data_received_.append(read_buf_->data(), bytes_read);
+    data_received_.append(read_buf_->data().data(), bytes_read);
     std::move(callback_).Run(bytes_read);
   }
 
@@ -243,7 +243,7 @@ class TestDelegateBase : public BidirectionalStreamImpl::Delegate {
     int rv = stream_->ReadData(read_buf_.get(), read_buf_len_);
     not_expect_callback_ = false;
     if (rv > 0) {
-      data_received_.append(read_buf_->data(), rv);
+      data_received_.append(read_buf_->data().data(), rv);
     }
     if (rv == ERR_IO_PENDING) {
       callback_ = std::move(callback);
diff --git a/net/quic/quic_chromium_client_stream.cc b/net/quic/quic_chromium_client_stream.cc
index 5ef12ee56c167..22c738bbf81fe 100644
--- a/net/quic/quic_chromium_client_stream.cc
+++ b/net/quic/quic_chromium_client_stream.cc
@@ -735,7 +735,7 @@ bool QuicChromiumClientStream::WritevStreamData(
   // Writes the data, or buffers it.
   for (size_t i = 0; i < buffers.size(); ++i) {
     bool is_fin = fin && (i == buffers.size() - 1);
-    std::string_view string_data(buffers[i]->data(), lengths[i]);
+    std::string_view string_data(buffers[i]->data().data(), lengths[i]);
     WriteOrBufferBody(string_data, is_fin);
   }
   return !HasBufferedData();  // Was all data written?
@@ -773,7 +773,7 @@ bool QuicChromiumClientStream::SupportsH3Datagram() const {
 
 int QuicChromiumClientStream::Read(IOBuffer* buf, int buf_len) {
   DCHECK_GT(buf_len, 0);
-  DCHECK(buf->data());
+  DCHECK(!buf->data().empty());
 
   if (IsDoneReading())
     return 0;  // EOF
diff --git a/net/quic/quic_chromium_client_stream_test.cc b/net/quic/quic_chromium_client_stream_test.cc
index 8d1dd0e9e86d5..307874a471058 100644
--- a/net/quic/quic_chromium_client_stream_test.cc
+++ b/net/quic/quic_chromium_client_stream_test.cc
@@ -249,7 +249,7 @@ class QuicChromiumClientStreamTest
     EXPECT_EQ(static_cast<int>(expected_data.length()),
               stream_->Read(buffer.get(), expected_data.length() + 1));
     EXPECT_EQ(expected_data,
-              std::string_view(buffer->data(), expected_data.length()));
+              std::string_view(buffer->data().data(), expected_data.length()));
   }
 
   quic::QuicHeaderList ProcessHeaders(const quiche::HttpHeaderBlock& headers) {
@@ -453,7 +453,8 @@ TEST_P(QuicChromiumClientStreamTest, OnDataAvailable) {
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(2 * data_len);
   EXPECT_EQ(data_len,
             handle_->ReadBody(buffer.get(), 2 * data_len, callback.callback()));
-  EXPECT_EQ(std::string_view(data), std::string_view(buffer->data(), data_len));
+  EXPECT_EQ(std::string_view(data),
+            std::string_view(buffer->data().data(), data_len));
 }
 
 TEST_P(QuicChromiumClientStreamTest, OnDataAvailableAfterReadBody) {
@@ -485,7 +486,8 @@ TEST_P(QuicChromiumClientStreamTest, OnDataAvailableAfterReadBody) {
       /*offset=*/offset, data));
 
   EXPECT_EQ(data_len, callback.WaitForResult());
-  EXPECT_EQ(std::string_view(data), std::string_view(buffer->data(), data_len));
+  EXPECT_EQ(std::string_view(data),
+            std::string_view(buffer->data().data(), data_len));
   base::RunLoop().RunUntilIdle();
 }
 
@@ -580,7 +582,8 @@ TEST_P(QuicChromiumClientStreamTest, OnTrailers) {
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(2 * data_len);
   EXPECT_EQ(data_len,
             handle_->ReadBody(buffer.get(), 2 * data_len, callback.callback()));
-  EXPECT_EQ(std::string_view(data), std::string_view(buffer->data(), data_len));
+  EXPECT_EQ(std::string_view(data),
+            std::string_view(buffer->data().data(), data_len));
 
   quiche::HttpHeaderBlock trailers;
   trailers["bar"] = "foo";
@@ -627,7 +630,8 @@ TEST_P(QuicChromiumClientStreamTest, MarkTrailersConsumedWhenNotifyDelegate) {
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(2 * data_len);
   EXPECT_EQ(data_len,
             handle_->ReadBody(buffer.get(), 2 * data_len, callback.callback()));
-  EXPECT_EQ(std::string_view(data), std::string_view(buffer->data(), data_len));
+  EXPECT_EQ(std::string_view(data),
+            std::string_view(buffer->data().data(), data_len));
 
   // Read again, and it will be pending.
   EXPECT_THAT(
@@ -681,7 +685,8 @@ TEST_P(QuicChromiumClientStreamTest, ReadAfterTrailersReceivedButNotDelivered) {
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(2 * data_len);
   EXPECT_EQ(data_len,
             handle_->ReadBody(buffer.get(), 2 * data_len, callback.callback()));
-  EXPECT_EQ(std::string_view(data), std::string_view(buffer->data(), data_len));
+  EXPECT_EQ(std::string_view(data),
+            std::string_view(buffer->data().data(), data_len));
 
   // Deliver trailers. Delegate notification is posted asynchronously.
   quiche::HttpHeaderBlock trailers;
@@ -919,7 +924,8 @@ TEST_P(QuicChromiumClientStreamTest, HeadersAndDataBeforeHandle) {
   int data_len = std::size(data) - 1;
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(data_len + 1);
   ASSERT_EQ(data_len, stream2->Read(buffer.get(), data_len + 1));
-  EXPECT_EQ(std::string_view(data), std::string_view(buffer->data(), data_len));
+  EXPECT_EQ(std::string_view(data),
+            std::string_view(buffer->data().data(), data_len));
 }
 
 // Regression test for https://crbug.com/1043531.
diff --git a/net/quic/quic_chromium_packet_reader.cc b/net/quic/quic_chromium_packet_reader.cc
index dcdb77723ea2b..38b04bd8c50fc 100644
--- a/net/quic/quic_chromium_packet_reader.cc
+++ b/net/quic/quic_chromium_packet_reader.cc
@@ -114,7 +114,8 @@ bool QuicChromiumPacketReader::ProcessReadResult(int result) {
     DscpAndEcn tos = socket_->GetLastTos();
     ecn = static_cast<quic::QuicEcnCodepoint>(tos.ecn);
   }
-  quic::QuicReceivedPacket packet(read_buffer_->data(), result, clock_->Now(),
+  quic::QuicReceivedPacket packet(read_buffer_->data().data(), result,
+                                  clock_->Now(),
                                   /*owns_buffer=*/false, /*ttl=*/0,
                                   /*ttl_valid=*/true,
                                   /*packet_headers=*/nullptr,
diff --git a/net/quic/quic_chromium_packet_writer.cc b/net/quic/quic_chromium_packet_writer.cc
index 20b41a3dee4d3..c4c4b3470a73b 100644
--- a/net/quic/quic_chromium_packet_writer.cc
+++ b/net/quic/quic_chromium_packet_writer.cc
@@ -100,7 +100,7 @@ void QuicChromiumPacketWriter::ReusableIOBuffer::Set(const char* buffer,
   CHECK_LE(buf_len, capacity_);
   CHECK(HasOneRef());
   size_ = buf_len;
-  std::memcpy(data(), buffer, buf_len);
+  std::memcpy(data().data(), buffer, buf_len);
 }
 
 QuicChromiumPacketWriter::QuicChromiumPacketWriter(
diff --git a/net/quic/quic_http_stream.cc b/net/quic/quic_http_stream.cc
index 4561495269404..6093520dc6046 100644
--- a/net/quic/quic_http_stream.cc
+++ b/net/quic/quic_http_stream.cc
@@ -581,7 +581,7 @@ int QuicHttpStream::DoSendBody() {
   int len = request_body_buf_->BytesRemaining();
   if (len > 0 || eof) {
     next_state_ = STATE_SEND_BODY_COMPLETE;
-    std::string_view data(request_body_buf_->data(), len);
+    std::string_view data(request_body_buf_->data().data(), len);
     return stream_->WriteStreamData(
         data, eof,
         base::BindOnce(&QuicHttpStream::OnIOComplete,
diff --git a/net/quic/quic_proxy_client_socket.cc b/net/quic/quic_proxy_client_socket.cc
index e06e7787d081b..e7c2050675be2 100644
--- a/net/quic/quic_proxy_client_socket.cc
+++ b/net/quic/quic_proxy_client_socket.cc
@@ -221,7 +221,7 @@ int QuicProxyClientSocket::Write(
                                 buf->data());
 
   int rv = stream_->WriteStreamData(
-      std::string_view(buf->data(), buf_len), false,
+      std::string_view(buf->data().data(), buf_len), false,
       base::BindOnce(&QuicProxyClientSocket::OnWriteComplete,
                      weak_factory_.GetWeakPtr()));
   if (rv == OK)
diff --git a/net/quic/quic_proxy_client_socket_unittest.cc b/net/quic/quic_proxy_client_socket_unittest.cc
index 8efe47649886b..8f5893b103a8e 100644
--- a/net/quic/quic_proxy_client_socket_unittest.cc
+++ b/net/quic/quic_proxy_client_socket_unittest.cc
@@ -112,7 +112,7 @@ class QuicProxyClientSocketTest : public QuicProxyClientSocketTestBase {
 
   void AssertWriteReturns(const char* data, int len, int rv) override {
     auto buf = base::MakeRefCounted<IOBufferWithSize>(len);
-    memcpy(buf->data(), data, len);
+    memcpy(buf->data().data(), data, len);
     EXPECT_EQ(rv,
               sock_->Write(buf.get(), buf->size(), write_callback_.callback(),
                            TRAFFIC_ANNOTATION_FOR_TESTS));
@@ -120,7 +120,7 @@ class QuicProxyClientSocketTest : public QuicProxyClientSocketTestBase {
 
   void AssertSyncWriteSucceeds(const char* data, int len) override {
     auto buf = base::MakeRefCounted<IOBufferWithSize>(len);
-    memcpy(buf->data(), data, len);
+    memcpy(buf->data().data(), data, len);
     EXPECT_EQ(len,
               sock_->Write(buf.get(), buf->size(), CompletionOnceCallback(),
                            TRAFFIC_ANNOTATION_FOR_TESTS));
@@ -129,7 +129,7 @@ class QuicProxyClientSocketTest : public QuicProxyClientSocketTestBase {
   void AssertSyncReadEquals(const char* data, int len) override {
     auto buf = base::MakeRefCounted<IOBufferWithSize>(len);
     EXPECT_EQ(len, sock_->Read(buf.get(), len, CompletionOnceCallback()));
-    EXPECT_EQ(std::string(data, len), std::string(buf->data(), len));
+    EXPECT_EQ(std::string(data, len), std::string(buf->data().data(), len));
     ASSERT_TRUE(sock_->IsConnected());
   }
 
@@ -143,7 +143,7 @@ class QuicProxyClientSocketTest : public QuicProxyClientSocketTestBase {
 
     EXPECT_EQ(len, read_callback_.WaitForResult());
     EXPECT_TRUE(sock_->IsConnected());
-    EXPECT_EQ(std::string(data, len), std::string(buf->data(), len));
+    EXPECT_EQ(std::string(data, len), std::string(buf->data().data(), len));
   }
 
   void AssertReadStarts(const char* data, int len) override {
@@ -159,7 +159,8 @@ class QuicProxyClientSocketTest : public QuicProxyClientSocketTestBase {
 
     // Now the read will return.
     EXPECT_EQ(len, read_callback_.WaitForResult());
-    EXPECT_EQ(std::string(data, len), std::string(read_buf_->data(), len));
+    EXPECT_EQ(std::string(data, len),
+              std::string(read_buf_->data().data(), len));
   }
 
  protected:
@@ -870,7 +871,7 @@ TEST_P(QuicProxyClientSocketTest, MultipleReadsFromSameLargeFrame) {
   // Now attempt to do a read of more data than remains buffered
   auto buf = base::MakeRefCounted<IOBufferWithSize>(kLen33);
   ASSERT_EQ(kLen3, sock_->Read(buf.get(), kLen33, CompletionOnceCallback()));
-  ASSERT_EQ(std::string(kMsg3, kLen3), std::string(buf->data(), kLen3));
+  ASSERT_EQ(std::string(kMsg3, kLen3), std::string(buf->data().data(), kLen3));
   ASSERT_TRUE(sock_->IsConnected());
 }
 
diff --git a/net/quic/quic_proxy_datagram_client_socket.cc b/net/quic/quic_proxy_datagram_client_socket.cc
index cf514804f6be9..34e91a5c5f2c1 100644
--- a/net/quic/quic_proxy_datagram_client_socket.cc
+++ b/net/quic/quic_proxy_datagram_client_socket.cc
@@ -175,7 +175,8 @@ void QuicProxyDatagramClientSocket::OnHttp3Datagram(
       CHECK(read_buf_ != nullptr);
       CHECK(read_buf_len_ > 0);
 
-      std::memcpy(read_buf_->data(), http_payload.data(), http_payload.size());
+      std::memcpy(read_buf_->data().data(), http_payload.data(),
+                  http_payload.size());
       result = bytes_read;
     }
 
@@ -283,7 +284,7 @@ int QuicProxyDatagramClientSocket::Read(IOBuffer* buf,
     if (datagram.size() > static_cast<std::size_t>(buf_len)) {
       result = ERR_MSG_TOO_BIG;
     } else {
-      std::memcpy(buf->data(), datagram.data(), datagram.size());
+      std::memcpy(buf->data().data(), datagram.data(), datagram.size());
       result = bytes_read;
     }
     datagrams_.pop();
@@ -311,7 +312,7 @@ int QuicProxyDatagramClientSocket::Write(
   net_log_.AddByteTransferEvent(NetLogEventType::SOCKET_BYTES_SENT, buf_len,
                                 buf->data());
 
-  std::string_view packet(buf->data(), buf_len);
+  std::string_view packet(buf->data().data(), buf_len);
   int rv = stream_handle_->WriteConnectUdpPayload(packet);
   if (rv == OK) {
     return buf_len;
diff --git a/net/quic/quic_proxy_datagram_client_socket_unittest.cc b/net/quic/quic_proxy_datagram_client_socket_unittest.cc
index 3be9eb20273d2..d18b5373e4a97 100644
--- a/net/quic/quic_proxy_datagram_client_socket_unittest.cc
+++ b/net/quic/quic_proxy_datagram_client_socket_unittest.cc
@@ -125,7 +125,7 @@ class QuicProxyDatagramClientSocketTest : public QuicProxyClientSocketTestBase {
 
   void AssertWriteReturns(const char* data, int len, int rv) override {
     auto buf = base::MakeRefCounted<IOBufferWithSize>(len);
-    memcpy(buf->data(), data, len);
+    memcpy(buf->data().data(), data, len);
     EXPECT_EQ(rv,
               sock_->Write(buf.get(), buf->size(), write_callback_.callback(),
                            TRAFFIC_ANNOTATION_FOR_TESTS));
@@ -133,7 +133,7 @@ class QuicProxyDatagramClientSocketTest : public QuicProxyClientSocketTestBase {
 
   void AssertSyncWriteSucceeds(const char* data, int len) override {
     auto buf = base::MakeRefCounted<IOBufferWithSize>(len);
-    memcpy(buf->data(), data, len);
+    memcpy(buf->data().data(), data, len);
     EXPECT_EQ(len,
               sock_->Write(buf.get(), buf->size(), CompletionOnceCallback(),
                            TRAFFIC_ANNOTATION_FOR_TESTS));
@@ -142,7 +142,7 @@ class QuicProxyDatagramClientSocketTest : public QuicProxyClientSocketTestBase {
   void AssertSyncReadEquals(const char* data, int len) override {
     auto buf = base::MakeRefCounted<IOBufferWithSize>(len);
     ASSERT_EQ(len, sock_->Read(buf.get(), len, CompletionOnceCallback()));
-    ASSERT_EQ(std::string(data, len), std::string(buf->data(), len));
+    ASSERT_EQ(std::string(data, len), std::string(buf->data().data(), len));
     ASSERT_TRUE(sock_->IsConnected());
   }
 
@@ -162,7 +162,8 @@ class QuicProxyDatagramClientSocketTest : public QuicProxyClientSocketTestBase {
 
     // Now the read will return.
     EXPECT_EQ(len, read_callback_.WaitForResult());
-    ASSERT_EQ(std::string(data, len), std::string(read_buf_->data(), len));
+    ASSERT_EQ(std::string(data, len),
+              std::string(read_buf_->data().data(), len));
   }
 
  protected:
diff --git a/net/server/http_connection_unittest.cc b/net/server/http_connection_unittest.cc
index 2b5d1d5acad96..c1fde3e9dea12 100644
--- a/net/server/http_connection_unittest.cc
+++ b/net/server/http_connection_unittest.cc
@@ -162,7 +162,7 @@ TEST(HttpConnectionTest, ReadIOBuffer_DidRead_DidConsume) {
   // data is correctly split into two disjoint spans. The raw pointers are never
   // dereferenced.
   EXPECT_EQ(UNSAFE_BUFFERS(buffer->readable_bytes().data() + kReadLength),
-            buffer->bytes());
+            buffer->bytes().data());
   // Test read data.
   EXPECT_EQ(kReadData, base::as_string_view(buffer->readable_bytes()));
 
@@ -187,7 +187,7 @@ TEST(HttpConnectionTest, ReadIOBuffer_DidRead_DidConsume) {
   // dereferenced.
   EXPECT_EQ(UNSAFE_BUFFERS(buffer->readable_bytes().data() + kReadLength -
                            kConsumedLength),
-            buffer->bytes());
+            buffer->bytes().data());
   // Change in read data.
   EXPECT_EQ(kReadData.substr(kConsumedLength),
             base::as_string_view(buffer->readable_bytes()));
@@ -215,7 +215,7 @@ TEST(HttpConnectionTest, ReadIOBuffer_DidRead_DidConsume) {
   // dereferenced.
   EXPECT_EQ(UNSAFE_BUFFERS(buffer->readable_bytes().data() + kReadLength -
                            kConsumedLength + kReadLength2),
-            buffer->bytes());
+            buffer->bytes().data());
 
   // Consume data fully.
   buffer->DidConsume(kReadLength - kConsumedLength + kReadLength2);
@@ -232,7 +232,7 @@ TEST(HttpConnectionTest, ReadIOBuffer_DidRead_DidConsume) {
   EXPECT_TRUE(buffer->readable_bytes().empty());
   // Start data could be changed even when capacity is reduced.
   start_of_buffer = buffer->readable_bytes().data();
-  EXPECT_EQ(start_of_buffer, buffer->bytes());
+  EXPECT_EQ(start_of_buffer, buffer->bytes().data());
 }
 
 TEST(HttpConnectionTest, QueuedWriteIOBuffer_Append_DidConsume) {
@@ -248,7 +248,8 @@ TEST(HttpConnectionTest, QueuedWriteIOBuffer_Append_DidConsume) {
   EXPECT_EQ(static_cast<int>(kData.size()), buffer->GetSizeToWrite());
   EXPECT_EQ(static_cast<int>(kData.size()), buffer->total_size());
   // First data to write is same to kData.
-  EXPECT_EQ(kData, std::string_view(buffer->data(), buffer->GetSizeToWrite()));
+  EXPECT_EQ(kData,
+            std::string_view(buffer->data().data(), buffer->GetSizeToWrite()));
 
   const std::string kData2("more data to write");
   EXPECT_TRUE(buffer->Append(kData2));
@@ -259,7 +260,8 @@ TEST(HttpConnectionTest, QueuedWriteIOBuffer_Append_DidConsume) {
   EXPECT_EQ(static_cast<int>(kData.size() + kData2.size()),
             buffer->total_size());
   // First data to write has not been changed. Same to kData.
-  EXPECT_EQ(kData, std::string_view(buffer->data(), buffer->GetSizeToWrite()));
+  EXPECT_EQ(kData,
+            std::string_view(buffer->data().data(), buffer->GetSizeToWrite()));
 
   // Consume data partially.
   const int kConsumedLength = kData.length() - 1;
@@ -273,7 +275,7 @@ TEST(HttpConnectionTest, QueuedWriteIOBuffer_Append_DidConsume) {
             buffer->total_size());
   // First data to write has shrinked.
   EXPECT_EQ(kData.substr(kConsumedLength),
-            std::string_view(buffer->data(), buffer->GetSizeToWrite()));
+            std::string_view(buffer->data().data(), buffer->GetSizeToWrite()));
 
   // Consume first data fully.
   buffer->DidConsume(kData.size() - kConsumedLength);
@@ -283,7 +285,8 @@ TEST(HttpConnectionTest, QueuedWriteIOBuffer_Append_DidConsume) {
   // Change in total size.
   EXPECT_EQ(static_cast<int>(kData2.size()), buffer->total_size());
   // First data to write has changed to kData2.
-  EXPECT_EQ(kData2, std::string_view(buffer->data(), buffer->GetSizeToWrite()));
+  EXPECT_EQ(kData2,
+            std::string_view(buffer->data().data(), buffer->GetSizeToWrite()));
 
   // Consume second data fully.
   buffer->DidConsume(kData2.size());
@@ -348,7 +351,7 @@ TEST(HttpConnectionTest, QueuedWriteIOBuffer_DataPointerStability) {
   // to something other than start of string right.
   buffer->DidConsume(3);
   const char* old_data = buffer->data();
-  EXPECT_EQ("defgh", std::string_view(buffer->data(), 5));
+  EXPECT_EQ("defgh", std::string_view(buffer->data().data(), 5));
 
   // Now append a whole bunch of other things to make the underlying queue
   // grow, and likely need to move stuff around in memory.
@@ -356,7 +359,7 @@ TEST(HttpConnectionTest, QueuedWriteIOBuffer_DataPointerStability) {
     buffer->Append("some other string data");
 
   // data() should still be right.
-  EXPECT_EQ("defgh", std::string_view(buffer->data(), 5));
+  EXPECT_EQ("defgh", std::string_view(buffer->data().data(), 5));
 
   // ... it should also be bitwise the same, since the IOBuffer can get passed
   // to async calls and then have Append's come in.
diff --git a/net/server/http_server_unittest.cc b/net/server/http_server_unittest.cc
index ed3633b615109..47d2000eafcf0 100644
--- a/net/server/http_server_unittest.cc
+++ b/net/server/http_server_unittest.cc
@@ -98,7 +98,7 @@ class TestHttpClient {
       }
 
       total_bytes_received += bytes_received;
-      message->append(read_buffer_->data(), bytes_received);
+      message->append(read_buffer_->data().data(), bytes_received);
     }
     return true;
   }
@@ -1045,7 +1045,7 @@ class MockStreamSocket : public StreamSocket {
     DCHECK_GT(buf_len, 0);
     int read_len =
         std::min(static_cast<int>(pending_read_data_.size()), buf_len);
-    memcpy(buf->data(), pending_read_data_.data(), read_len);
+    memcpy(buf->data().data(), pending_read_data_.data(), read_len);
     pending_read_data_.erase(0, read_len);
     return read_len;
   }
@@ -1067,7 +1067,7 @@ class MockStreamSocket : public StreamSocket {
       return;
     }
     int read_len = std::min(data_len, read_buf_len_);
-    memcpy(read_buf_->data(), data, read_len);
+    memcpy(read_buf_->data().data(), data, read_len);
     pending_read_data_.assign(data + read_len, data_len - read_len);
     read_buf_ = nullptr;
     read_buf_len_ = 0;
diff --git a/net/server/web_socket_encoder.cc b/net/server/web_socket_encoder.cc
index 2a7d1ba8d523c..33e12b6ed160f 100644
--- a/net/server/web_socket_encoder.cc
+++ b/net/server/web_socket_encoder.cc
@@ -378,7 +378,8 @@ bool WebSocketEncoder::Inflate(std::string* message) {
         inflater_->GetOutput(inflater_->CurrentOutputSize());
     if (!chunk.get())
       return false;
-    output.insert(output.end(), chunk->data(), chunk->data() + chunk->size());
+    output.insert(output.end(), chunk->data().data(),
+                  chunk->data().subspan(chunk->size()).data());
   }
 
   *message =
@@ -399,7 +400,7 @@ bool WebSocketEncoder::Deflate(std::string_view message, std::string* output) {
       deflater_->GetOutput(deflater_->CurrentOutputSize());
   if (!buffer.get())
     return false;
-  *output = std::string(buffer->data(), buffer->size());
+  *output = std::string(buffer->data().data(), buffer->size());
   return true;
 }
 
diff --git a/net/shared_dictionary/shared_dictionary_network_transaction_unittest.cc b/net/shared_dictionary/shared_dictionary_network_transaction_unittest.cc
index 7e057bebbce07..5879b6bace62a 100644
--- a/net/shared_dictionary/shared_dictionary_network_transaction_unittest.cc
+++ b/net/shared_dictionary/shared_dictionary_network_transaction_unittest.cc
@@ -284,7 +284,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, SyncDictionary) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest, NotAllowedToUseDictionary) {
@@ -319,7 +319,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, NotAllowedToUseDictionary) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest, DictionaryId) {
@@ -358,7 +358,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, DictionaryId) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest,
@@ -399,7 +399,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest,
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest, EmptyDictionaryId) {
@@ -437,7 +437,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, EmptyDictionaryId) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest,
@@ -476,7 +476,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest,
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest,
@@ -513,7 +513,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest,
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest,
@@ -552,7 +552,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest,
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest, NoMatchingDictionary) {
@@ -586,7 +586,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, NoMatchingDictionary) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest, OpaqueFrameOrigin) {
@@ -623,7 +623,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, OpaqueFrameOrigin) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest, WithoutValidLoadFlag) {
@@ -663,7 +663,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, WithoutValidLoadFlag) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 
   // SharedDictionaryGetter must not be called when
   // LOAD_CAN_USE_SHARED_DICTIONARY is not set.
@@ -702,7 +702,8 @@ TEST_F(SharedDictionaryNetworkTransactionTest, NoSbrContentEncoding) {
   // When there is no "content-encoding: dcb" header,
   // SharedDictionaryNetworkTransaction must not decode the body.
   EXPECT_THAT(read_result, kBrotliEncodedDataString.size());
-  EXPECT_EQ(kBrotliEncodedDataString, std::string(buf->data(), read_result));
+  EXPECT_EQ(kBrotliEncodedDataString,
+            std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest, WrongContentDictionaryHeader) {
@@ -771,7 +772,8 @@ TEST_F(SharedDictionaryNetworkTransactionTest, MultipleContentEncodingWithSbr) {
   // When there is Content-Encoding header which value is other than "dcb",
   // SharedDictionaryNetworkTransaction must not decode the body.
   EXPECT_THAT(read_result, kBrotliEncodedDataString.size());
-  EXPECT_EQ(kBrotliEncodedDataString, std::string(buf->data(), read_result));
+  EXPECT_EQ(kBrotliEncodedDataString,
+            std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest,
@@ -813,7 +815,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest,
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest,
@@ -859,7 +861,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest,
 
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 TEST_F(SharedDictionaryNetworkTransactionTest,
@@ -1115,7 +1117,7 @@ TEST_F(SharedDictionaryNetworkTransactionTest, SharedZstd) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 #endif  // defined(NET_DISABLE_ZSTD)
 }
 
@@ -1153,7 +1155,8 @@ TEST_F(SharedDictionaryNetworkTransactionTest, NoZstdDContentEncoding) {
   // When there is no "content-encoding: dcz" header,
   // SharedDictionaryNetworkTransaction must not decode the body.
   EXPECT_THAT(read_result, kZstdEncodedDataString.size());
-  EXPECT_EQ(kZstdEncodedDataString, std::string(buf->data(), read_result));
+  EXPECT_EQ(kZstdEncodedDataString,
+            std::string(buf->data().data(), read_result));
 }
 
 enum class ProtocolCheckProtocolTestCase {
@@ -1361,7 +1364,7 @@ TEST_P(SharedDictionaryNetworkTransactionProtocolCheckTest, Basic) {
       test::IsError(ERR_IO_PENDING));
   int read_result = read_callback.WaitForResult();
   EXPECT_THAT(read_result, kTestData.size());
-  EXPECT_EQ(kTestData, std::string(buf->data(), read_result));
+  EXPECT_EQ(kTestData, std::string(buf->data().data(), read_result));
 }
 
 }  // namespace
diff --git a/net/socket/read_buffering_stream_socket.cc b/net/socket/read_buffering_stream_socket.cc
index a61fe389fe75c..134e3c22ba44f 100644
--- a/net/socket/read_buffering_stream_socket.cc
+++ b/net/socket/read_buffering_stream_socket.cc
@@ -133,7 +133,7 @@ int ReadBufferingStreamSocket::CopyToCaller(IOBuffer* buf, int buf_len) {
   DCHECK(buffer_full_);
 
   buf_len = std::min(buf_len, read_buffer_->RemainingCapacity());
-  memcpy(buf->data(), read_buffer_->data(), buf_len);
+  memcpy(buf->data().data(), read_buffer_->data().data(), buf_len);
   read_buffer_->set_offset(read_buffer_->offset() + buf_len);
   if (read_buffer_->RemainingCapacity() == 0) {
     read_buffer_ = nullptr;
diff --git a/net/socket/sequenced_socket_data_unittest.cc b/net/socket/sequenced_socket_data_unittest.cc
index 64d71fb65cdb6..58568a21da847 100644
--- a/net/socket/sequenced_socket_data_unittest.cc
+++ b/net/socket/sequenced_socket_data_unittest.cc
@@ -116,7 +116,7 @@ class ReentrantHelper {
     ASSERT_EQ(first_len_, rv);
     if (verify_read_) {
       ASSERT_EQ(std::string(first_read_data_, first_len_),
-                std::string(first_read_buf_->data(), rv));
+                std::string(first_read_buf_->data().data(), rv));
     }
 
     if (second_read_) {
@@ -124,7 +124,7 @@ class ReentrantHelper {
                                           std::move(second_callback_)));
     } else {
       auto write_buf = base::MakeRefCounted<IOBufferWithSize>(second_len_);
-      memcpy(write_buf->data(), second_write_data_, second_len_);
+      memcpy(write_buf->data().data(), second_write_data_, second_len_);
       ASSERT_EQ(second_rv_, socket_->Write(write_buf.get(), second_len_,
                                            std::move(second_callback_),
                                            TRAFFIC_ANNOTATION_FOR_TESTS));
@@ -284,7 +284,7 @@ void SequencedSocketDataTest::AssertReadReturns(int len, int rv) {
 
 void SequencedSocketDataTest::AssertReadBufferEquals(const char* data,
                                                      int len) {
-  ASSERT_EQ(std::string(data, len), std::string(read_buf_->data(), len));
+  ASSERT_EQ(std::string(data, len), std::string(read_buf_->data().data(), len));
 }
 
 void SequencedSocketDataTest::AssertSyncWriteEquals(const char* data, int len) {
@@ -320,7 +320,7 @@ void SequencedSocketDataTest::AssertWriteReturns(const char* data,
                                                  int len,
                                                  int rv) {
   auto buf = base::MakeRefCounted<IOBufferWithSize>(len);
-  memcpy(buf->data(), data, len);
+  memcpy(buf->data().data(), data, len);
 
   if (rv == ERR_IO_PENDING) {
     ASSERT_EQ(rv, sock_->Write(buf.get(), len, write_callback_.callback(),
@@ -369,7 +369,7 @@ void SequencedSocketDataTest::ReentrantAsyncWriteCallback(
     int rv) {
   EXPECT_EQ(expected_rv, rv);
   auto write_buf = base::MakeRefCounted<IOBufferWithSize>(len);
-  memcpy(write_buf->data(), data, len);
+  memcpy(write_buf->data().data(), data, len);
   EXPECT_THAT(sock_->Write(write_buf.get(), len, std::move(callback),
                            TRAFFIC_ANNOTATION_FOR_TESTS),
               IsError(ERR_IO_PENDING));
@@ -575,7 +575,8 @@ TEST_F(SequencedSocketDataTest, SingleSyncReadLargeBuffer) {
   Initialize(reads, base::span<MockWrite>());
   auto read_buf = base::MakeRefCounted<IOBufferWithSize>(2 * kLen1);
   ASSERT_EQ(kLen1, sock_->Read(read_buf.get(), 2 * kLen1, failing_callback()));
-  ASSERT_EQ(std::string(kMsg1, kLen1), std::string(read_buf->data(), kLen1));
+  ASSERT_EQ(std::string(kMsg1, kLen1),
+            std::string(read_buf->data().data(), kLen1));
 }
 
 TEST_F(SequencedSocketDataTest, SingleAsyncReadLargeBuffer) {
@@ -589,7 +590,8 @@ TEST_F(SequencedSocketDataTest, SingleAsyncReadLargeBuffer) {
   ASSERT_EQ(ERR_IO_PENDING,
             sock_->Read(read_buf.get(), 2 * kLen1, read_callback_.callback()));
   ASSERT_EQ(kLen1, read_callback_.WaitForResult());
-  ASSERT_EQ(std::string(kMsg1, kLen1), std::string(read_buf->data(), kLen1));
+  ASSERT_EQ(std::string(kMsg1, kLen1),
+            std::string(read_buf->data().data(), kLen1));
 }
 
 TEST_F(SequencedSocketDataTest, HangingRead) {
@@ -778,7 +780,7 @@ TEST_F(SequencedSocketDataTest, SyncWriteFromCompletionCallback) {
   Initialize(base::span<MockRead>(), writes);
 
   auto write_buf = base::MakeRefCounted<IOBufferWithSize>(kLen1);
-  memcpy(write_buf->data(), kMsg1, kLen1);
+  memcpy(write_buf->data().data(), kMsg1, kLen1);
   ASSERT_EQ(
       ERR_IO_PENDING,
       sock_->Write(
@@ -798,7 +800,7 @@ TEST_F(SequencedSocketDataTest, AsyncWriteFromCompletionCallback) {
   Initialize(base::span<MockRead>(), writes);
 
   auto write_buf = base::MakeRefCounted<IOBufferWithSize>(kLen1);
-  memcpy(write_buf->data(), kMsg1, kLen1);
+  memcpy(write_buf->data().data(), kMsg1, kLen1);
   ASSERT_EQ(ERR_IO_PENDING,
             sock_->Write(
                 write_buf.get(), kLen1,
@@ -835,7 +837,7 @@ TEST_F(SequencedSocketDataTest, ManyReentrantWrites) {
   helper.SetInvokeWrite(kMsg2, kLen2, ERR_IO_PENDING, helper2.callback());
 
   auto write_buf = base::MakeRefCounted<IOBufferWithSize>(kLen1);
-  memcpy(write_buf->data(), kMsg1, kLen1);
+  memcpy(write_buf->data().data(), kMsg1, kLen1);
   sock_->Write(write_buf.get(), kLen1, helper.callback(),
                TRAFFIC_ANNOTATION_FOR_TESTS);
 
@@ -976,7 +978,7 @@ TEST_F(SequencedSocketDataTest, AsyncReadFromWriteCompletionCallback) {
   Initialize(reads, writes);
 
   auto write_buf = base::MakeRefCounted<IOBufferWithSize>(kLen1);
-  memcpy(write_buf->data(), kMsg1, kLen1);
+  memcpy(write_buf->data().data(), kMsg1, kLen1);
   ASSERT_EQ(
       ERR_IO_PENDING,
       sock_->Write(
@@ -1042,7 +1044,7 @@ TEST_F(SequencedSocketDataTest, MixedReentrantOperations) {
                        helper2.callback());
 
   auto write_buf = base::MakeRefCounted<IOBufferWithSize>(kLen1);
-  memcpy(write_buf->data(), kMsg1, kLen1);
+  memcpy(write_buf->data().data(), kMsg1, kLen1);
   sock_->Write(write_buf.get(), kLen1, helper.callback(),
                TRAFFIC_ANNOTATION_FOR_TESTS);
 
@@ -1076,7 +1078,7 @@ TEST_F(SequencedSocketDataTest, MixedReentrantOperationsThenSynchronousRead) {
                        helper2.callback());
 
   auto write_buf = base::MakeRefCounted<IOBufferWithSize>(kLen1);
-  memcpy(write_buf->data(), kMsg1, kLen1);
+  memcpy(write_buf->data().data(), kMsg1, kLen1);
   ASSERT_EQ(ERR_IO_PENDING,
             sock_->Write(write_buf.get(), kLen1, helper.callback(),
                          TRAFFIC_ANNOTATION_FOR_TESTS));
diff --git a/net/socket/socket_posix.cc b/net/socket/socket_posix.cc
index c7d4e753c6e77..57f5eb6fbb7a5 100644
--- a/net/socket/socket_posix.cc
+++ b/net/socket/socket_posix.cc
@@ -485,7 +485,7 @@ void SocketPosix::ConnectCompleted() {
 }
 
 int SocketPosix::DoRead(IOBuffer* buf, int buf_len) {
-  int rv = HANDLE_EINTR(read(socket_fd_, buf->data(), buf_len));
+  int rv = HANDLE_EINTR(read(socket_fd_, buf->data().data(), buf_len));
   return rv >= 0 ? rv : MapSystemError(errno);
 }
 
@@ -515,7 +515,8 @@ void SocketPosix::ReadCompleted() {
 }
 
 int SocketPosix::DoWrite(IOBuffer* buf, int buf_len) {
-  int rv = HANDLE_EINTR(send(socket_fd_, buf->data(), buf_len, MSG_NOSIGNAL));
+  int rv =
+      HANDLE_EINTR(send(socket_fd_, buf->data().data(), buf_len, MSG_NOSIGNAL));
   if (rv >= 0) {
     CHECK_LE(rv, buf_len);
   }
diff --git a/net/socket/socket_test_util.cc b/net/socket/socket_test_util.cc
index c49ee9e65614c..3d639938665a0 100644
--- a/net/socket/socket_test_util.cc
+++ b/net/socket/socket_test_util.cc
@@ -1104,7 +1104,7 @@ int MockTCPClientSocket::Write(
   if (!connected_ || !data_)
     return ERR_UNEXPECTED;
 
-  std::string data(buf->data(), buf_len);
+  std::string data(buf->data().data(), buf_len);
   MockWriteResult write_result = data_->OnWrite(data);
 
   was_used_to_convey_data_ = true;
@@ -1364,7 +1364,7 @@ int MockTCPClientSocket::ReadIfReadyImpl(IOBuffer* buf,
     if (read_data_.data.length() - read_offset_ > 0) {
       result = std::min(
           buf_len, static_cast<int>(read_data_.data.length()) - read_offset_);
-      memcpy(buf->data(), read_data_.data.data() + read_offset_, result);
+      memcpy(buf->data().data(), read_data_.data.data() + read_offset_, result);
       read_offset_ += result;
       if (read_offset_ == static_cast<int>(read_data_.data.length())) {
         need_read_data_ = true;
@@ -1668,7 +1668,7 @@ int MockUDPClientSocket::Write(
     return ERR_UNEXPECTED;
   data_transferred_ = true;
 
-  std::string data(buf->data(), buf_len);
+  std::string data(buf->data().data(), buf_len);
   MockWriteResult write_result = data_->OnWrite(data);
 
   // ERR_IO_PENDING is a signal that the socket data will call back
@@ -1904,7 +1904,7 @@ int MockUDPClientSocket::CompleteRead() {
     if (read_data_.data.length() - read_offset_ > 0) {
       result = std::min(
           buf_len, static_cast<int>(read_data_.data.length()) - read_offset_);
-      memcpy(buf->data(), read_data_.data.data() + read_offset_, result);
+      memcpy(buf->data().data(), read_data_.data.data() + read_offset_, result);
       read_offset_ += result;
       if (read_offset_ == static_cast<int>(read_data_.data.length())) {
         need_read_data_ = true;
diff --git a/net/socket/socks5_client_socket_unittest.cc b/net/socket/socks5_client_socket_unittest.cc
index d8b9af81d0d1a..e8813f8ffd451 100644
--- a/net/socket/socks5_client_socket_unittest.cc
+++ b/net/socket/socks5_client_socket_unittest.cc
@@ -164,7 +164,7 @@ TEST_F(SOCKS5ClientSocketTest, CompleteHandshake) {
                                   NetLogEventType::SOCKS5_CONNECT));
 
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(payload_write.size());
-  memcpy(buffer->data(), payload_write.data(), payload_write.size());
+  memcpy(buffer->data().data(), payload_write.data(), payload_write.size());
   rv = user_sock_->Write(buffer.get(), payload_write.size(),
                          callback_.callback(), TRAFFIC_ANNOTATION_FOR_TESTS);
   EXPECT_THAT(rv, IsError(ERR_IO_PENDING));
@@ -177,7 +177,8 @@ TEST_F(SOCKS5ClientSocketTest, CompleteHandshake) {
   EXPECT_THAT(rv, IsError(ERR_IO_PENDING));
   rv = callback_.WaitForResult();
   EXPECT_EQ(static_cast<int>(payload_read.size()), rv);
-  EXPECT_EQ(payload_read, std::string(buffer->data(), payload_read.size()));
+  EXPECT_EQ(payload_read,
+            std::string(buffer->data().data(), payload_read.size()));
 
   user_sock_->Disconnect();
   EXPECT_FALSE(tcp_sock_->IsConnected());
diff --git a/net/socket/socks_client_socket.cc b/net/socket/socks_client_socket.cc
index 7d45b01d8a230..218bf5d20da98 100644
--- a/net/socket/socks_client_socket.cc
+++ b/net/socket/socks_client_socket.cc
@@ -359,7 +359,7 @@ int SOCKSClientSocket::DoHandshakeWrite() {
   int handshake_buf_len = buffer_.size() - bytes_sent_;
   DCHECK_GT(handshake_buf_len, 0);
   handshake_buf_ = base::MakeRefCounted<IOBufferWithSize>(handshake_buf_len);
-  memcpy(handshake_buf_->data(), &buffer_[bytes_sent_],
+  memcpy(handshake_buf_->data().data(), &buffer_[bytes_sent_],
          handshake_buf_len);
   return transport_socket_->Write(
       handshake_buf_.get(), handshake_buf_len,
@@ -414,7 +414,7 @@ int SOCKSClientSocket::DoHandshakeReadComplete(int result) {
     return ERR_SOCKS_CONNECTION_FAILED;
   }
 
-  buffer_.append(handshake_buf_->data(), result);
+  buffer_.append(handshake_buf_->data().data(), result);
   bytes_received_ += result;
   if (bytes_received_ < kReadHeaderSize) {
     next_state_ = STATE_HANDSHAKE_READ;
diff --git a/net/socket/socks_client_socket_unittest.cc b/net/socket/socks_client_socket_unittest.cc
index 690873b3a78c1..f20b5fe01c5c5 100644
--- a/net/socket/socks_client_socket_unittest.cc
+++ b/net/socket/socks_client_socket_unittest.cc
@@ -143,7 +143,7 @@ TEST_F(SOCKSClientSocketTest, CompleteHandshake) {
         LogContainsEndEvent(entries, -1, NetLogEventType::SOCKS_CONNECT));
 
     auto buffer = base::MakeRefCounted<IOBufferWithSize>(payload_write.size());
-    memcpy(buffer->data(), payload_write.data(), payload_write.size());
+    memcpy(buffer->data().data(), payload_write.data(), payload_write.size());
     rv = user_sock_->Write(buffer.get(), payload_write.size(),
                            callback_.callback(), TRAFFIC_ANNOTATION_FOR_TESTS);
     EXPECT_THAT(rv, IsError(ERR_IO_PENDING));
@@ -166,7 +166,8 @@ TEST_F(SOCKSClientSocketTest, CompleteHandshake) {
       rv = callback_.WaitForResult();
     }
     EXPECT_EQ(static_cast<int>(payload_read.size()), rv);
-    EXPECT_EQ(payload_read, std::string(buffer->data(), payload_read.size()));
+    EXPECT_EQ(payload_read,
+              std::string(buffer->data().data(), payload_read.size()));
 
     user_sock_->Disconnect();
     EXPECT_FALSE(tcp_sock_->IsConnected());
diff --git a/net/socket/ssl_client_socket_impl.cc b/net/socket/ssl_client_socket_impl.cc
index d38d6cf8c1721..d36de9aae7028 100644
--- a/net/socket/ssl_client_socket_impl.cc
+++ b/net/socket/ssl_client_socket_impl.cc
@@ -1270,7 +1270,7 @@ int SSLClientSocketImpl::DoPayloadRead(IOBuffer* buf, int buf_len) {
   int total_bytes_read = 0;
   int ssl_ret, ssl_err;
   do {
-    ssl_ret = SSL_read(ssl_.get(), buf->data() + total_bytes_read,
+    ssl_ret = SSL_read(ssl_.get(), buf->data().subspan(total_bytes_read).data(),
                        buf_len - total_bytes_read);
     ssl_err = SSL_get_error(ssl_.get(), ssl_ret);
     if (ssl_ret > 0) {
@@ -1345,7 +1345,8 @@ int SSLClientSocketImpl::DoPayloadRead(IOBuffer* buf, int buf_len) {
 
 int SSLClientSocketImpl::DoPayloadWrite() {
   crypto::OpenSSLErrStackTracer err_tracer(FROM_HERE);
-  int rv = SSL_write(ssl_.get(), user_write_buf_->data(), user_write_buf_len_);
+  int rv = SSL_write(ssl_.get(), user_write_buf_->data().data(),
+                     user_write_buf_len_);
 
   if (rv >= 0) {
     CHECK_LE(rv, user_write_buf_len_);
diff --git a/net/socket/ssl_client_socket_unittest.cc b/net/socket/ssl_client_socket_unittest.cc
index a525341632b8d..4706660c4b92f 100644
--- a/net/socket/ssl_client_socket_unittest.cc
+++ b/net/socket/ssl_client_socket_unittest.cc
@@ -360,7 +360,7 @@ int FakeBlockingStreamSocket::ReadIfReady(IOBuffer* buf,
     CHECK(!should_block_read_);
     CHECK_GE(len, static_cast<int>(read_if_ready_buf_.size()));
     int rv = read_if_ready_buf_.size();
-    memcpy(buf->data(), read_if_ready_buf_.data(), rv);
+    memcpy(buf->data().data(), read_if_ready_buf_.data(), rv);
     read_if_ready_buf_.clear();
     return rv;
   }
@@ -369,7 +369,7 @@ int FakeBlockingStreamSocket::ReadIfReady(IOBuffer* buf,
                 base::BindOnce(&FakeBlockingStreamSocket::CompleteReadIfReady,
                                base::Unretained(this), buf_copy));
   if (rv > 0)
-    memcpy(buf->data(), buf_copy->data(), rv);
+    memcpy(buf->data().data(), buf_copy->data().data(), rv);
   if (rv == ERR_IO_PENDING)
     read_if_ready_callback_ = std::move(callback);
   return rv;
@@ -430,7 +430,7 @@ bool FakeBlockingStreamSocket::ReplaceReadResult(const std::string& data) {
   if (static_cast<size_t>(pending_read_buf_len_) < data.size())
     return false;
 
-  memcpy(pending_read_buf_->data(), data.data(), data.size());
+  memcpy(pending_read_buf_->data().data(), data.data(), data.size());
   pending_read_result_ = data.size();
   return true;
 }
@@ -511,7 +511,8 @@ void FakeBlockingStreamSocket::CompleteReadIfReady(scoped_refptr<IOBuffer> buf,
   DCHECK(read_if_ready_buf_.empty());
   DCHECK(!should_block_read_);
   if (rv > 0)
-    read_if_ready_buf_ = std::string(buf->data(), buf->data() + rv);
+    read_if_ready_buf_ =
+        std::string(buf->data().data(), buf->data().subspan(rv).data());
   // The callback may be null if CancelReadIfReady() was called.
   if (!read_if_ready_callback_.is_null())
     std::move(read_if_ready_callback_).Run(rv > 0 ? OK : rv);
@@ -1091,7 +1092,7 @@ class SSLClientSocketFalseStartTest : public SSLClientSocketTest {
           static_cast<int>(std::size(request_text) - 1);
       auto request_buffer =
           base::MakeRefCounted<IOBufferWithSize>(kRequestTextSize);
-      memcpy(request_buffer->data(), request_text, kRequestTextSize);
+      memcpy(request_buffer->data().data(), request_text, kRequestTextSize);
 
       // Write the request.
       rv = callback.GetResult(sock->Write(request_buffer.get(),
@@ -1242,7 +1243,7 @@ class SSLClientSocketZeroRTTTest : public SSLClientSocketTest {
   int WriteAndWait(std::string_view request) {
     auto request_buffer =
         base::MakeRefCounted<IOBufferWithSize>(request.size());
-    memcpy(request_buffer->data(), request.data(), request.size());
+    memcpy(request_buffer->data().data(), request.data(), request.size());
     return callback_.GetResult(
         ssl_socket_->Write(request_buffer.get(), request.size(),
                            callback_.callback(), TRAFFIC_ANNOTATION_FOR_TESTS));
@@ -1588,7 +1589,8 @@ TEST_P(SSLClientSocketReadTest, Read) {
   const char request_text[] = "GET / HTTP/1.0\r\n\r\n";
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(std::size(request_text) - 1);
-  memcpy(request_buffer->data(), request_text, std::size(request_text) - 1);
+  memcpy(request_buffer->data().data(), request_text,
+         std::size(request_text) - 1);
 
   rv = callback.GetResult(
       sock->Write(request_buffer.get(), std::size(request_text) - 1,
@@ -1673,7 +1675,7 @@ TEST_P(SSLClientSocketReadTest, Read_WithSynchronousError) {
       static_cast<int>(std::size(request_text) - 1);
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(kRequestTextSize);
-  memcpy(request_buffer->data(), request_text, kRequestTextSize);
+  memcpy(request_buffer->data().data(), request_text, kRequestTextSize);
 
   rv = callback.GetResult(sock->Write(request_buffer.get(), kRequestTextSize,
                                       callback.callback(),
@@ -1726,7 +1728,7 @@ TEST_P(SSLClientSocketVersionTest, Write_WithSynchronousError) {
       static_cast<int>(std::size(request_text) - 1);
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(kRequestTextSize);
-  memcpy(request_buffer->data(), request_text, kRequestTextSize);
+  memcpy(request_buffer->data().data(), request_text, kRequestTextSize);
 
   // Simulate an unclean/forcible shutdown on the underlying socket.
   // However, simulate this error asynchronously.
@@ -1794,7 +1796,7 @@ TEST_P(SSLClientSocketVersionTest, Write_WithSynchronousErrorNoRead) {
       static_cast<int>(std::size(request_text) - 1);
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(kRequestTextSize);
-  memcpy(request_buffer->data(), request_text, kRequestTextSize);
+  memcpy(request_buffer->data().data(), request_text, kRequestTextSize);
 
   // This write should complete synchronously, because the TLS ciphertext
   // can be created and placed into the outgoing buffers independent of the
@@ -1978,7 +1980,7 @@ TEST_P(SSLClientSocketReadTest, Read_WithWriteError) {
       static_cast<int>(std::size(request_text) - 1);
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(kRequestTextSize);
-  memcpy(request_buffer->data(), request_text, kRequestTextSize);
+  memcpy(request_buffer->data().data(), request_text, kRequestTextSize);
 
   rv = callback.GetResult(sock->Write(request_buffer.get(), kRequestTextSize,
                                       callback.callback(),
@@ -2159,7 +2161,8 @@ TEST_P(SSLClientSocketReadTest, Read_SmallChunks) {
   const char request_text[] = "GET / HTTP/1.0\r\n\r\n";
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(std::size(request_text) - 1);
-  memcpy(request_buffer->data(), request_text, std::size(request_text) - 1);
+  memcpy(request_buffer->data().data(), request_text,
+         std::size(request_text) - 1);
 
   TestCompletionCallback callback;
   rv = callback.GetResult(
@@ -2200,7 +2203,8 @@ TEST_P(SSLClientSocketReadTest, Read_ManySmallRecords) {
   const char request_text[] = "GET /ssl-many-small-records HTTP/1.0\r\n\r\n";
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(std::size(request_text) - 1);
-  memcpy(request_buffer->data(), request_text, std::size(request_text) - 1);
+  memcpy(request_buffer->data().data(), request_text,
+         std::size(request_text) - 1);
 
   rv = callback.GetResult(
       sock->Write(request_buffer.get(), std::size(request_text) - 1,
@@ -2235,7 +2239,8 @@ TEST_P(SSLClientSocketReadTest, Read_Interrupted) {
   const char request_text[] = "GET / HTTP/1.0\r\n\r\n";
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(std::size(request_text) - 1);
-  memcpy(request_buffer->data(), request_text, std::size(request_text) - 1);
+  memcpy(request_buffer->data().data(), request_text,
+         std::size(request_text) - 1);
 
   TestCompletionCallback callback;
   rv = callback.GetResult(
@@ -2270,7 +2275,8 @@ TEST_P(SSLClientSocketReadTest, Read_FullLogging) {
   const char request_text[] = "GET / HTTP/1.0\r\n\r\n";
   auto request_buffer =
       base::MakeRefCounted<IOBufferWithSize>(std::size(request_text) - 1);
-  memcpy(request_buffer->data(), request_text, std::size(request_text) - 1);
+  memcpy(request_buffer->data().data(), request_text,
+         std::size(request_text) - 1);
 
   rv = callback.GetResult(
       sock->Write(request_buffer.get(), std::size(request_text) - 1,
@@ -2760,7 +2766,7 @@ TEST_P(SSLClientSocketVersionTest, ReuseStates) {
   const char kRequestText[] = "GET / HTTP/1.0\r\n\r\n";
   const size_t kRequestLen = std::size(kRequestText) - 1;
   auto request_buffer = base::MakeRefCounted<IOBufferWithSize>(kRequestLen);
-  memcpy(request_buffer->data(), kRequestText, kRequestLen);
+  memcpy(request_buffer->data().data(), kRequestText, kRequestLen);
 
   TestCompletionCallback callback;
   rv = callback.GetResult(sock_->Write(request_buffer.get(), kRequestLen,
@@ -2832,7 +2838,7 @@ TEST_P(SSLClientSocketVersionTest, ReusableAfterWrite) {
   const char kRequestText[] = "GET / HTTP/1.0";
   const size_t kRequestLen = std::size(kRequestText) - 1;
   auto request_buffer = base::MakeRefCounted<IOBufferWithSize>(kRequestLen);
-  memcpy(request_buffer->data(), kRequestText, kRequestLen);
+  memcpy(request_buffer->data().data(), kRequestText, kRequestLen);
 
   // Although transport writes are blocked, SSLClientSocketImpl completes the
   // outer Write operation.
diff --git a/net/socket/ssl_server_socket_impl.cc b/net/socket/ssl_server_socket_impl.cc
index 22085f2fb7284..73ca047434c0f 100644
--- a/net/socket/ssl_server_socket_impl.cc
+++ b/net/socket/ssl_server_socket_impl.cc
@@ -650,7 +650,7 @@ int SSLServerContextImpl::SocketImpl::DoPayloadRead(IOBuffer* buf,
   DCHECK_GT(buf_len, 0);
 
   crypto::OpenSSLErrStackTracer err_tracer(FROM_HERE);
-  int rv = SSL_read(ssl_.get(), buf->data(), buf_len);
+  int rv = SSL_read(ssl_.get(), buf->data().data(), buf_len);
   if (rv >= 0) {
     if (SSL_in_early_data(ssl_.get()))
       early_data_received_ = true;
@@ -673,7 +673,8 @@ int SSLServerContextImpl::SocketImpl::DoPayloadWrite() {
   DCHECK(user_write_buf_);
 
   crypto::OpenSSLErrStackTracer err_tracer(FROM_HERE);
-  int rv = SSL_write(ssl_.get(), user_write_buf_->data(), user_write_buf_len_);
+  int rv = SSL_write(ssl_.get(), user_write_buf_->data().data(),
+                     user_write_buf_len_);
   if (rv >= 0)
     return rv;
   int ssl_error = SSL_get_error(ssl_.get(), rv);
diff --git a/net/socket/ssl_server_socket_unittest.cc b/net/socket/ssl_server_socket_unittest.cc
index 185a03ebdb902..da0854979044c 100644
--- a/net/socket/ssl_server_socket_unittest.cc
+++ b/net/socket/ssl_server_socket_unittest.cc
@@ -150,7 +150,8 @@ class FakeDataChannel {
     }
     // This function returns synchronously, so make a copy of the buffer.
     data_.push(base::MakeRefCounted<DrainableIOBuffer>(
-        base::MakeRefCounted<StringIOBuffer>(std::string(buf->data(), buf_len)),
+        base::MakeRefCounted<StringIOBuffer>(
+            std::string(buf->data().data(), buf_len)),
         buf_len));
     base::SingleThreadTaskRunner::GetCurrentDefault()->PostTask(
         FROM_HERE, base::BindOnce(&FakeDataChannel::DoReadCallback,
@@ -200,7 +201,7 @@ class FakeDataChannel {
   int PropagateData(scoped_refptr<IOBuffer> read_buf, int read_buf_len) {
     scoped_refptr<DrainableIOBuffer> buf = data_.front();
     int copied = std::min(buf->BytesRemaining(), read_buf_len);
-    memcpy(read_buf->data(), buf->data(), copied);
+    memcpy(read_buf->data().data(), buf->data().data(), copied);
     buf->DidConsume(copied);
 
     if (!buf->BytesRemaining())
@@ -333,7 +334,7 @@ TEST(FakeSocketTest, DataTransfer) {
       client.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   EXPECT_GT(read, 0);
   EXPECT_LE(read, written);
-  EXPECT_EQ(0, memcmp(kTestData, read_buf->data(), read));
+  EXPECT_EQ(0, memcmp(kTestData, read_buf->data().data(), read));
 
   // Read then write.
   TestCompletionCallback callback;
@@ -349,7 +350,7 @@ TEST(FakeSocketTest, DataTransfer) {
   read = callback.WaitForResult();
   EXPECT_GT(read, 0);
   EXPECT_LE(read, written);
-  EXPECT_EQ(0, memcmp(kTestData, read_buf->data(), read));
+  EXPECT_EQ(0, memcmp(kTestData, read_buf->data().data(), read));
 }
 
 class SSLServerSocketTest : public PlatformTest, public WithTaskEnvironment {
@@ -1055,7 +1056,8 @@ TEST_P(SSLServerSocketReadTest, DataTransfer) {
   }
   EXPECT_EQ(write_buf->size(), read_buf->BytesConsumed());
   read_buf->SetOffset(0);
-  EXPECT_EQ(0, memcmp(write_buf->data(), read_buf->data(), write_buf->size()));
+  EXPECT_EQ(0, memcmp(write_buf->data().data(), read_buf->data().data(),
+                      write_buf->size()));
 
   // Read then write.
   write_buf = base::MakeRefCounted<StringIOBuffer>("hello123");
@@ -1089,7 +1091,8 @@ TEST_P(SSLServerSocketReadTest, DataTransfer) {
   }
   EXPECT_EQ(write_buf->size(), read_buf->BytesConsumed());
   read_buf->SetOffset(0);
-  EXPECT_EQ(0, memcmp(write_buf->data(), read_buf->data(), write_buf->size()));
+  EXPECT_EQ(0, memcmp(write_buf->data().data(), read_buf->data().data(),
+                      write_buf->size()));
 }
 
 // A regression test for bug 127822 (http://crbug.com/127822).
diff --git a/net/socket/tcp_client_socket_unittest.cc b/net/socket/tcp_client_socket_unittest.cc
index 03c1c24fab9b2..5db1fed6c9ac6 100644
--- a/net/socket/tcp_client_socket_unittest.cc
+++ b/net/socket/tcp_client_socket_unittest.cc
@@ -700,7 +700,7 @@ TEST_P(TCPClientSocketTest, SuspendDuringWrite) {
   // Write to the socket until a write doesn't complete synchronously.
   const int kBufferSize = 4096;
   auto write_buffer = base::MakeRefCounted<IOBufferWithSize>(kBufferSize);
-  memset(write_buffer->data(), '1', kBufferSize);
+  memset(write_buffer->data().data(), '1', kBufferSize);
   TestCompletionCallback callback;
   while (true) {
     int rv =
@@ -783,7 +783,7 @@ TEST_P(TCPClientSocketTest, SuspendDuringReadAndWrite) {
     // Write to the socket until a write doesn't complete synchronously.
     const int kBufferSize = 4096;
     auto write_buffer = base::MakeRefCounted<IOBufferWithSize>(kBufferSize);
-    memset(write_buffer->data(), '1', kBufferSize);
+    memset(write_buffer->data().data(), '1', kBufferSize);
     TestCompletionCallback write_callback;
     while (true) {
       int rv = client_socket->Write(write_buffer.get(), kBufferSize,
diff --git a/net/socket/tcp_server_socket_unittest.cc b/net/socket/tcp_server_socket_unittest.cc
index 647417cd2a100..a7ac3df207f59 100644
--- a/net/socket/tcp_server_socket_unittest.cc
+++ b/net/socket/tcp_server_socket_unittest.cc
@@ -331,7 +331,7 @@ TEST_F(TCPServerSocketTest, AcceptIO) {
   while (bytes_written < message.size()) {
     scoped_refptr<IOBufferWithSize> write_buffer =
         base::MakeRefCounted<IOBufferWithSize>(message.size() - bytes_written);
-    memmove(write_buffer->data(), message.data(), message.size());
+    memmove(write_buffer->data().data(), message.data(), message.size());
 
     TestCompletionCallback write_callback;
     int write_result = accepted_socket->Write(
@@ -353,7 +353,7 @@ TEST_F(TCPServerSocketTest, AcceptIO) {
     read_result = read_callback.GetResult(read_result);
     ASSERT_TRUE(read_result >= 0);
     ASSERT_TRUE(bytes_read + read_result <= message.size());
-    memmove(&buffer[bytes_read], read_buffer->data(), read_result);
+    memmove(&buffer[bytes_read], read_buffer->data().data(), read_result);
     bytes_read += read_result;
   }
 
diff --git a/net/socket/tcp_socket_unittest.cc b/net/socket/tcp_socket_unittest.cc
index 617688348a745..1ccc7d85078c2 100644
--- a/net/socket/tcp_socket_unittest.cc
+++ b/net/socket/tcp_socket_unittest.cc
@@ -266,7 +266,7 @@ class TCPSocketTest
 
       scoped_refptr<IOBufferWithSize> write_buffer =
           base::MakeRefCounted<IOBufferWithSize>(message.size());
-      memmove(write_buffer->data(), message.data(), message.size());
+      memmove(write_buffer->data().data(), message.data(), message.size());
 
       TestCompletionCallback write_callback;
       int write_result = accepted_socket->Write(
@@ -543,7 +543,8 @@ void TestReadWrite(std::unique_ptr<TCPSocket> socket1,
     drainable_read_buffer->DidConsume(read_result);
   }
 
-  const std::string received_message(read_buffer->data(), read_buffer->size());
+  const std::string received_message(read_buffer->data().data(),
+                                     read_buffer->size());
   EXPECT_EQ(message, received_message);
 }
 
@@ -610,7 +611,7 @@ TEST_P(TCPSocketTest, DestroyWithPendingWrite) {
   scoped_refptr<IOBufferWithDestructionCallback> write_buffer(
       base::MakeRefCounted<IOBufferWithDestructionCallback>(
           run_loop.QuitClosure()));
-  memset(write_buffer->data(), '1', write_buffer->size());
+  memset(write_buffer->data().data(), '1', write_buffer->size());
   TestCompletionCallback write_callback;
   while (true) {
     int result = connecting_socket->Write(
diff --git a/net/socket/transport_client_socket_test_util.cc b/net/socket/transport_client_socket_test_util.cc
index 3045a4ae8f16e..ce1ce20c8e546 100644
--- a/net/socket/transport_client_socket_test_util.cc
+++ b/net/socket/transport_client_socket_test_util.cc
@@ -29,7 +29,7 @@ void SendRequestAndResponse(StreamSocket* socket,
   scoped_refptr<DrainableIOBuffer> request_buffer =
       base::MakeRefCounted<DrainableIOBuffer>(
           base::MakeRefCounted<IOBufferWithSize>(request_len), request_len);
-  memcpy(request_buffer->data(), request_text, request_len);
+  memcpy(request_buffer->data().data(), request_text, request_len);
 
   int bytes_written = 0;
   while (request_buffer->BytesRemaining() > 0) {
@@ -72,7 +72,7 @@ std::string ReadDataOfExpectedLength(StreamSocket* socket,
     bytes_read += rv;
   }
   EXPECT_EQ(expected_bytes_read, bytes_read);
-  return std::string(read_buffer->data(), bytes_read);
+  return std::string(read_buffer->data().data(), bytes_read);
 }
 
 void SendServerResponse(StreamSocket* socket) {
@@ -81,7 +81,7 @@ void SendServerResponse(StreamSocket* socket) {
   scoped_refptr<DrainableIOBuffer> write_buffer =
       base::MakeRefCounted<DrainableIOBuffer>(
           base::MakeRefCounted<IOBufferWithSize>(reply_len), reply_len);
-  memcpy(write_buffer->data(), kServerReply, reply_len);
+  memcpy(write_buffer->data().data(), kServerReply, reply_len);
   int bytes_written = 0;
   while (write_buffer->BytesRemaining() > 0) {
     TestCompletionCallback write_callback;
diff --git a/net/socket/transport_client_socket_unittest.cc b/net/socket/transport_client_socket_unittest.cc
index 13b8747cabe18..bc768b80baf78 100644
--- a/net/socket/transport_client_socket_unittest.cc
+++ b/net/socket/transport_client_socket_unittest.cc
@@ -212,7 +212,8 @@ TEST_F(TransportClientSocketTest, Read) {
   uint32_t bytes_read = DrainStreamSocket(sock_.get(), buf.get(), 4096,
                                           strlen(kServerReply), &callback);
   ASSERT_EQ(bytes_read, strlen(kServerReply));
-  ASSERT_EQ(std::string(kServerReply), std::string(buf->data(), bytes_read));
+  ASSERT_EQ(std::string(kServerReply),
+            std::string(buf->data().data(), bytes_read));
 
   // All data has been read now.  Read once more to force an ERR_IO_PENDING, and
   // then close the server socket, and note the close.
diff --git a/net/socket/udp_socket_perftest.cc b/net/socket/udp_socket_perftest.cc
index 80489dcbbfac7..e67403750d764 100644
--- a/net/socket/udp_socket_perftest.cc
+++ b/net/socket/udp_socket_perftest.cc
@@ -89,7 +89,7 @@ void UDPSocketPerfTest::WritePacketsToSocket(UDPClientSocket* socket,
                                              base::OnceClosure* done_callback) {
   scoped_refptr<IOBufferWithSize> io_buffer =
       base::MakeRefCounted<IOBufferWithSize>(kPacketSize);
-  memset(io_buffer->data(), 'G', kPacketSize);
+  memset(io_buffer->data().data(), 'G', kPacketSize);
 
   while (num_of_packets) {
     int rv = socket->Write(
diff --git a/net/socket/udp_socket_posix.cc b/net/socket/udp_socket_posix.cc
index ec18b9310e49b..8e708cd5f673a 100644
--- a/net/socket/udp_socket_posix.cc
+++ b/net/socket/udp_socket_posix.cc
@@ -709,7 +709,8 @@ int UDPSocketPosix::InternalRecvFromConnectedSocket(IOBuffer* buf,
   DCHECK(is_connected_);
   DCHECK(remote_address_);
   int result;
-  int bytes_transferred = HANDLE_EINTR(read(socket_, buf->data(), buf_len));
+  int bytes_transferred =
+      HANDLE_EINTR(read(socket_, buf->data().data(), buf_len));
   if (bytes_transferred < 0) {
     result = MapSystemError(errno);
     if (result == ERR_IO_PENDING) {
@@ -812,8 +813,8 @@ int UDPSocketPosix::InternalSendTo(IOBuffer* buf,
     }
   }
 
-  int result = HANDLE_EINTR(sendto(socket_, buf->data(), buf_len, sendto_flags_,
-                                   addr, storage.addr_len));
+  int result = HANDLE_EINTR(sendto(socket_, buf->data().data(), buf_len,
+                                   sendto_flags_, addr, storage.addr_len));
   if (result < 0)
     result = MapSystemError(errno);
   if (result != ERR_IO_PENDING)
diff --git a/net/socket/udp_socket_unittest.cc b/net/socket/udp_socket_unittest.cc
index 274f6f0b5f588..03b17aa6f6c59 100644
--- a/net/socket/udp_socket_unittest.cc
+++ b/net/socket/udp_socket_unittest.cc
@@ -110,7 +110,7 @@ class UDPSocketTest : public PlatformTest, public WithTaskEnvironment {
     EXPECT_EQ(socket->GetLastTos().dscp, dscp);
 #endif
     EXPECT_EQ(socket->GetLastTos().ecn, ecn);
-    return std::string(buffer_->data(), rv);
+    return std::string(buffer_->data().data(), rv);
   }
 
   // Sends UDP packet.
@@ -153,7 +153,7 @@ class UDPSocketTest : public PlatformTest, public WithTaskEnvironment {
     EXPECT_EQ(socket->GetLastTos().dscp, dscp);
 #endif
     EXPECT_EQ(socket->GetLastTos().ecn, ecn);
-    return std::string(buffer_->data(), rv);
+    return std::string(buffer_->data().data(), rv);
   }
 
   // Writes specified message to the socket.
@@ -266,7 +266,7 @@ void UDPSocketTest::ConnectTest(bool use_nonblocking_io, bool use_async) {
                      base::Unretained(this), client.get(), simple_message));
   run_loop.Run();
   EXPECT_EQ(simple_message.length(), static_cast<size_t>(read_result));
-  EXPECT_EQ(simple_message, std::string(buffer_->data(), read_result));
+  EXPECT_EQ(simple_message, std::string(buffer_->data().data(), read_result));
 
   NetLogSource server_net_log_source = server->NetLog().source();
   NetLogSource client_net_log_source = client->NetLog().source();
@@ -1787,7 +1787,7 @@ TEST_F(UDPSocketTest, ReadWithSocketOptimizationTruncation) {
   rv = client.Read(buffer_.get(), kMaxRead, callback.callback());
   rv = callback.GetResult(rv);
   EXPECT_EQ(static_cast<int>(right_length_message.length()), rv);
-  EXPECT_EQ(right_length_message, std::string(buffer_->data(), rv));
+  EXPECT_EQ(right_length_message, std::string(buffer_->data().data(), rv));
   EXPECT_EQ(client.GetLastTos().dscp, DSCP_DEFAULT);
   EXPECT_EQ(client.GetLastTos().ecn, ECN_DEFAULT);
 
diff --git a/net/socket/unix_domain_client_socket_posix_unittest.cc b/net/socket/unix_domain_client_socket_posix_unittest.cc
index f4d0e2a3daaf3..630533e826d78 100644
--- a/net/socket/unix_domain_client_socket_posix_unittest.cc
+++ b/net/socket/unix_domain_client_socket_posix_unittest.cc
@@ -368,8 +368,8 @@ TEST_F(UnixDomainClientSocketTest, ReadAfterWrite) {
                               read_buffer.get(),
                               kReadBufferSize,
                               kWriteDataSize));
-  EXPECT_EQ(std::string(write_buffer->data(), kWriteDataSize),
-            std::string(read_buffer->data(), kWriteDataSize));
+  EXPECT_EQ(std::string(write_buffer->data().data(), kWriteDataSize),
+            std::string(read_buffer->data().data(), kWriteDataSize));
 
   // Send data from server and client.
   EXPECT_EQ(kWriteDataSize,
@@ -383,8 +383,8 @@ TEST_F(UnixDomainClientSocketTest, ReadAfterWrite) {
                               read_buffer.get(),
                               kSmallReadBufferSize,
                               kSmallReadBufferSize));
-  EXPECT_EQ(std::string(write_buffer->data(), kSmallReadBufferSize),
-            std::string(read_buffer->data(), kSmallReadBufferSize));
+  EXPECT_EQ(std::string(write_buffer->data().data(), kSmallReadBufferSize),
+            std::string(read_buffer->data().data(), kSmallReadBufferSize));
 
   EXPECT_EQ(kWriteDataSize - kSmallReadBufferSize,
             ReadSynchronously(&client_socket,
@@ -393,7 +393,7 @@ TEST_F(UnixDomainClientSocketTest, ReadAfterWrite) {
                               kWriteDataSize - kSmallReadBufferSize));
   EXPECT_EQ(std::string(write_buffer->data() + kSmallReadBufferSize,
                         kWriteDataSize - kSmallReadBufferSize),
-            std::string(read_buffer->data(),
+            std::string(read_buffer->data().data(),
                         kWriteDataSize - kSmallReadBufferSize));
 
   // No more data.
diff --git a/net/spdy/bidirectional_stream_spdy_impl.cc b/net/spdy/bidirectional_stream_spdy_impl.cc
index 85b3291d01f52..708bcd42a4346 100644
--- a/net/spdy/bidirectional_stream_spdy_impl.cc
+++ b/net/spdy/bidirectional_stream_spdy_impl.cc
@@ -138,8 +138,8 @@ void BidirectionalStreamSpdyImpl::SendvData(
     int len = 0;
     // TODO(xunjieli): Get rid of extra copy. Coalesce headers and data frames.
     for (size_t i = 0; i < buffers.size(); ++i) {
-      memcpy(pending_combined_buffer_->data() + len, buffers[i]->data(),
-             lengths[i]);
+      memcpy(pending_combined_buffer_->data().subspan(len).data(),
+             buffers[i]->data().data(), lengths[i]);
       len += lengths[i];
     }
   }
diff --git a/net/spdy/bidirectional_stream_spdy_impl_unittest.cc b/net/spdy/bidirectional_stream_spdy_impl_unittest.cc
index 92746178a2434..ae857d3b339b9 100644
--- a/net/spdy/bidirectional_stream_spdy_impl_unittest.cc
+++ b/net/spdy/bidirectional_stream_spdy_impl_unittest.cc
@@ -108,7 +108,7 @@ class TestDelegateBase : public BidirectionalStreamImpl::Delegate {
     on_data_read_count_++;
     CHECK_GE(bytes_read, OK);
     bytes_read_ += bytes_read;
-    data_received_.append(read_buf_->data(), bytes_read);
+    data_received_.append(read_buf_->data().data(), bytes_read);
     if (!do_not_start_read_)
       StartOrContinueReading();
   }
@@ -181,7 +181,7 @@ class TestDelegateBase : public BidirectionalStreamImpl::Delegate {
   int ReadData() {
     int rv = stream_->ReadData(read_buf_.get(), read_buf_len_);
     if (rv > 0) {
-      data_received_.append(read_buf_->data(), rv);
+      data_received_.append(read_buf_->data().data(), rv);
       bytes_read_ += rv;
     }
     return rv;
diff --git a/net/spdy/spdy_buffer_unittest.cc b/net/spdy/spdy_buffer_unittest.cc
index 70e29f2364eee..771206b7be9f3 100644
--- a/net/spdy/spdy_buffer_unittest.cc
+++ b/net/spdy/spdy_buffer_unittest.cc
@@ -119,10 +119,12 @@ TEST_F(SpdyBufferTest, GetIOBufferForRemainingData) {
   scoped_refptr<IOBuffer> io_buffer = buffer.GetIOBufferForRemainingData();
   size_t io_buffer_size = buffer.GetRemainingSize();
   const std::string expectedData(kData + 5, kDataSize - 5);
-  EXPECT_EQ(expectedData, std::string(io_buffer->data(), io_buffer_size));
+  EXPECT_EQ(expectedData,
+            std::string(io_buffer->data().data(), io_buffer_size));
 
   buffer.Consume(kDataSize - 5);
-  EXPECT_EQ(expectedData, std::string(io_buffer->data(), io_buffer_size));
+  EXPECT_EQ(expectedData,
+            std::string(io_buffer->data().data(), io_buffer_size));
 }
 
 // Make sure the IOBuffer returned by GetIOBufferForRemainingData()
@@ -134,7 +136,7 @@ TEST_F(SpdyBufferTest, IOBufferForRemainingDataOutlivesBuffer) {
 
   // This will cause a use-after-free error if |io_buffer| doesn't
   // outlive |buffer|.
-  std::memcpy(io_buffer->data(), kData, kDataSize);
+  std::memcpy(io_buffer->data().data(), kData, kDataSize);
 }
 
 }  // namespace
diff --git a/net/spdy/spdy_http_stream_unittest.cc b/net/spdy/spdy_http_stream_unittest.cc
index b0a2fc07bb7ef..b5ae0a3aae00f 100644
--- a/net/spdy/spdy_http_stream_unittest.cc
+++ b/net/spdy/spdy_http_stream_unittest.cc
@@ -695,21 +695,21 @@ TEST_F(SpdyHttpStreamTest, DelayedSendChunkedPost) {
   ASSERT_EQ(kUploadDataSize,
             http_stream->ReadResponseBody(
                 buf1.get(), kUploadDataSize, callback.callback()));
-  EXPECT_EQ(kUploadData, std::string(buf1->data(), kUploadDataSize));
+  EXPECT_EQ(kUploadData, std::string(buf1->data().data(), kUploadDataSize));
 
   // Check |chunk2| response.
   auto buf2 = base::MakeRefCounted<IOBufferWithSize>(kUploadData1Size);
   ASSERT_EQ(kUploadData1Size,
             http_stream->ReadResponseBody(
                 buf2.get(), kUploadData1Size, callback.callback()));
-  EXPECT_EQ(kUploadData1, std::string(buf2->data(), kUploadData1Size));
+  EXPECT_EQ(kUploadData1, std::string(buf2->data().data(), kUploadData1Size));
 
   // Check |chunk3| response.
   auto buf3 = base::MakeRefCounted<IOBufferWithSize>(kUploadDataSize);
   ASSERT_EQ(kUploadDataSize,
             http_stream->ReadResponseBody(
                 buf3.get(), kUploadDataSize, callback.callback()));
-  EXPECT_EQ(kUploadData, std::string(buf3->data(), kUploadDataSize));
+  EXPECT_EQ(kUploadData, std::string(buf3->data().data(), kUploadDataSize));
 
   ASSERT_TRUE(response.headers.get());
   ASSERT_EQ(200, response.headers->response_code());
@@ -797,7 +797,7 @@ TEST_F(SpdyHttpStreamTest, DelayedSendChunkedPostWithEmptyFinalDataFrame) {
   ASSERT_EQ(kUploadDataSize,
             http_stream->ReadResponseBody(
                 buf1.get(), kUploadDataSize, callback.callback()));
-  EXPECT_EQ(kUploadData, std::string(buf1->data(), kUploadDataSize));
+  EXPECT_EQ(kUploadData, std::string(buf1->data().data(), kUploadDataSize));
 
   // Check |chunk2| response.
   ASSERT_EQ(0,
@@ -1029,7 +1029,7 @@ TEST_F(SpdyHttpStreamTest, DelayedSendChunkedPostWithWindowUpdate) {
   ASSERT_EQ(kUploadDataSize,
             http_stream->ReadResponseBody(
                 buf1.get(), kUploadDataSize, callback.callback()));
-  EXPECT_EQ(kUploadData, std::string(buf1->data(), kUploadDataSize));
+  EXPECT_EQ(kUploadData, std::string(buf1->data().data(), kUploadDataSize));
 
   ASSERT_TRUE(response.headers.get());
   ASSERT_EQ(200, response.headers->response_code());
diff --git a/net/spdy/spdy_network_transaction_unittest.cc b/net/spdy/spdy_network_transaction_unittest.cc
index 5245da9f9ddbd..d3a1ca53ea765 100644
--- a/net/spdy/spdy_network_transaction_unittest.cc
+++ b/net/spdy/spdy_network_transaction_unittest.cc
@@ -463,7 +463,7 @@ class SpdyNetworkTransactionTest
       } else if (rv <= 0) {
         break;
       }
-      result->append(buf->data(), rv);
+      result->append(buf->data().data(), rv);
       bytes_read += rv;
     }
     return bytes_read;
@@ -3834,7 +3834,7 @@ TEST_P(SpdyNetworkTransactionTest, BufferFull) {
       rv = read_callback.WaitForResult();
     }
     if (rv > 0) {
-      content.append(buf->data(), rv);
+      content.append(buf->data().data(), rv);
     } else if (rv < 0) {
       NOTREACHED();
     }
@@ -3915,7 +3915,7 @@ TEST_P(SpdyNetworkTransactionTest, Buffering) {
     }
     if (rv > 0) {
       EXPECT_EQ(kSmallReadSize, rv);
-      content.append(buf->data(), rv);
+      content.append(buf->data().data(), rv);
     } else if (rv < 0) {
       FAIL() << "Unexpected read error: " << rv;
     }
@@ -3991,7 +3991,7 @@ TEST_P(SpdyNetworkTransactionTest, BufferedAll) {
     rv = trans->Read(buf.get(), kSmallReadSize, read_callback.callback());
     if (rv > 0) {
       EXPECT_EQ(kSmallReadSize, rv);
-      content.append(buf->data(), rv);
+      content.append(buf->data().data(), rv);
     } else if (rv < 0) {
       FAIL() << "Unexpected read error: " << rv;
     }
@@ -5916,7 +5916,7 @@ TEST_P(SpdyNetworkTransactionTest, WindowUpdateSent) {
             trans->Read(buf.get(), kTargetSize, CompletionOnceCallback()));
   EXPECT_EQ(static_cast<int>(stream_max_recv_window_size),
             stream->stream()->recv_window_size());
-  EXPECT_THAT(std::string_view(buf->data(), kTargetSize), Each(Eq('x')));
+  EXPECT_THAT(std::string_view(buf->data().data(), kTargetSize), Each(Eq('x')));
 
   // Allow scheduled WINDOW_UPDATE frames to write.
   base::RunLoop().RunUntilIdle();
diff --git a/net/spdy/spdy_proxy_client_socket_unittest.cc b/net/spdy/spdy_proxy_client_socket_unittest.cc
index 5626baf533f96..c3791e5a001ff 100644
--- a/net/spdy/spdy_proxy_client_socket_unittest.cc
+++ b/net/spdy/spdy_proxy_client_socket_unittest.cc
@@ -307,7 +307,7 @@ scoped_refptr<IOBufferWithSize> SpdyProxyClientSocketTest::CreateBuffer(
     const char* data, int size) {
   scoped_refptr<IOBufferWithSize> buf =
       base::MakeRefCounted<IOBufferWithSize>(size);
-  memcpy(buf->data(), data, size);
+  memcpy(buf->data().data(), data, size);
   return buf;
 }
 
@@ -344,7 +344,7 @@ void SpdyProxyClientSocketTest::AssertSyncReadEquals(const char* data,
   } else {
     ASSERT_EQ(len, sock_->Read(buf.get(), len, CompletionOnceCallback()));
   }
-  ASSERT_EQ(std::string(data, len), std::string(buf->data(), len));
+  ASSERT_EQ(std::string(data, len), std::string(buf->data().data(), len));
   ASSERT_TRUE(sock_->IsConnected());
 }
 
@@ -386,7 +386,7 @@ void SpdyProxyClientSocketTest::AssertAsyncReadEquals(const char* data,
     EXPECT_TRUE(sock_->IsConnected());
   }
 
-  ASSERT_EQ(std::string(data, len), std::string(buf->data(), len));
+  ASSERT_EQ(std::string(data, len), std::string(buf->data().data(), len));
 }
 
 void SpdyProxyClientSocketTest::AssertReadStarts(const char* data, int len) {
@@ -413,7 +413,7 @@ void SpdyProxyClientSocketTest::AssertReadReturns(const char* data, int len) {
   } else {
     EXPECT_EQ(len, read_callback_.WaitForResult());
   }
-  ASSERT_EQ(std::string(data, len), std::string(read_buf_->data(), len));
+  ASSERT_EQ(std::string(data, len), std::string(read_buf_->data().data(), len));
 }
 
 void SpdyProxyClientSocketTest::AssertAsyncWriteSucceeds(const char* data,
@@ -1227,7 +1227,7 @@ TEST_P(SpdyProxyClientSocketTest, ReadOnClosedSocketReturnsBufferedData) {
   ASSERT_FALSE(sock_->IsConnected());
   auto buf = base::MakeRefCounted<IOBufferWithSize>(kLen1);
   ASSERT_EQ(kLen1, sock_->Read(buf.get(), kLen1, CompletionOnceCallback()));
-  ASSERT_EQ(std::string(kMsg1, kLen1), std::string(buf->data(), kLen1));
+  ASSERT_EQ(std::string(kMsg1, kLen1), std::string(buf->data().data(), kLen1));
 
   ASSERT_EQ(0, sock_->Read(nullptr, 1, CompletionOnceCallback()));
   ASSERT_EQ(0, sock_->Read(nullptr, 1, CompletionOnceCallback()));
diff --git a/net/test/embedded_test_server/http1_connection.cc b/net/test/embedded_test_server/http1_connection.cc
index 2355c7f956487..7b2121be8e783 100644
--- a/net/test/embedded_test_server/http1_connection.cc
+++ b/net/test/embedded_test_server/http1_connection.cc
@@ -78,7 +78,7 @@ bool Http1Connection::HandleReadResult(int rv) {
   if (connection_listener_)
     connection_listener_->ReadFromSocket(*socket_, rv);
 
-  request_parser_.ProcessChunk(std::string_view(read_buf_->data(), rv));
+  request_parser_.ProcessChunk(std::string_view(read_buf_->data().data(), rv));
   if (request_parser_.ParseRequest() != HttpRequestParser::ACCEPTED)
     return false;
 
diff --git a/net/test/embedded_test_server/http2_connection.cc b/net/test/embedded_test_server/http2_connection.cc
index ab8440af166c8..9ca59fbf1105d 100644
--- a/net/test/embedded_test_server/http2_connection.cc
+++ b/net/test/embedded_test_server/http2_connection.cc
@@ -230,7 +230,7 @@ bool Http2Connection::HandleData(int rv) {
   if (connection_listener_)
     connection_listener_->ReadFromSocket(*socket_, rv);
 
-  std::string_view remaining_buffer(read_buf_->data(), rv);
+  std::string_view remaining_buffer(read_buf_->data().data(), rv);
   while (!remaining_buffer.empty()) {
     int result = adapter_->ProcessBytes(remaining_buffer);
     if (result < 0)
diff --git a/net/test/test_doh_server.cc b/net/test/test_doh_server.cc
index 9ea8373e77c1f..6fcd4cb7a00ba 100644
--- a/net/test/test_doh_server.cc
+++ b/net/test/test_doh_server.cc
@@ -189,7 +189,7 @@ std::unique_ptr<test_server::HttpResponse> TestDohServer::HandleRequest(
 
   // Parse the DNS query.
   auto query_buf = base::MakeRefCounted<IOBufferWithSize>(query.size());
-  memcpy(query_buf->data(), query.data(), query.size());
+  memcpy(query_buf->data().data(), query.data(), query.size());
   DnsQuery dns_query(std::move(query_buf));
   if (!dns_query.Parse(query.size())) {
     return MakeHttpErrorResponse(HTTP_BAD_REQUEST, "invalid DNS query");
diff --git a/net/test/url_request/url_request_mock_data_job.cc b/net/test/url_request/url_request_mock_data_job.cc
index c808008ff24fc..d9a9094a36f9b 100644
--- a/net/test/url_request/url_request_mock_data_job.cc
+++ b/net/test/url_request/url_request_mock_data_job.cc
@@ -129,7 +129,7 @@ void URLRequestMockDataJob::Start() {
 int URLRequestMockDataJob::ReadRawData(IOBuffer* buf, int buf_size) {
   int bytes_read =
       std::min(static_cast<size_t>(buf_size), data_.length() - data_offset_);
-  memcpy(buf->data(), data_.c_str() + data_offset_, bytes_read);
+  memcpy(buf->data().data(), data_.c_str() + data_offset_, bytes_read);
   data_offset_ += bytes_read;
   return bytes_read;
 }
diff --git a/net/test/url_request/url_request_test_job_backed_by_file_unittest.cc b/net/test/url_request/url_request_test_job_backed_by_file_unittest.cc
index 23ecaa166c375..97f3dee5533f3 100644
--- a/net/test/url_request/url_request_test_job_backed_by_file_unittest.cc
+++ b/net/test/url_request/url_request_test_job_backed_by_file_unittest.cc
@@ -77,7 +77,7 @@ class TestURLRequestTestJobBackedByFile : public URLRequestTestJobBackedByFile {
   void OnReadComplete(IOBuffer* buf, int result) override {
     // Should only call this if seek succeeded.
     EXPECT_GE(*seek_position_, 0);
-    observed_content_->append(std::string(buf->data(), result));
+    observed_content_->append(std::string(buf->data().data(), result));
   }
 
   void DoneReading() override { *done_reading_ = true; }
diff --git a/net/tools/cachetool/cachetool.cc b/net/tools/cachetool/cachetool.cc
index 9bd8e760338e0..0bdc9b47e42be 100644
--- a/net/tools/cachetool/cachetool.cc
+++ b/net/tools/cachetool/cachetool.cc
@@ -409,7 +409,7 @@ std::string GetMD5ForResponseBody(disk_cache::Entry* entry) {
     }
 
     bytes_read += rv;
-    base::MD5Update(&ctx, std::string_view(buffer->data(), rv));
+    base::MD5Update(&ctx, std::string_view(buffer->data().data(), rv));
   }
 
   NOTREACHED();
diff --git a/net/tools/content_decoder_tool/content_decoder_tool.cc b/net/tools/content_decoder_tool/content_decoder_tool.cc
index fd00e8eccc8e3..3cf044332605d 100644
--- a/net/tools/content_decoder_tool/content_decoder_tool.cc
+++ b/net/tools/content_decoder_tool/content_decoder_tool.cc
@@ -45,7 +45,7 @@ class StdinSourceStream : public SourceStream {
     if (input_stream_->eof())
       return OK;
     if (input_stream_) {
-      input_stream_->read(dest_buffer->data(), buffer_size);
+      input_stream_->read(dest_buffer->data().data(), buffer_size);
       int bytes = input_stream_->gcount();
       return bytes;
     }
@@ -106,7 +106,7 @@ bool ContentDecoderToolProcessInput(std::vector<std::string> content_encodings,
       LOG(ERROR) << "Couldn't decode stdin.";
       return false;
     }
-    output_stream->write(read_buffer->data(), bytes_read);
+    output_stream->write(read_buffer->data().data(), bytes_read);
     // If EOF is read, break out the while loop.
     if (bytes_read == 0)
       break;
diff --git a/net/tools/quic/quic_simple_server.cc b/net/tools/quic/quic_simple_server.cc
index a818e154d8a6a..f9d5bdad05b92 100644
--- a/net/tools/quic/quic_simple_server.cc
+++ b/net/tools/quic/quic_simple_server.cc
@@ -177,7 +177,7 @@ void QuicSimpleServer::OnReadComplete(int result) {
   read_pending_ = false;
 
   if (result > 0) {
-    quic::QuicReceivedPacket packet(read_buffer_->data(), result,
+    quic::QuicReceivedPacket packet(read_buffer_->data().data(), result,
                                     helper_->GetClock()->Now(), false);
     dispatcher_->ProcessPacket(ToQuicSocketAddress(server_address_),
                                ToQuicSocketAddress(client_address_), packet);
diff --git a/net/tools/stress_cache/stress_cache.cc b/net/tools/stress_cache/stress_cache.cc
index f4845d2f1e8be..76dc172bba9db 100644
--- a/net/tools/stress_cache/stress_cache.cc
+++ b/net/tools/stress_cache/stress_cache.cc
@@ -132,7 +132,7 @@ class EntryWrapper {
  public:
   EntryWrapper() {
     buffer_ = base::MakeRefCounted<net::IOBufferWithSize>(kBufferSize);
-    memset(buffer_->data(), 'k', kBufferSize);
+    memset(buffer_->data().data(), 'k', kBufferSize);
   }
 
   Operation state() const { return state_; }
@@ -202,7 +202,7 @@ void EntryWrapper::DoRead() {
     return DoWrite();
 
   state_ = READ;
-  memset(buffer_->data(), 'k', kReadSize);
+  memset(buffer_->data().data(), 'k', kReadSize);
   int rv = entry_->ReadData(
       0, 0, buffer_.get(), kReadSize,
       base::BindOnce(&EntryWrapper::OnReadDone, base::Unretained(this)));
@@ -213,7 +213,7 @@ void EntryWrapper::DoRead() {
 void EntryWrapper::OnReadDone(int result) {
   DCHECK_EQ(state_, READ);
   CHECK_EQ(result, kReadSize);
-  CHECK_EQ(0, memcmp(buffer_->data(), "Write: ", 7));
+  CHECK_EQ(0, memcmp(buffer_->data().data(), "Write: ", 7));
   DoWrite();
 }
 
diff --git a/net/url_request/url_request.cc b/net/url_request/url_request.cc
index b47bb68341ca4..3a9ecf0729809 100644
--- a/net/url_request/url_request.cc
+++ b/net/url_request/url_request.cc
@@ -834,7 +834,7 @@ int URLRequest::Read(IOBuffer* dest, int dest_size) {
   }
 
   // Caller should provide a buffer.
-  DCHECK(dest && dest->data());
+  DCHECK(dest && !dest->data().empty());
 
   int rv = job_->Read(dest, dest_size);
   if (rv == ERR_IO_PENDING) {
diff --git a/net/url_request/url_request_test_job.cc b/net/url_request/url_request_test_job.cc
index 51a373d665f5d..c69d17e74f034 100644
--- a/net/url_request/url_request_test_job.cc
+++ b/net/url_request/url_request_test_job.cc
@@ -217,7 +217,7 @@ int URLRequestTestJob::CopyDataForRead(IOBuffer* buf, int buf_size) {
     if (bytes_read + offset_ > static_cast<int>(response_data_.length()))
       bytes_read = static_cast<int>(response_data_.length()) - offset_;
 
-    memcpy(buf->data(), &response_data_.c_str()[offset_], bytes_read);
+    memcpy(buf->data().data(), &response_data_.c_str()[offset_], bytes_read);
     offset_ += bytes_read;
   }
   return bytes_read;
diff --git a/net/url_request/url_request_test_util.cc b/net/url_request/url_request_test_util.cc
index 424b87537c3f8..483b7464aa1ce 100644
--- a/net/url_request/url_request_test_util.cc
+++ b/net/url_request/url_request_test_util.cc
@@ -266,7 +266,7 @@ void TestDelegate::OnReadCompleted(URLRequest* request, int bytes_read) {
     received_bytes_count_ += bytes_read;
 
     // Consume the data.
-    data_received_.append(buf_->data(), bytes_read);
+    data_received_.append(buf_->data().data(), bytes_read);
 
     if (cancel_in_rd_) {
       request_status_ = request->Cancel();
@@ -282,7 +282,7 @@ void TestDelegate::OnReadCompleted(URLRequest* request, int bytes_read) {
   while (bytes_read > 0) {
     bytes_read = request->Read(buf_.get(), kBufferSize);
     if (bytes_read > 0) {
-      data_received_.append(buf_->data(), bytes_read);
+      data_received_.append(buf_->data().data(), bytes_read);
       received_bytes_count_ += bytes_read;
     }
   }
diff --git a/net/websockets/websocket_basic_stream_adapters_test.cc b/net/websockets/websocket_basic_stream_adapters_test.cc
index 23bf8a53141ce..1c019dc74d8e2 100644
--- a/net/websockets/websocket_basic_stream_adapters_test.cc
+++ b/net/websockets/websocket_basic_stream_adapters_test.cc
@@ -218,14 +218,14 @@ TEST_F(WebSocketClientSocketHandleAdapterTest, Read) {
   auto read_buf = base::MakeRefCounted<IOBufferWithSize>(kReadBufSize);
   int rv = adapter.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("foo", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("foo", std::string_view(read_buf->data().data(), rv));
 
   TestCompletionCallback callback;
   rv = adapter.Read(read_buf.get(), kReadBufSize, callback.callback());
   EXPECT_THAT(rv, IsError(ERR_IO_PENDING));
   rv = callback.WaitForResult();
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("bar", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("bar", std::string_view(read_buf->data().data(), rv));
 
   EXPECT_TRUE(data.AllReadDataConsumed());
   EXPECT_TRUE(data.AllWriteDataConsumed());
@@ -249,22 +249,22 @@ TEST_F(WebSocketClientSocketHandleAdapterTest, ReadIntoSmallBuffer) {
   auto read_buf = base::MakeRefCounted<IOBufferWithSize>(kReadBufSize);
   int rv = adapter.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(2, rv);
-  EXPECT_EQ("fo", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("fo", std::string_view(read_buf->data().data(), rv));
 
   rv = adapter.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(1, rv);
-  EXPECT_EQ("o", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("o", std::string_view(read_buf->data().data(), rv));
 
   TestCompletionCallback callback1;
   rv = adapter.Read(read_buf.get(), kReadBufSize, callback1.callback());
   EXPECT_THAT(rv, IsError(ERR_IO_PENDING));
   rv = callback1.WaitForResult();
   ASSERT_EQ(2, rv);
-  EXPECT_EQ("ba", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("ba", std::string_view(read_buf->data().data(), rv));
 
   rv = adapter.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(1, rv);
-  EXPECT_EQ("r", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("r", std::string_view(read_buf->data().data(), rv));
 
   EXPECT_TRUE(data.AllReadDataConsumed());
   EXPECT_TRUE(data.AllWriteDataConsumed());
@@ -331,7 +331,7 @@ TEST_F(WebSocketClientSocketHandleAdapterTest, AsyncReadAndWrite) {
 
   rv = read_callback.WaitForResult();
   ASSERT_EQ(6, rv);
-  EXPECT_EQ("foobar", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("foobar", std::string_view(read_buf->data().data(), rv));
 
   rv = write_callback.WaitForResult();
   ASSERT_EQ(3, rv);
@@ -782,7 +782,7 @@ TEST_F(WebSocketSpdyStreamAdapterTest, Read) {
   EXPECT_THAT(rv, IsError(ERR_IO_PENDING));
   rv = callback.WaitForResult();
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("foo", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("foo", std::string_view(read_buf->data().data(), rv));
 
   // Read EOF to destroy the connection and the stream.
   // This calls SpdySession::Delegate::OnClose().
@@ -795,11 +795,11 @@ TEST_F(WebSocketSpdyStreamAdapterTest, Read) {
   // Two socket reads are concatenated by WebSocketSpdyStreamAdapter.
   rv = adapter.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("bar", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("bar", std::string_view(read_buf->data().data(), rv));
 
   rv = adapter.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("baz", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("baz", std::string_view(read_buf->data().data(), rv));
 
   // Even though connection and stream are already closed,
   // WebSocketSpdyStreamAdapter::Delegate::OnClose() is only called after all
@@ -852,7 +852,7 @@ TEST_F(WebSocketSpdyStreamAdapterTest, CallDelegateOnCloseShouldNotCrash) {
   EXPECT_THAT(rv, IsError(ERR_IO_PENDING));
   rv = callback.WaitForResult();
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("foo", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("foo", std::string_view(read_buf->data().data(), rv));
 
   // Read RST_STREAM to destroy the stream.
   // This calls SpdySession::Delegate::OnClose().
@@ -865,7 +865,7 @@ TEST_F(WebSocketSpdyStreamAdapterTest, CallDelegateOnCloseShouldNotCrash) {
   // Read remaining buffered data.  This will PostTask CallDelegateOnClose().
   rv = adapter.Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("bar", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("bar", std::string_view(read_buf->data().data(), rv));
 
   adapter.DetachDelegate();
 
@@ -961,7 +961,7 @@ TEST_F(WebSocketSpdyStreamAdapterTest, AsyncReadAndWrite) {
 
   rv = read_callback.WaitForResult();
   ASSERT_EQ(6, rv);
-  EXPECT_EQ("foobar", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("foobar", std::string_view(read_buf->data().data(), rv));
 
   rv = write_callback.WaitForResult();
   ASSERT_EQ(3, rv);
@@ -1634,11 +1634,11 @@ TEST_P(WebSocketQuicStreamAdapterTest, Read) {
 
   rv = read_callback.WaitForResult();
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("foo", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("foo", std::string_view(read_buf->data().data(), rv));
 
   rv = adapter->Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(8, rv);
-  EXPECT_EQ("hogehoge", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("hogehoge", std::string_view(read_buf->data().data(), rv));
 
   adapter->Disconnect();
 
@@ -1716,15 +1716,15 @@ TEST_P(WebSocketQuicStreamAdapterTest, ReadIntoSmallBuffer) {
 
   rv = read_callback.WaitForResult();
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("abc", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("abc", std::string_view(read_buf->data().data(), rv));
 
   rv = adapter->Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("12A", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("12A", std::string_view(read_buf->data().data(), rv));
 
   rv = adapter->Read(read_buf.get(), kReadBufSize, CompletionOnceCallback());
   ASSERT_EQ(3, rv);
-  EXPECT_EQ("BCD", std::string_view(read_buf->data(), rv));
+  EXPECT_EQ("BCD", std::string_view(read_buf->data().data(), rv));
 
   adapter->Disconnect();
 
diff --git a/net/websockets/websocket_basic_stream_test.cc b/net/websockets/websocket_basic_stream_test.cc
index 71059134ac541..242ff6c40e9bb 100644
--- a/net/websockets/websocket_basic_stream_test.cc
+++ b/net/websockets/websocket_basic_stream_test.cc
@@ -182,7 +182,7 @@ class WebSocketBasicStreamSocketTest : public TestWithTaskEnvironment {
   void SetHttpReadBuffer(const char* data, size_t size) {
     http_read_buffer_ = base::MakeRefCounted<GrowableIOBuffer>();
     http_read_buffer_->SetCapacity(size);
-    memcpy(http_read_buffer_->data(), data, size);
+    memcpy(http_read_buffer_->data().data(), data, size);
     http_read_buffer_->set_offset(size);
   }
 
diff --git a/net/websockets/websocket_channel_test.cc b/net/websockets/websocket_channel_test.cc
index 6f52836eb4119..6412e786caa3e 100644
--- a/net/websockets/websocket_channel_test.cc
+++ b/net/websockets/websocket_channel_test.cc
@@ -379,7 +379,7 @@ std::vector<std::unique_ptr<WebSocketFrame>> CreateFrameVector(
       auto buffer = base::MakeRefCounted<IOBufferWithSize>(frame_length);
       result_frame_data->push_back(buffer);
       std::copy(source_frame.data, source_frame.data + frame_length,
-                buffer->data());
+                buffer->data().data());
       result_frame->payload = buffer->span();
     }
     result_frames.push_back(std::move(result_frame));
@@ -2266,7 +2266,7 @@ TEST_F(WebSocketChannelEventInterfaceTest, ReadBinaryFramesAre8BitClean) {
   frame_header.final = true;
   frame_header.payload_length = kBinaryBlobSize;
   auto buffer = base::MakeRefCounted<IOBufferWithSize>(kBinaryBlobSize);
-  memcpy(buffer->data(), kBinaryBlob, kBinaryBlobSize);
+  memcpy(buffer->data().data(), kBinaryBlob, kBinaryBlobSize);
   frame->payload = buffer->span();
   std::vector<std::unique_ptr<WebSocketFrame>> frames;
   frames.push_back(std::move(frame));
diff --git a/net/websockets/websocket_deflate_stream_test.cc b/net/websockets/websocket_deflate_stream_test.cc
index e767892bf44cd..eb06889784099 100644
--- a/net/websockets/websocket_deflate_stream_test.cc
+++ b/net/websockets/websocket_deflate_stream_test.cc
@@ -57,7 +57,7 @@ constexpr size_t kChunkSize = 4 * 1024;
 constexpr int kWindowBits = 15;
 
 std::string ToString(IOBufferWithSize* buffer) {
-  return std::string(buffer->data(), buffer->size());
+  return std::string(buffer->data().data(), buffer->size());
 }
 
 std::string ToString(const scoped_refptr<IOBufferWithSize>& buffer) {
diff --git a/net/websockets/websocket_deflater.cc b/net/websockets/websocket_deflater.cc
index 4c902ce00c830..b6a1dadf943be 100644
--- a/net/websockets/websocket_deflater.cc
+++ b/net/websockets/websocket_deflater.cc
@@ -130,7 +130,7 @@ scoped_refptr<IOBufferWithSize> WebSocketDeflater::GetOutput(size_t size) {
   base::circular_deque<char>::iterator end = begin + length_to_copy;
 
   auto result = base::MakeRefCounted<IOBufferWithSize>(length_to_copy);
-  std::copy(begin, end, result->data());
+  std::copy(begin, end, result->data().data());
   buffer_.erase(begin, end);
   return result;
 }
diff --git a/net/websockets/websocket_deflater_test.cc b/net/websockets/websocket_deflater_test.cc
index 6e27103c65829..b050763c41200 100644
--- a/net/websockets/websocket_deflater_test.cc
+++ b/net/websockets/websocket_deflater_test.cc
@@ -14,7 +14,7 @@ namespace net {
 namespace {
 
 std::string ToString(IOBufferWithSize* buffer) {
-  return std::string(buffer->data(), buffer->size());
+  return std::string(buffer->data().data(), buffer->size());
 }
 
 TEST(WebSocketDeflaterTest, Construct) {
diff --git a/net/websockets/websocket_inflater_test.cc b/net/websockets/websocket_inflater_test.cc
index 03c2b3e985616..2497721a15b71 100644
--- a/net/websockets/websocket_inflater_test.cc
+++ b/net/websockets/websocket_inflater_test.cc
@@ -22,7 +22,7 @@ namespace net {
 namespace {
 
 std::string ToString(IOBufferWithSize* buffer) {
-  return std::string(buffer->data(), buffer->size());
+  return std::string(buffer->data().data(), buffer->size());
 }
 
 TEST(WebSocketInflaterTest, Construct) {
@@ -214,9 +214,8 @@ TEST(WebSocketInflaterTest, LargeRandomDeflateInflate) {
     scoped_refptr<IOBufferWithSize> uncompressed =
         inflater.GetOutput(inflater.CurrentOutputSize());
     ASSERT_TRUE(uncompressed.get());
-    output.insert(output.end(),
-                  uncompressed->data(),
-                  uncompressed->data() + uncompressed->size());
+    output.insert(output.end(), uncompressed->data().data(),
+                  uncompressed->data().subspan(uncompressed->size()).data());
   }
 
   EXPECT_EQ(output, input);
diff --git a/net/websockets/websocket_quic_spdy_stream.cc b/net/websockets/websocket_quic_spdy_stream.cc
index 6fb411e0748e2..372e61e717825 100644
--- a/net/websockets/websocket_quic_spdy_stream.cc
+++ b/net/websockets/websocket_quic_spdy_stream.cc
@@ -48,7 +48,7 @@ void WebSocketQuicSpdyStream::OnInitialHeadersComplete(
 
 int WebSocketQuicSpdyStream::Read(IOBuffer* buf, int buf_len) {
   DCHECK_GT(buf_len, 0);
-  DCHECK(buf->data());
+  DCHECK(!buf->data().empty());
 
   if (IsDoneReading()) {
     return 0;  // EOF
diff --git a/remoting/base/buffered_socket_writer_unittest.cc b/remoting/base/buffered_socket_writer_unittest.cc
index 324de1b5653c4..ff9664ca8b7f8 100644
--- a/remoting/base/buffered_socket_writer_unittest.cc
+++ b/remoting/base/buffered_socket_writer_unittest.cc
@@ -129,10 +129,10 @@ class BufferedSocketWriterTest : public testing::Test {
     ASSERT_EQ(
         static_cast<size_t>(test_buffer_->size() + test_buffer_2_->size()),
         socket_data_provider_.written_data().size());
-    EXPECT_EQ(0, memcmp(test_buffer_->data(),
+    EXPECT_EQ(0, memcmp(test_buffer_->data().data(),
                         socket_data_provider_.written_data().data(),
                         test_buffer_->size()));
-    EXPECT_EQ(0, memcmp(test_buffer_2_->data(),
+    EXPECT_EQ(0, memcmp(test_buffer_2_->data().data(),
                         socket_data_provider_.written_data().data() +
                             test_buffer_->size(),
                         test_buffer_2_->size()));
@@ -218,7 +218,7 @@ TEST_F(BufferedSocketWriterTest, DestroyFromCallback) {
   base::RunLoop().RunUntilIdle();
   ASSERT_GE(socket_data_provider_.written_data().size(),
             static_cast<size_t>(test_buffer_->size()));
-  EXPECT_EQ(0, memcmp(test_buffer_->data(),
+  EXPECT_EQ(0, memcmp(test_buffer_->data().data(),
                       socket_data_provider_.written_data().data(),
                       test_buffer_->size()));
 }
diff --git a/remoting/base/compound_buffer.cc b/remoting/base/compound_buffer.cc
index 1c6f6561e928d..6afb3a4816628 100644
--- a/remoting/base/compound_buffer.cc
+++ b/remoting/base/compound_buffer.cc
@@ -87,13 +87,13 @@ void CompoundBuffer::Prepend(const CompoundBuffer& buffer) {
 }
 void CompoundBuffer::AppendCopyOf(const char* data, int size) {
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(size);
-  memcpy(buffer->data(), data, size);
+  memcpy(buffer->data().data(), data, size);
   Append(std::move(buffer), size);
 }
 
 void CompoundBuffer::PrependCopyOf(const char* data, int size) {
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(size);
-  memcpy(buffer->data(), data, size);
+  memcpy(buffer->data().data(), data, size);
   Prepend(std::move(buffer), size);
 }
 
diff --git a/remoting/base/compound_buffer_unittest.cc b/remoting/base/compound_buffer_unittest.cc
index 869d7c34a18ff..9b47e509ebc12 100644
--- a/remoting/base/compound_buffer_unittest.cc
+++ b/remoting/base/compound_buffer_unittest.cc
@@ -45,19 +45,20 @@ class CompoundBufferTest : public testing::Test {
  public:
   // Following 5 methods are used with IterateOverPieces().
   void Append(int pos, int size) {
-    target_.Append(data_, data_->data() + pos, size);
+    target_.Append(data_, data_->data().subspan(pos), size);
   }
 
   void AppendCopyOf(int pos, int size) {
-    target_.AppendCopyOf(data_->data() + pos, size);
+    target_.AppendCopyOf(data_->data().subspan(pos), size);
   }
 
   void Prepend(int pos, int size) {
-    target_.Prepend(data_, data_->data() + kDataSize - pos - size, size);
+    target_.Prepend(data_, data_->data().subspan(kDataSize - pos - size), size);
   }
 
   void PrependCopyOf(int pos, int size) {
-    target_.PrependCopyOf(data_->data() + (kDataSize - pos - size), size);
+    target_.PrependCopyOf(data_->data().subspan((kDataSize - pos - size)),
+                          size);
   }
 
   void TestCopyFrom(int pos, int size) {
@@ -115,7 +116,7 @@ class CompoundBufferTest : public testing::Test {
   bool CompareData(const CompoundBuffer& buffer, char* data, int size) {
     scoped_refptr<IOBuffer> buffer_data = buffer.ToIOBufferWithSize();
     return buffer.total_bytes() == size &&
-           memcmp(buffer_data->data(), data, size) == 0;
+           memcmp(buffer_data->data().data(), data, size) == 0;
   }
 
   static size_t ReadFromInput(CompoundBufferInputStream* input,
diff --git a/remoting/base/protobuf_http_stream_parser.cc b/remoting/base/protobuf_http_stream_parser.cc
index a0db84b68a442..745f24d36c1fe 100644
--- a/remoting/base/protobuf_http_stream_parser.cc
+++ b/remoting/base/protobuf_http_stream_parser.cc
@@ -52,7 +52,7 @@ void ProtobufHttpStreamParser::Append(std::string_view data) {
   }
 
   DCHECK_GE(read_buffer_->RemainingCapacity(), static_cast<int>(data.size()));
-  memcpy(read_buffer_->data(), data.data(), data.size());
+  memcpy(read_buffer_->data().data(), data.data(), data.size());
   read_buffer_->set_offset(read_buffer_->offset() + data.size());
 
   ParseStreamIfAvailable();
diff --git a/remoting/host/security_key/security_key_socket.cc b/remoting/host/security_key/security_key_socket.cc
index 469ae73b068a2..1974ec0b140ee 100644
--- a/remoting/host/security_key/security_key_socket.cc
+++ b/remoting/host/security_key/security_key_socket.cc
@@ -164,8 +164,8 @@ void SecurityKeySocket::OnDataRead(int result) {
   // that we could read too many bytes from the buffer (e.g. all of request #1
   // and some of request #2).  We should consider using the request header to
   // determine the request length and only read that amount from buffer.
-  request_data_.insert(request_data_.end(), read_buffer_->data(),
-                       read_buffer_->data() + result);
+  request_data_.insert(request_data_.end(), read_buffer_->data().data(),
+                       read_buffer_->data().subspan(result).data());
   if (IsRequestComplete()) {
     waiting_for_request_ = false;
     std::move(request_received_callback_).Run();
diff --git a/remoting/protocol/channel_multiplexer.cc b/remoting/protocol/channel_multiplexer.cc
index 78866fdeee190..0bcc99c2b7244 100644
--- a/remoting/protocol/channel_multiplexer.cc
+++ b/remoting/protocol/channel_multiplexer.cc
@@ -210,8 +210,8 @@ int ChannelMultiplexer::MuxChannel::DoRead(
   int pos = 0;
   while (buffer_len > 0 && !pending_packets_.empty()) {
     DCHECK(!pending_packets_.front()->is_empty());
-    int result =
-        pending_packets_.front()->Read(buffer->data() + pos, buffer_len);
+    int result = pending_packets_.front()->Read(
+        buffer->data().subspan(pos).data(), buffer_len);
     DCHECK_LE(result, buffer_len);
     pos += result;
     buffer_len -= pos;
@@ -267,7 +267,7 @@ int ChannelMultiplexer::MuxSocket::Write(
 
   std::unique_ptr<MultiplexPacket> packet(new MultiplexPacket());
   size_t size = std::min(kMaxPacketSize, buffer_len);
-  packet->mutable_data()->assign(buffer->data(), size);
+  packet->mutable_data()->assign(buffer->data().data(), size);
 
   write_pending_ = true;
   channel_->DoWrite(
diff --git a/remoting/protocol/channel_socket_adapter.cc b/remoting/protocol/channel_socket_adapter.cc
index de709774c2190..8d0dcd31f32d7 100644
--- a/remoting/protocol/channel_socket_adapter.cc
+++ b/remoting/protocol/channel_socket_adapter.cc
@@ -89,7 +89,7 @@ int TransportChannelSocketAdapter::Send(
   int result;
   rtc::PacketOptions options;
   if (channel_->writable()) {
-    result = channel_->SendPacket(buffer->data(), buffer_size, options);
+    result = channel_->SendPacket(buffer->data().data(), buffer_size, options);
     if (result < 0) {
       result = net::MapSystemError(channel_->GetError());
 
@@ -155,7 +155,7 @@ void TransportChannelSocketAdapter::OnNewPacket(
       data_size = read_buffer_size_;
     }
 
-    memcpy(read_buffer_->data(), packet.payload().data(), data_size);
+    memcpy(read_buffer_->data().data(), packet.payload().data(), data_size);
 
     net::CompletionRepeatingCallback callback = read_callback_;
     read_callback_.Reset();
@@ -173,8 +173,8 @@ void TransportChannelSocketAdapter::OnWritableState(
   // Try to send the packet if there is a pending write.
   if (!write_callback_.is_null()) {
     rtc::PacketOptions options;
-    int result = channel_->SendPacket(write_buffer_->data(), write_buffer_size_,
-                                      options);
+    int result = channel_->SendPacket(write_buffer_->data().data(),
+                                      write_buffer_size_, options);
     if (result < 0) {
       result = net::MapSystemError(channel_->GetError());
     }
diff --git a/remoting/protocol/chromium_socket_factory.cc b/remoting/protocol/chromium_socket_factory.cc
index 1dd1926a451a8..3c15579ed23e0 100644
--- a/remoting/protocol/chromium_socket_factory.cc
+++ b/remoting/protocol/chromium_socket_factory.cc
@@ -150,7 +150,7 @@ UdpPacketSocket::PendingPacket::PendingPacket(const void* buffer,
     : data(base::MakeRefCounted<net::IOBufferWithSize>(buffer_size)),
       address(address),
       options(options) {
-  memcpy(data->data(), buffer, buffer_size);
+  memcpy(data->data().data(), buffer, buffer_size);
 }
 
 UdpPacketSocket::UdpPacketSocket() {
@@ -337,7 +337,7 @@ void UdpPacketSocket::DoSend() {
   while (!send_pending_ && !send_queue_.empty() && error_ == 0) {
     PendingPacket& packet = send_queue_.front();
     cricket::ApplyPacketOptions(
-        packet.data->bytes(), packet.data->size(),
+        packet.data->bytes().data(), packet.data->size(),
         packet.options.packet_time_params,
         (base::TimeTicks::Now() - base::TimeTicks()).InMicroseconds());
     int result = socket_->SendTo(
@@ -434,7 +434,7 @@ void UdpPacketSocket::HandleReadResult(int result) {
       NOTREACHED() << "Failed to convert address received from RecvFrom().";
     }
     rtc::ReceivedPacket packet(
-        rtc::MakeArrayView(receive_buffer_->bytes(), result), address,
+        rtc::MakeArrayView(receive_buffer_->bytes().data(), result), address,
         webrtc::Timestamp::Micros(rtc::TimeMicros()));
     NotifyPacketReceived(packet);
   } else {
diff --git a/remoting/protocol/fake_datagram_socket.cc b/remoting/protocol/fake_datagram_socket.cc
index 3ff9084996e34..cbc2c032c3b71 100644
--- a/remoting/protocol/fake_datagram_socket.cc
+++ b/remoting/protocol/fake_datagram_socket.cc
@@ -108,13 +108,15 @@ int FakeDatagramSocket::DoSend(const scoped_refptr<net::IOBuffer>& buf,
   }
 
   written_packets_.push_back(std::string());
-  written_packets_.back().assign(buf->data(), buf->data() + buf_len);
+  written_packets_.back().assign(buf->data().data(),
+                                 buf->data().subspan(buf_len).data());
 
   if (peer_socket_.get()) {
     task_runner_->PostTask(
         FROM_HERE,
         base::BindOnce(&FakeDatagramSocket::AppendInputPacket, peer_socket_,
-                       std::string(buf->data(), buf->data() + buf_len)));
+                       std::string(buf->data().data(),
+                                   buf->data().subspan(buf_len).data())));
   }
 
   return buf_len;
@@ -124,7 +126,7 @@ int FakeDatagramSocket::CopyReadData(const scoped_refptr<net::IOBuffer>& buf,
                                      int buf_len) {
   int size =
       std::min(buf_len, static_cast<int>(input_packets_[input_pos_].size()));
-  memcpy(buf->data(), &(*input_packets_[input_pos_].begin()), size);
+  memcpy(buf->data().data(), &(*input_packets_[input_pos_].begin()), size);
   ++input_pos_;
   return size;
 }
diff --git a/remoting/protocol/fake_stream_socket.cc b/remoting/protocol/fake_stream_socket.cc
index f7f0e20e99e32..bbff9dec7b413 100644
--- a/remoting/protocol/fake_stream_socket.cc
+++ b/remoting/protocol/fake_stream_socket.cc
@@ -44,7 +44,8 @@ void FakeStreamSocket::AppendInputData(const std::string& data) {
     int result = std::min(read_buffer_size_,
                           static_cast<int>(input_data_.size() - input_pos_));
     EXPECT_GT(result, 0);
-    memcpy(read_buffer_->data(), &(*input_data_.begin()) + input_pos_, result);
+    memcpy(read_buffer_->data().data(), &(*input_data_.begin()) + input_pos_,
+           result);
     input_pos_ += result;
     read_buffer_ = nullptr;
 
@@ -80,7 +81,7 @@ int FakeStreamSocket::Read(const scoped_refptr<net::IOBuffer>& buf,
   if (input_pos_ < static_cast<int>(input_data_.size())) {
     int result =
         std::min(buf_len, static_cast<int>(input_data_.size()) - input_pos_);
-    memcpy(buf->data(), &(*input_data_.begin()) + input_pos_, result);
+    memcpy(buf->data().data(), &(*input_data_.begin()) + input_pos_, result);
     input_pos_ += result;
     return result;
   } else if (next_read_error_.has_value()) {
@@ -145,13 +146,15 @@ void FakeStreamSocket::DoAsyncWrite(const scoped_refptr<net::IOBuffer>& buf,
 
 void FakeStreamSocket::DoWrite(const scoped_refptr<net::IOBuffer>& buf,
                                int buf_len) {
-  written_data_.insert(written_data_.end(), buf->data(), buf->data() + buf_len);
+  written_data_.insert(written_data_.end(), buf->data().data(),
+                       buf->data().subspan(buf_len).data());
 
   if (peer_socket_) {
     task_runner_->PostTask(
         FROM_HERE,
         base::BindOnce(&FakeStreamSocket::AppendInputData, peer_socket_,
-                       std::string(buf->data(), buf->data() + buf_len)));
+                       std::string(buf->data().data(),
+                                   buf->data().subspan(buf_len).data())));
   }
 }
 
diff --git a/remoting/protocol/message_decoder_unittest.cc b/remoting/protocol/message_decoder_unittest.cc
index cd53211820b5a..d9a64470e7d34 100644
--- a/remoting/protocol/message_decoder_unittest.cc
+++ b/remoting/protocol/message_decoder_unittest.cc
@@ -29,7 +29,7 @@ static void AppendMessage(const EventMessage& msg, std::string* buffer) {
   // Contains one encoded message.
   scoped_refptr<net::IOBufferWithSize> encoded_msg;
   encoded_msg = SerializeAndFrameMessage(msg);
-  buffer->append(encoded_msg->data(), encoded_msg->size());
+  buffer->append(encoded_msg->data().data(), encoded_msg->size());
 }
 
 // Construct and prepare data in the |output_stream|.
@@ -75,7 +75,7 @@ void SimulateReadSequence(const int read_sequence[], int sequence_size) {
 
     // And then prepare an IOBuffer for feeding it.
     auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(read);
-    memcpy(buffer->data(), test_data + pos, read);
+    memcpy(buffer->data().data(), test_data + pos, read);
     decoder.AddData(buffer, read);
     while (true) {
       std::unique_ptr<CompoundBuffer> message(decoder.GetNextMessage());
diff --git a/remoting/protocol/message_serialization.cc b/remoting/protocol/message_serialization.cc
index 449858065e7e7..8f52ff3786381 100644
--- a/remoting/protocol/message_serialization.cc
+++ b/remoting/protocol/message_serialization.cc
@@ -24,8 +24,9 @@ scoped_refptr<net::IOBufferWithSize> SerializeAndFrameMessage(
   size_t size = msg.ByteSizeLong() + kExtraBytes;
   scoped_refptr<net::IOBufferWithSize> buffer =
       base::MakeRefCounted<net::IOBufferWithSize>(size);
-  rtc::SetBE32(buffer->data(), msg.GetCachedSize());
-  msg.SerializeWithCachedSizesToArray(buffer->bytes() + kExtraBytes);
+  rtc::SetBE32(buffer->data().data(), msg.GetCachedSize());
+  msg.SerializeWithCachedSizesToArray(
+      buffer->bytes().subspan(kExtraBytes).data());
   return buffer;
 }
 
diff --git a/remoting/protocol/pseudotcp_adapter.cc b/remoting/protocol/pseudotcp_adapter.cc
index 9270ec87d5d37..f98fcdf8f68f7 100644
--- a/remoting/protocol/pseudotcp_adapter.cc
+++ b/remoting/protocol/pseudotcp_adapter.cc
@@ -144,7 +144,7 @@ int PseudoTcpAdapter::Core::Read(const scoped_refptr<net::IOBuffer>& buffer,
   // Reference the Core in case a callback deletes the adapter.
   scoped_refptr<Core> core(this);
 
-  int result = pseudo_tcp_.Recv(buffer->data(), buffer_size);
+  int result = pseudo_tcp_.Recv(buffer->data().data(), buffer_size);
   if (result < 0) {
     result = net::MapSystemError(pseudo_tcp_.GetError());
     DCHECK(result < 0);
@@ -171,7 +171,7 @@ int PseudoTcpAdapter::Core::Write(
   // Reference the Core in case a callback deletes the adapter.
   scoped_refptr<Core> core(this);
 
-  int result = pseudo_tcp_.Send(buffer->data(), buffer_size);
+  int result = pseudo_tcp_.Send(buffer->data().data(), buffer_size);
   if (result < 0) {
     result = net::MapSystemError(pseudo_tcp_.GetError());
     DCHECK(result < 0);
@@ -243,7 +243,7 @@ void PseudoTcpAdapter::Core::OnTcpReadable(PseudoTcp* tcp) {
     return;
   }
 
-  int result = pseudo_tcp_.Recv(read_buffer_->data(), read_buffer_size_);
+  int result = pseudo_tcp_.Recv(read_buffer_->data().data(), read_buffer_size_);
   if (result < 0) {
     result = net::MapSystemError(pseudo_tcp_.GetError());
     DCHECK(result < 0);
@@ -269,7 +269,8 @@ void PseudoTcpAdapter::Core::OnTcpWriteable(PseudoTcp* tcp) {
     return;
   }
 
-  int result = pseudo_tcp_.Send(write_buffer_->data(), write_buffer_size_);
+  int result =
+      pseudo_tcp_.Send(write_buffer_->data().data(), write_buffer_size_);
   if (result < 0) {
     result = net::MapSystemError(pseudo_tcp_.GetError());
     DCHECK(result < 0);
@@ -352,7 +353,7 @@ cricket::IPseudoTcpNotify::WriteResult PseudoTcpAdapter::Core::TcpWritePacket(
   }
 
   auto write_buffer = base::MakeRefCounted<net::IOBufferWithSize>(len);
-  memcpy(write_buffer->data(), buffer, len);
+  memcpy(write_buffer->data().data(), buffer, len);
 
   // Our underlying socket is datagram-oriented, which means it should either
   // send exactly as many bytes as we requested, or fail.
@@ -401,7 +402,7 @@ void PseudoTcpAdapter::Core::HandleReadResults(int result) {
   }
 
   // TODO(wez): Disconnect on failure of NotifyPacket?
-  pseudo_tcp_.NotifyPacket(socket_read_buffer_->data(), result);
+  pseudo_tcp_.NotifyPacket(socket_read_buffer_->data().data(), result);
   AdjustClock();
 
   CheckWriteComplete();
diff --git a/remoting/protocol/pseudotcp_adapter_unittest.cc b/remoting/protocol/pseudotcp_adapter_unittest.cc
index 135b9e0a19baf..1db20a1dd3491 100644
--- a/remoting/protocol/pseudotcp_adapter_unittest.cc
+++ b/remoting/protocol/pseudotcp_adapter_unittest.cc
@@ -94,7 +94,7 @@ class FakeSocket : public P2PDatagramSocket {
 
     if (!read_callback_.is_null()) {
       int size = std::min(read_buffer_size_, static_cast<int>(data.size()));
-      memcpy(read_buffer_->data(), &data[0], data.size());
+      memcpy(read_buffer_->data().data(), &data[0], data.size());
       net::CompletionRepeatingCallback cb = read_callback_;
       read_callback_.Reset();
       read_buffer_.reset();
@@ -123,7 +123,7 @@ class FakeSocket : public P2PDatagramSocket {
       scoped_refptr<net::IOBuffer> buffer(buf);
       int size =
           std::min(static_cast<int>(incoming_packets_.front().size()), buf_len);
-      memcpy(buffer->data(), &*incoming_packets_.front().begin(), size);
+      memcpy(buffer->data().data(), &*incoming_packets_.front().begin(), size);
       incoming_packets_.pop_front();
       return size;
     } else {
@@ -141,9 +141,10 @@ class FakeSocket : public P2PDatagramSocket {
     if (peer_socket_) {
       base::SingleThreadTaskRunner::GetCurrentDefault()->PostDelayedTask(
           FROM_HERE,
-          base::BindOnce(&FakeSocket::AppendInputPacket,
-                         base::Unretained(peer_socket_),
-                         std::vector<char>(buf->data(), buf->data() + buf_len)),
+          base::BindOnce(
+              &FakeSocket::AppendInputPacket, base::Unretained(peer_socket_),
+              std::vector<char>(buf->data().data(),
+                                buf->data().subspan(buf_len).data())),
           base::Milliseconds(latency_ms_));
     }
 
@@ -211,7 +212,7 @@ class TCPChannelTester : public base::RefCountedThreadSafe<TCPChannelTester> {
     output_buffer_ = base::MakeRefCounted<net::DrainableIOBuffer>(
         base::MakeRefCounted<net::IOBufferWithSize>(kTestDataSize),
         kTestDataSize);
-    memset(output_buffer_->data(), 123, kTestDataSize);
+    memset(output_buffer_->data().data(), 123, kTestDataSize);
 
     input_buffer_ = base::MakeRefCounted<net::GrowableIOBuffer>();
     // Always keep kMessageSize bytes available at the end of the input buffer.
diff --git a/remoting/protocol/stream_packet_socket.cc b/remoting/protocol/stream_packet_socket.cc
index 1273e9753c73c..222539e76d6ac 100644
--- a/remoting/protocol/stream_packet_socket.cc
+++ b/remoting/protocol/stream_packet_socket.cc
@@ -301,7 +301,7 @@ void StreamPacketSocket::DoWrite() {
     if (packet.data->BytesConsumed() == 0) {
       // Only apply packet options when we are about to send the head of the
       // packet.
-      packet_processor_->ApplyPacketOptions(packet.data->bytes(),
+      packet_processor_->ApplyPacketOptions(packet.data->bytes().data(),
                                             packet.data->size(),
                                             packet.options.packet_time_params);
     }
@@ -395,7 +395,7 @@ bool StreamPacketSocket::HandleReadResult(int result) {
         packet_processor_->Unpack(span.data(), span.size(), &bytes_consumed);
     if (packet) {
       NotifyPacketReceived(rtc::ReceivedPacket(
-          rtc::MakeArrayView(packet->bytes(), packet->size()),
+          rtc::MakeArrayView(packet->bytes().data(), packet->size()),
           GetRemoteAddress(), webrtc::Timestamp::Micros(rtc::TimeMicros())));
     }
     if (!bytes_consumed) {
diff --git a/remoting/protocol/stun_tcp_packet_processor.cc b/remoting/protocol/stun_tcp_packet_processor.cc
index 282eea21a95c9..6b82279bc8c80 100644
--- a/remoting/protocol/stun_tcp_packet_processor.cc
+++ b/remoting/protocol/stun_tcp_packet_processor.cc
@@ -88,12 +88,12 @@ scoped_refptr<net::IOBufferWithSize> StunTcpPacketProcessor::Pack(
   size_t size = data_size + pad_bytes;
 
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(size);
-  memcpy(buffer->data(), data, data_size);
+  memcpy(buffer->data().data(), data, data_size);
 
   if (pad_bytes) {
     char padding[4] = {};
     DCHECK_LE(pad_bytes, 4u);
-    memcpy(buffer->data() + data_size, padding, pad_bytes);
+    memcpy(buffer->data().subspan(data_size).data(), padding, pad_bytes);
   }
   return buffer;
 }
@@ -118,7 +118,7 @@ scoped_refptr<net::IOBufferWithSize> StunTcpPacketProcessor::Unpack(
   const uint8_t* cur = data;
   *bytes_consumed = packet_size + pad_bytes;
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(packet_size);
-  memcpy(buffer->data(), cur, packet_size);
+  memcpy(buffer->data().data(), cur, packet_size);
   return buffer;
 }
 
diff --git a/remoting/test/fake_socket_factory.cc b/remoting/test/fake_socket_factory.cc
index 1761540aa1b3a..dd4ee82070b89 100644
--- a/remoting/test/fake_socket_factory.cc
+++ b/remoting/test/fake_socket_factory.cc
@@ -107,8 +107,8 @@ void FakeUdpSocket::ReceivePacket(const rtc::SocketAddress& from,
                                   const scoped_refptr<net::IOBuffer>& data,
                                   int data_size) {
   NotifyPacketReceived(
-      rtc::ReceivedPacket(rtc::MakeArrayView(data->bytes(), data_size), from,
-                          webrtc::Timestamp::Micros(rtc::TimeMicros())));
+      rtc::ReceivedPacket(rtc::MakeArrayView(data->bytes().data(), data_size),
+                          from, webrtc::Timestamp::Micros(rtc::TimeMicros())));
 }
 
 rtc::SocketAddress FakeUdpSocket::GetLocalAddress() const {
@@ -130,9 +130,9 @@ int FakeUdpSocket::SendTo(const void* data,
                           const rtc::SocketAddress& address,
                           const rtc::PacketOptions& options) {
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(data_size);
-  memcpy(buffer->data(), data, data_size);
+  memcpy(buffer->data().data(), data, data_size);
   base::TimeTicks now = base::TimeTicks::Now();
-  cricket::ApplyPacketOptions(buffer->bytes(), data_size,
+  cricket::ApplyPacketOptions(buffer->bytes().data(), data_size,
                               options.packet_time_params,
                               (now - base::TimeTicks()).InMicroseconds());
   SignalSentPacket(this, rtc::SentPacket(options.packet_id, rtc::TimeMillis()));
diff --git a/services/device/serial/bluetooth_serial_port_impl.cc b/services/device/serial/bluetooth_serial_port_impl.cc
index 3806e1f1578ff..9b166e121fdba 100644
--- a/services/device/serial/bluetooth_serial_port_impl.cc
+++ b/services/device/serial/bluetooth_serial_port_impl.cc
@@ -267,7 +267,7 @@ void BluetoothSerialPortImpl::OnBluetoothSocketReceive(
     scoped_refptr<net::IOBuffer> receive_buffer) {
   DCHECK_CALLED_ON_VALID_SEQUENCE(sequence_checker_);
   DCHECK_GT(num_bytes_received, 0);
-  DCHECK(receive_buffer->data());
+  DCHECK(!receive_buffer->data().empty());
 
   const bool receive_completed_after_flush = pending_write_buffer_.empty();
   read_pending_ = false;
@@ -292,7 +292,8 @@ void BluetoothSerialPortImpl::OnBluetoothSocketReceive(
   DCHECK(out_stream_);
   size_t bytes_to_copy = std::min(pending_write_buffer_.size(),
                                   static_cast<size_t>(num_bytes_received));
-  std::copy(receive_buffer->data(), receive_buffer->data() + bytes_to_copy,
+  std::copy(receive_buffer->data().data(),
+            receive_buffer->data().subspan(bytes_to_copy).data(),
             pending_write_buffer_.data());
   out_stream_->EndWriteData(bytes_to_copy);
   if (pending_write_buffer_.size() < static_cast<size_t>(num_bytes_received)) {
diff --git a/services/network/chunked_data_pipe_upload_data_stream.cc b/services/network/chunked_data_pipe_upload_data_stream.cc
index c066c38d77c50..da8f1d0ab887b 100644
--- a/services/network/chunked_data_pipe_upload_data_stream.cc
+++ b/services/network/chunked_data_pipe_upload_data_stream.cc
@@ -278,7 +278,8 @@ void ChunkedDataPipeUploadDataStream::WriteToCacheIfNeeded(net::IOBuffer* buf,
     cache_state_ = CacheState::kExhausted;
     return;
   }
-  cache_.insert(cache_.end(), buf->data(), buf->data() + num_bytes);
+  cache_.insert(cache_.end(), buf->data().data(),
+                buf->data().subspan(num_bytes).data());
 }
 
 int ChunkedDataPipeUploadDataStream::ReadFromCacheIfNeeded(net::IOBuffer* buf,
@@ -291,7 +292,7 @@ int ChunkedDataPipeUploadDataStream::ReadFromCacheIfNeeded(net::IOBuffer* buf,
   int read_size =
       std::min(static_cast<int>(cache_.size() - bytes_read_), buf_len);
   DCHECK_GT(read_size, 0);
-  memcpy(buf->data(), &cache_[bytes_read_], read_size);
+  memcpy(buf->data().data(), &cache_[bytes_read_], read_size);
   bytes_read_ += read_size;
   return read_size;
 }
diff --git a/services/network/chunked_data_pipe_upload_data_stream_unittest.cc b/services/network/chunked_data_pipe_upload_data_stream_unittest.cc
index 10cd487ae3cfb..bc14b1a08dafc 100644
--- a/services/network/chunked_data_pipe_upload_data_stream_unittest.cc
+++ b/services/network/chunked_data_pipe_upload_data_stream_unittest.cc
@@ -104,7 +104,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, ReadBeforeDataReady) {
           result = callback.GetResult(result);
           ASSERT_LT(0, result);
           EXPECT_LE(result, consumer_read_size);
-          read_data.append(std::string(io_buffer->data(), result));
+          read_data.append(std::string(io_buffer->data().data(), result));
           EXPECT_FALSE(chunked_upload_stream_->IsEOF());
         }
         EXPECT_EQ(read_data, kData);
@@ -146,7 +146,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, ReadAfterDataReady) {
               io_buffer.get(), io_buffer->size(), callback.callback());
           ASSERT_LT(0, result);
           EXPECT_LE(result, consumer_read_size);
-          read_data.append(std::string(io_buffer->data(), result));
+          read_data.append(std::string(io_buffer->data().data(), result));
           EXPECT_FALSE(chunked_upload_stream_->IsEOF());
         }
         EXPECT_EQ(read_data, kData);
@@ -200,7 +200,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, MultipleReadThrough) {
       result = callback.GetResult(result);
       ASSERT_LT(0, result);
       EXPECT_LE(static_cast<size_t>(result), kData.size());
-      read_data.append(std::string(io_buffer->data(), result));
+      read_data.append(std::string(io_buffer->data().data(), result));
       if (read_data.size() == kData.size()) {
         EXPECT_TRUE(chunked_upload_stream_->IsEOF());
       } else {
@@ -257,7 +257,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest,
       result = callback.GetResult(result);
       ASSERT_LT(0, result);
       EXPECT_LE(static_cast<size_t>(result), kData.size());
-      read_data.append(std::string(io_buffer->data(), result));
+      read_data.append(std::string(io_buffer->data().data(), result));
 
       if (read_data.size() == kData.size()) {
         EXPECT_TRUE(chunked_upload_stream_->IsEOF());
@@ -311,7 +311,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest,
       result = callback.GetResult(result);
       ASSERT_LT(0, result);
       EXPECT_LE(static_cast<size_t>(result), kData.size());
-      read_data.append(std::string(io_buffer->data(), result));
+      read_data.append(std::string(io_buffer->data().data(), result));
       EXPECT_FALSE(chunked_upload_stream_->IsEOF());
     }
     EXPECT_EQ(kData.substr(0, num_bytes_to_read), read_data);
@@ -362,7 +362,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, GetSizeSucceedsBeforeInit) {
     result = callback.GetResult(result);
     ASSERT_LT(0, result);
     EXPECT_LE(result, read_size);
-    read_data.append(std::string(io_buffer->data(), result));
+    read_data.append(std::string(io_buffer->data().data(), result));
     EXPECT_EQ(read_data.size() == kData.size(),
               chunked_upload_stream_->IsEOF());
   }
@@ -384,7 +384,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, GetSizeSucceedsAfterReset) {
     result = callback.GetResult(result);
     ASSERT_LT(0, result);
     EXPECT_LE(result, read_size);
-    read_data.append(std::string(io_buffer->data(), result));
+    read_data.append(std::string(io_buffer->data().data(), result));
     EXPECT_FALSE(chunked_upload_stream_->IsEOF());
   }
 
@@ -410,7 +410,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, GetSizeSucceedsAfterReset) {
     result = callback.GetResult(result);
     ASSERT_LT(0, result);
     EXPECT_LE(result, read_size);
-    read_data.append(std::string(io_buffer->data(), result));
+    read_data.append(std::string(io_buffer->data().data(), result));
     EXPECT_EQ(read_data.size() == kData.size(),
               chunked_upload_stream_->IsEOF());
   }
@@ -452,7 +452,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, GetSizeFailsAfterReset) {
     result = callback.GetResult(result);
     ASSERT_LT(0, result);
     EXPECT_LE(result, read_size);
-    read_data.append(std::string(io_buffer->data(), result));
+    read_data.append(std::string(io_buffer->data().data(), result));
     EXPECT_FALSE(chunked_upload_stream_->IsEOF());
   }
 
@@ -677,7 +677,7 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest, ExtraBytes1) {
         io_buffer.get(), io_buffer->size(), callback.callback());
     result = callback.GetResult(result);
     ASSERT_LT(0, result);
-    read_data.append(std::string(io_buffer->data(), result));
+    read_data.append(std::string(io_buffer->data().data(), result));
     EXPECT_LE(read_data.size(), kData.size());
     EXPECT_FALSE(chunked_upload_stream_->IsEOF());
   }
@@ -804,12 +804,12 @@ TEST_F(ChunkedDataPipeUploadDataStreamTest,
                                          net::NetLogWithSource()));
 }
 
-#define EXPECT_READ(chunked_upload_stream, io_buffer, expected)       \
-  {                                                                   \
-    int read_result = chunked_upload_stream->Read(                    \
-        io_buffer.get(), io_buffer->size(), NoCallback());            \
-    EXPECT_GT(read_result, 0);                                        \
-    EXPECT_EQ(std::string(io_buffer->data(), read_result), expected); \
+#define EXPECT_READ(chunked_upload_stream, io_buffer, expected)              \
+  {                                                                          \
+    int read_result = chunked_upload_stream->Read(                           \
+        io_buffer.get(), io_buffer->size(), NoCallback());                   \
+    EXPECT_GT(read_result, 0);                                               \
+    EXPECT_EQ(std::string(io_buffer->data().data(), read_result), expected); \
   }
 
 #define EXPECT_EOF(chunked_upload_stream, size)                               \
diff --git a/services/network/cors/cors_url_loader_shared_dictionary_unittest.cc b/services/network/cors/cors_url_loader_shared_dictionary_unittest.cc
index 2734fbee1d583..06a98578e59c9 100644
--- a/services/network/cors/cors_url_loader_shared_dictionary_unittest.cc
+++ b/services/network/cors/cors_url_loader_shared_dictionary_unittest.cc
@@ -149,7 +149,7 @@ class CorsURLLoaderSharedDictionaryTest : public CorsURLLoaderTestBase {
     EXPECT_EQ(net::OK, dictionary_info.dictionary()->ReadAll(
                            base::BindOnce([](int) { NOTREACHED(); })));
     EXPECT_EQ(kTestData,
-              std::string(dictionary_info.dictionary()->data()->data(),
+              std::string(dictionary_info.dictionary()->data()->data().data(),
                           dictionary_info.size()));
   }
 
diff --git a/services/network/http_cache_data_counter_unittest.cc b/services/network/http_cache_data_counter_unittest.cc
index 0f8e558d8c9ff..db74498ca6383 100644
--- a/services/network/http_cache_data_counter_unittest.cc
+++ b/services/network/http_cache_data_counter_unittest.cc
@@ -113,7 +113,8 @@ class HttpCacheDataCounterTest : public testing::Test {
 
       auto io_buf =
           base::MakeRefCounted<net::IOBufferWithSize>(test_entry.size);
-      std::fill(io_buf->data(), io_buf->data() + test_entry.size, 0);
+      std::fill(io_buf->data().data(),
+                io_buf->data().subspan(test_entry.size).data(), 0);
 
       net::TestCompletionCallback write_data_callback;
       int rv = entry->WriteData(1, 0, io_buf.get(), test_entry.size,
diff --git a/services/network/mdns_responder.cc b/services/network/mdns_responder.cc
index cc35d2f1abaed..4d8022ae88199 100644
--- a/services/network/mdns_responder.cc
+++ b/services/network/mdns_responder.cc
@@ -348,7 +348,8 @@ scoped_refptr<net::IOBufferWithSize> CreateResolutionResponse(
   DCHECK(response.io_buffer() != nullptr);
   auto buf =
       base::MakeRefCounted<net::IOBufferWithSize>(response.io_buffer_size());
-  memcpy(buf->data(), response.io_buffer()->data(), response.io_buffer_size());
+  memcpy(buf->data().data(), response.io_buffer()->data().data(),
+         response.io_buffer_size());
   return buf;
 }
 
@@ -366,7 +367,8 @@ scoped_refptr<net::IOBufferWithSize> CreateNegativeResponse(
   DCHECK(response.io_buffer() != nullptr);
   auto buf =
       base::MakeRefCounted<net::IOBufferWithSize>(response.io_buffer_size());
-  memcpy(buf->data(), response.io_buffer()->data(), response.io_buffer_size());
+  memcpy(buf->data().data(), response.io_buffer()->data().data(),
+         response.io_buffer_size());
   return buf;
 }
 
@@ -388,7 +390,8 @@ CreateResponseToMdnsNameGeneratorServiceQuery(
   DCHECK(response.io_buffer() != nullptr);
   auto buf =
       base::MakeRefCounted<net::IOBufferWithSize>(response.io_buffer_size());
-  memcpy(buf->data(), response.io_buffer()->data(), response.io_buffer_size());
+  memcpy(buf->data().data(), response.io_buffer()->data().data(),
+         response.io_buffer_size());
   return buf;
 }
 
diff --git a/services/network/mdns_responder_unittest.cc b/services/network/mdns_responder_unittest.cc
index 39915d1c63d3a..b3eeb32c9ba56 100644
--- a/services/network/mdns_responder_unittest.cc
+++ b/services/network/mdns_responder_unittest.cc
@@ -74,7 +74,8 @@ std::string CreateMdnsQuery(uint16_t query_id,
       net::dns_names_util::DottedNameToNetwork(dotted_name);
   CHECK(qname.has_value());
   net::DnsQuery query(query_id, qname.value(), qtype);
-  return std::string(query.io_buffer()->data(), query.io_buffer()->size());
+  return std::string(query.io_buffer()->data().data(),
+                     query.io_buffer()->size());
 }
 
 // Creates an mDNS response as announcement, resolution for queries or goodbye.
@@ -83,14 +84,14 @@ std::string CreateResolutionResponse(
     const std::map<std::string, net::IPAddress>& name_addr_map) {
   auto buf = network::mdns_helper::CreateResolutionResponse(ttl, name_addr_map);
   DCHECK(buf != nullptr);
-  return std::string(buf->data(), buf->size());
+  return std::string(buf->data().data(), buf->size());
 }
 
 std::string CreateNegativeResponse(
     const std::map<std::string, net::IPAddress>& name_addr_map) {
   auto buf = network::mdns_helper::CreateNegativeResponse(name_addr_map);
   DCHECK(buf != nullptr);
-  return std::string(buf->data(), buf->size());
+  return std::string(buf->data().data(), buf->size());
 }
 
 std::string CreateResponseToMdnsNameGeneratorServiceQuery(
@@ -101,7 +102,7 @@ std::string CreateResponseToMdnsNameGeneratorServiceQuery(
           ttl, names);
 
   DCHECK(buf != nullptr);
-  return std::string(buf->data(), buf->size());
+  return std::string(buf->data().data(), buf->size());
 }
 
 std::string CreateResponseToMdnsNameGeneratorServiceQueryWithCacheFlush(
@@ -134,9 +135,9 @@ std::string CreateResponseToMdnsNameGeneratorServiceQueryWithCacheFlush(
   DCHECK(response_cache_flush.io_buffer() != nullptr);
   buf = base::MakeRefCounted<net::IOBufferWithSize>(
       response_cache_flush.io_buffer_size());
-  memcpy(buf->data(), response_cache_flush.io_buffer()->data(),
+  memcpy(buf->data().data(), response_cache_flush.io_buffer()->data().data(),
          response_cache_flush.io_buffer_size());
-  return std::string(buf->data(), buf->size());
+  return std::string(buf->data().data(), buf->size());
 }
 
 // A mock mDNS socket factory to create sockets that can fail sending or
diff --git a/services/network/p2p/socket_tcp.cc b/services/network/p2p/socket_tcp.cc
index deebd22bf7908..e9ed0e4fd6cf8 100644
--- a/services/network/p2p/socket_tcp.cc
+++ b/services/network/p2p/socket_tcp.cc
@@ -466,7 +466,7 @@ void P2PSocketTcp::DoSend(const net::IPEndPoint& to,
   }
 
   cricket::ApplyPacketOptions(
-      send_buffer.buffer->bytes() + kPacketHeaderSize,
+      send_buffer.buffer->bytes().subspan(kPacketHeaderSize).data(),
       send_buffer.buffer->BytesRemaining() - kPacketHeaderSize,
       options.packet_time_params, rtc::TimeMicros());
 
@@ -532,22 +532,23 @@ void P2PSocketStunTcp::DoSend(const net::IPEndPoint& to,
       base::MakeRefCounted<net::DrainableIOBuffer>(
           base::MakeRefCounted<net::IOBufferWithSize>(buffer_size),
           buffer_size));
-  memcpy(send_buffer.buffer->data(), data.data(), data.size());
+  memcpy(send_buffer.buffer->data().data(), data.data(), data.size());
 
-  cricket::ApplyPacketOptions(send_buffer.buffer->bytes(), data.size(),
+  cricket::ApplyPacketOptions(send_buffer.buffer->bytes().data(), data.size(),
                               options.packet_time_params, rtc::TimeMicros());
 
   if (pad_bytes) {
     char padding[4] = {};
     DCHECK_LE(pad_bytes, 4);
-    memcpy(send_buffer.buffer->data() + data.size(), padding, pad_bytes);
+    memcpy(send_buffer.buffer->data().subspan(data.size()).data(), padding,
+           pad_bytes);
   }
 
   // WriteOrQueue may free the memory, so dump it first.
-  delegate_->DumpPacket(
-      base::span(reinterpret_cast<const uint8_t*>(send_buffer.buffer->data()),
-                 data.size()),
-      false);
+  delegate_->DumpPacket(base::span(reinterpret_cast<const uint8_t*>(
+                                       send_buffer.buffer->data().data()),
+                                   data.size()),
+                        false);
 
   WriteOrQueue(send_buffer);
 }
diff --git a/services/network/p2p/socket_test_utils.cc b/services/network/p2p/socket_test_utils.cc
index b154a6b4ecaf8..19f4ee3571974 100644
--- a/services/network/p2p/socket_test_utils.cc
+++ b/services/network/p2p/socket_test_utils.cc
@@ -83,7 +83,7 @@ void FakeSocket::AppendInputData(const char* data, int data_size) {
     int result = std::min(read_buffer_size_,
                           static_cast<int>(input_data_.size() - input_pos_));
     CHECK(result > 0);
-    memcpy(read_buffer_->data(), &input_data_[0] + input_pos_, result);
+    memcpy(read_buffer_->data().data(), &input_data_[0] + input_pos_, result);
     input_pos_ += result;
     read_buffer_ = nullptr;
     std::move(read_callback_).Run(result);
@@ -105,7 +105,7 @@ int FakeSocket::Read(net::IOBuffer* buf,
   if (input_pos_ < static_cast<int>(input_data_.size())) {
     int result =
         std::min(buf_len, static_cast<int>(input_data_.size()) - input_pos_);
-    memcpy(buf->data(), &(*input_data_.begin()) + input_pos_, result);
+    memcpy(buf->data().data(), &(*input_data_.begin()) + input_pos_, result);
     input_pos_ += result;
     return result;
   } else {
@@ -136,8 +136,8 @@ int FakeSocket::Write(
   }
 
   if (written_data_) {
-    written_data_->insert(written_data_->end(), buf->data(),
-                          buf->data() + buf_len);
+    written_data_->insert(written_data_->end(), buf->data().data(),
+                          buf->data().subspan(buf_len).data());
   }
   return buf_len;
 }
@@ -148,8 +148,8 @@ void FakeSocket::DoAsyncWrite(scoped_refptr<net::IOBuffer> buf,
   write_pending_ = false;
 
   if (written_data_) {
-    written_data_->insert(written_data_->end(), buf->data(),
-                          buf->data() + buf_len);
+    written_data_->insert(written_data_->end(), buf->data().data(),
+                          buf->data().subspan(buf_len).data());
   }
   std::move(callback).Run(buf_len);
 }
diff --git a/services/network/p2p/socket_udp.cc b/services/network/p2p/socket_udp.cc
index 80b201580ce08..27092c98bbdbb 100644
--- a/services/network/p2p/socket_udp.cc
+++ b/services/network/p2p/socket_udp.cc
@@ -117,7 +117,7 @@ P2PPendingPacket::P2PPendingPacket(const net::IPEndPoint& to,
       size(content.size()),
       packet_options(options),
       id(id) {
-  memcpy(data->data(), content.data(), content.size());
+  memcpy(data->data().data(), content.data(), content.size());
 }
 
 P2PPendingPacket::P2PPendingPacket(const P2PPendingPacket& other) = default;
@@ -296,9 +296,9 @@ void P2PSocketUdp::MaybeDrainReceivedPackets(bool force) {
 
 bool P2PSocketUdp::HandleReadResult(int result) {
   if (result > 0) {
-    auto data =
-        base::span(reinterpret_cast<const uint8_t*>(recv_buffer_->data()),
-                   static_cast<size_t>(result));
+    auto data = base::span(
+        reinterpret_cast<const uint8_t*>(recv_buffer_->data().data()),
+        static_cast<size_t>(result));
 
     if (!base::Contains(connected_peers_, recv_address_)) {
       P2PSocket::StunMessageType type;
@@ -359,7 +359,7 @@ bool P2PSocketUdp::DoSend(const P2PPendingPacket& packet) {
   if (!base::Contains(connected_peers_, packet.to)) {
     P2PSocket::StunMessageType type = P2PSocket::StunMessageType();
     bool stun = GetStunPacketType(
-        base::span(reinterpret_cast<const uint8_t*>(packet.data->data()),
+        base::span(reinterpret_cast<const uint8_t*>(packet.data->data().data()),
                    packet.size),
         &type);
     if (!stun || type == STUN_DATA_INDICATION) {
@@ -402,7 +402,7 @@ bool P2PSocketUdp::DoSend(const P2PPendingPacket& packet) {
     }
   }
 
-  cricket::ApplyPacketOptions(packet.data->bytes(), packet.size,
+  cricket::ApplyPacketOptions(packet.data->bytes().data(), packet.size,
                               packet.packet_options.packet_time_params,
                               send_time_us);
   auto callback_binding = base::BindRepeating(
@@ -432,7 +432,7 @@ bool P2PSocketUdp::DoSend(const P2PPendingPacket& packet) {
   }
 
   delegate_->DumpPacket(
-      base::span(reinterpret_cast<const uint8_t*>(packet.data->data()),
+      base::span(reinterpret_cast<const uint8_t*>(packet.data->data().data()),
                  packet.size),
       false);
 
diff --git a/services/network/p2p/socket_udp_unittest.cc b/services/network/p2p/socket_udp_unittest.cc
index 79137d0f4a6a2..fa8312dc5fbf0 100644
--- a/services/network/p2p/socket_udp_unittest.cc
+++ b/services/network/p2p/socket_udp_unittest.cc
@@ -122,8 +122,8 @@ class FakeDatagramServerSocket : public net::DatagramServerSocket {
       int size = std::min(
           static_cast<int>(std::get<1>(incoming_packets_.front()).size()),
           buf_len);
-      memcpy(buffer->data(), &*(std::get<1>(incoming_packets_.front())).begin(),
-             size);
+      memcpy(buffer->data().data(),
+             &*(std::get<1>(incoming_packets_.front())).begin(), size);
       *address = std::get<0>(incoming_packets_.front());
       std::optional<uint64_t> received_time =
           std::get<2>(incoming_packets_.front());
@@ -146,7 +146,8 @@ class FakeDatagramServerSocket : public net::DatagramServerSocket {
              const net::IPEndPoint& address,
              net::CompletionOnceCallback callback) override {
     scoped_refptr<net::IOBuffer> buffer(buf);
-    std::vector<uint8_t> data_vector(buffer->data(), buffer->data() + buf_len);
+    std::vector<uint8_t> data_vector(buffer->data().data(),
+                                     buffer->data().subspan(buf_len).data());
     sent_packets_->push_back(UDPPacket(address, data_vector, std::nullopt));
     return buf_len;
   }
@@ -185,7 +186,7 @@ class FakeDatagramServerSocket : public net::DatagramServerSocket {
       int size = std::min(
           recv_size_,
           static_cast<int>(std::get<1>(incoming_packets_.front()).size()));
-      memcpy(recv_buffer_->data(),
+      memcpy(recv_buffer_->data().data(),
              &*std::get<1>(incoming_packets_.front()).begin(), size);
       *recv_address_ = std::get<0>(incoming_packets_.front());
       std::optional<uint64_t> received_time =
diff --git a/services/network/public/cpp/data_pipe_to_source_stream_unittest.cc b/services/network/public/cpp/data_pipe_to_source_stream_unittest.cc
index b7df8bfc3458e..ff211ce733e22 100644
--- a/services/network/public/cpp/data_pipe_to_source_stream_unittest.cc
+++ b/services/network/public/cpp/data_pipe_to_source_stream_unittest.cc
@@ -111,7 +111,7 @@ class DataPipeToSourceStreamTest
         return rv;
       }
       EXPECT_GT(rv, net::OK);
-      output->append(output_buffer_->data(), rv);
+      output->append(output_buffer_->data().data(), rv);
       EXPECT_TRUE(adapter_->MayHaveMoreBytes());
     }
     EXPECT_FALSE(adapter_->MayHaveMoreBytes());
diff --git a/services/network/shared_dictionary/shared_dictionary_disk_cache_unittest.cc b/services/network/shared_dictionary/shared_dictionary_disk_cache_unittest.cc
index 27633f7aee665..6155e18a1f246 100644
--- a/services/network/shared_dictionary/shared_dictionary_disk_cache_unittest.cc
+++ b/services/network/shared_dictionary/shared_dictionary_disk_cache_unittest.cc
@@ -97,9 +97,10 @@ class SharedDictionaryDiskCacheTest : public testing::Test {
               read_callback.GetResult(entry->ReadData(
                   /*index=*/1, /*offset=*/0, read_buffer.get(),
                   expected_data.size(), read_callback.callback())));
-    EXPECT_EQ(expected_data,
-              std::string(reinterpret_cast<const char*>(read_buffer->data()),
-                          read_buffer->size()));
+    EXPECT_EQ(
+        expected_data,
+        std::string(reinterpret_cast<const char*>(read_buffer->data().data()),
+                    read_buffer->size()));
   }
 
   void PrepareDiskCacheWithTestData() {
diff --git a/services/network/shared_dictionary/shared_dictionary_manager_on_disk_unittest.cc b/services/network/shared_dictionary/shared_dictionary_manager_on_disk_unittest.cc
index 784711a692dd9..d6b0f5c0e0253 100644
--- a/services/network/shared_dictionary/shared_dictionary_manager_on_disk_unittest.cc
+++ b/services/network/shared_dictionary/shared_dictionary_manager_on_disk_unittest.cc
@@ -315,9 +315,10 @@ TEST_F(SharedDictionaryManagerOnDiskTest, ReusingRefCountedSharedDictionary) {
   EXPECT_EQ(dict1->data(), dict2->data());
   EXPECT_EQ(dict1->size(), dict2->size());
   EXPECT_EQ(dict1->hash(), dict2->hash());
-  EXPECT_EQ(kTestData1,
-            std::string(reinterpret_cast<const char*>(dict1->data()->data()),
-                        dict1->size()));
+  EXPECT_EQ(
+      kTestData1,
+      std::string(reinterpret_cast<const char*>(dict1->data()->data().data()),
+                  dict1->size()));
 }
 
 TEST_F(SharedDictionaryManagerOnDiskTest,
@@ -451,17 +452,19 @@ TEST_F(SharedDictionaryManagerOnDiskTest, OverridingDictionary) {
   net::TestCompletionCallback read_callback2;
   EXPECT_EQ(net::OK, read_callback2.GetResult(
                          dict2->ReadAll(read_callback2.callback())));
-  EXPECT_EQ(kTestData2,
-            std::string(reinterpret_cast<const char*>(dict2->data()->data()),
-                        dict2->size()));
+  EXPECT_EQ(
+      kTestData2,
+      std::string(reinterpret_cast<const char*>(dict2->data()->data().data()),
+                  dict2->size()));
 
   // We can still read the old dictionary from `dict1`.
   net::TestCompletionCallback read_callback1;
   EXPECT_EQ(net::OK, read_callback1.GetResult(
                          dict1->ReadAll(read_callback1.callback())));
-  EXPECT_EQ(kTestData1,
-            std::string(reinterpret_cast<const char*>(dict1->data()->data()),
-                        dict1->size()));
+  EXPECT_EQ(
+      kTestData1,
+      std::string(reinterpret_cast<const char*>(dict1->data()->data().data()),
+                  dict1->size()));
 }
 
 TEST_F(SharedDictionaryManagerOnDiskTest, MultipleDictionaries) {
@@ -497,16 +500,18 @@ TEST_F(SharedDictionaryManagerOnDiskTest, MultipleDictionaries) {
     net::TestCompletionCallback read_callback1;
     EXPECT_EQ(net::OK, read_callback1.GetResult(
                            dict1->ReadAll(read_callback1.callback())));
-    EXPECT_EQ(kTestData1,
-              std::string(reinterpret_cast<const char*>(dict1->data()->data()),
-                          dict1->size()));
+    EXPECT_EQ(
+        kTestData1,
+        std::string(reinterpret_cast<const char*>(dict1->data()->data().data()),
+                    dict1->size()));
 
     net::TestCompletionCallback read_callback2;
     EXPECT_EQ(net::OK, read_callback2.GetResult(
                            dict2->ReadAll(read_callback2.callback())));
-    EXPECT_EQ(kTestData2,
-              std::string(reinterpret_cast<const char*>(dict2->data()->data()),
-                          dict2->size()));
+    EXPECT_EQ(
+        kTestData2,
+        std::string(reinterpret_cast<const char*>(dict2->data()->data().data()),
+                    dict2->size()));
     // Releasing `dict1`, `dict2`, `storage` and `manager`.
   }
   // FlushCacheTasks() to finish the persistence operation.
@@ -537,16 +542,18 @@ TEST_F(SharedDictionaryManagerOnDiskTest, MultipleDictionaries) {
   net::TestCompletionCallback read_callback1;
   EXPECT_EQ(net::OK, read_callback1.GetResult(
                          dict1->ReadAll(read_callback1.callback())));
-  EXPECT_EQ(kTestData1,
-            std::string(reinterpret_cast<const char*>(dict1->data()->data()),
-                        dict1->size()));
+  EXPECT_EQ(
+      kTestData1,
+      std::string(reinterpret_cast<const char*>(dict1->data()->data().data()),
+                  dict1->size()));
 
   net::TestCompletionCallback read_callback2;
   EXPECT_EQ(net::OK, read_callback2.GetResult(
                          dict2->ReadAll(read_callback2.callback())));
-  EXPECT_EQ(kTestData2,
-            std::string(reinterpret_cast<const char*>(dict2->data()->data()),
-                        dict2->size()));
+  EXPECT_EQ(
+      kTestData2,
+      std::string(reinterpret_cast<const char*>(dict2->data()->data().data()),
+                  dict2->size()));
 }
 
 TEST_F(SharedDictionaryManagerOnDiskTest, GetDictionary) {
@@ -595,9 +602,10 @@ TEST_F(SharedDictionaryManagerOnDiskTest, GetDictionary) {
   net::TestCompletionCallback read_callback;
   EXPECT_EQ(net::OK,
             read_callback.GetResult(dict->ReadAll(read_callback.callback())));
-  EXPECT_EQ(kTestData1,
-            std::string(reinterpret_cast<const char*>(dict->data()->data()),
-                        dict->size()));
+  EXPECT_EQ(
+      kTestData1,
+      std::string(reinterpret_cast<const char*>(dict->data()->data().data()),
+                  dict->size()));
 }
 
 #if !BUILDFLAG(IS_FUCHSIA)
@@ -754,9 +762,10 @@ TEST_F(SharedDictionaryManagerOnDiskTest, CorruptedDatabase) {
     net::TestCompletionCallback read_callback;
     EXPECT_EQ(net::OK,
               read_callback.GetResult(dict->ReadAll(read_callback.callback())));
-    EXPECT_EQ(kTestData1,
-              std::string(reinterpret_cast<const char*>(dict->data()->data()),
-                          dict->size()));
+    EXPECT_EQ(
+        kTestData1,
+        std::string(reinterpret_cast<const char*>(dict->data()->data().data()),
+                    dict->size()));
 
     {
       const auto& dictionary_map = GetOnDiskDictionaryMap(storage.get());
@@ -1003,9 +1012,10 @@ TEST_F(SharedDictionaryManagerOnDiskTest, ClearData) {
     net::TestCompletionCallback read_callback;
     EXPECT_EQ(net::OK,
               read_callback.GetResult(dict->ReadAll(read_callback.callback())));
-    EXPECT_EQ(kTestData2,
-              std::string(reinterpret_cast<const char*>(dict->data()->data()),
-                          dict->size()));
+    EXPECT_EQ(
+        kTestData2,
+        std::string(reinterpret_cast<const char*>(dict->data()->data().data()),
+                    dict->size()));
     // Releasing `dict`, `storage` and `manager`.
   }
   // FlushCacheTasks() to finish the persistence operation.
@@ -1149,9 +1159,10 @@ TEST_F(SharedDictionaryManagerOnDiskTest, ClearDataForIsolationKey) {
     net::TestCompletionCallback read_callback;
     EXPECT_EQ(net::OK,
               read_callback.GetResult(dict->ReadAll(read_callback.callback())));
-    EXPECT_EQ(kTestData1,
-              std::string(reinterpret_cast<const char*>(dict->data()->data()),
-                          dict->size()));
+    EXPECT_EQ(
+        kTestData1,
+        std::string(reinterpret_cast<const char*>(dict->data()->data().data()),
+                    dict->size()));
     // Releasing `dict`, `storage` and `manager`.
   }
   // FlushCacheTasks() to finish the persistence operation.
diff --git a/services/network/shared_dictionary/shared_dictionary_manager_unittest.cc b/services/network/shared_dictionary/shared_dictionary_manager_unittest.cc
index 5566f2b1d247e..f6305e3a482c2 100644
--- a/services/network/shared_dictionary/shared_dictionary_manager_unittest.cc
+++ b/services/network/shared_dictionary/shared_dictionary_manager_unittest.cc
@@ -119,9 +119,10 @@ void CheckDiskCacheEntryDataEquals(
             read_callback.GetResult(entry->ReadData(
                 /*index=*/1, /*offset=*/0, read_buffer.get(),
                 expected_data.size(), read_callback.callback())));
-  EXPECT_EQ(expected_data,
-            std::string(reinterpret_cast<const char*>(read_buffer->data()),
-                        read_buffer->size()));
+  EXPECT_EQ(
+      expected_data,
+      std::string(reinterpret_cast<const char*>(read_buffer->data().data()),
+                  read_buffer->size()));
 }
 
 void WriteDictionary(
@@ -1146,7 +1147,8 @@ TEST_P(SharedDictionaryManagerTest, WriteAndReadDictionary) {
   }
 
   ASSERT_TRUE(dict->data());
-  EXPECT_EQ(data1 + data2, std::string(dict->data()->data(), dict->size()));
+  EXPECT_EQ(data1 + data2,
+            std::string(dict->data()->data().data(), dict->size()));
 
   switch (GetManagerType()) {
     case TestManagerType::kInMemory: {
@@ -1170,7 +1172,7 @@ TEST_P(SharedDictionaryManagerTest, WriteAndReadDictionary) {
       EXPECT_EQ(net::OK, dictionary_info.dictionary()->ReadAll(
                              base::BindOnce([](int) { NOTREACHED(); })));
       EXPECT_EQ(data1 + data2,
-                std::string(dictionary_info.dictionary()->data()->data(),
+                std::string(dictionary_info.dictionary()->data()->data().data(),
                             dictionary_info.size()));
       EXPECT_EQ(sha256, dictionary_info.dictionary()->hash());
       break;
@@ -1224,7 +1226,8 @@ TEST_P(SharedDictionaryManagerTest, LongestMatchDictionaryWin) {
   net::TestCompletionCallback read_callback;
   EXPECT_EQ(net::OK,
             read_callback.GetResult(dict->ReadAll(read_callback.callback())));
-  EXPECT_EQ("Longer match", std::string(dict->data()->data(), dict->size()));
+  EXPECT_EQ("Longer match",
+            std::string(dict->data()->data().data(), dict->size()));
 }
 
 TEST_P(SharedDictionaryManagerTest, LastFetchedDictionaryWin) {
@@ -1255,7 +1258,7 @@ TEST_P(SharedDictionaryManagerTest, LastFetchedDictionaryWin) {
               read_callback.GetResult(dict->ReadAll(read_callback.callback())));
     // The last fetched time of "Dict 2" is later than the last fetched time of
     // "Dict 1", so "Dict 2" should be returned.
-    EXPECT_EQ("Dict 2", std::string(dict->data()->data(), dict->size()));
+    EXPECT_EQ("Dict 2", std::string(dict->data()->data().data(), dict->size()));
   }
 
   task_environment_.FastForwardBy(base::Seconds(1));
@@ -1294,7 +1297,7 @@ TEST_P(SharedDictionaryManagerTest, LastFetchedDictionaryWin) {
               read_callback.GetResult(dict->ReadAll(read_callback.callback())));
     // The last fetched time of "Dict 1" is later than the last fetched time of
     // "Dict 2", so "Dict 1" should be returned.
-    EXPECT_EQ("Dict 1", std::string(dict->data()->data(), dict->size()));
+    EXPECT_EQ("Dict 1", std::string(dict->data()->data().data(), dict->size()));
   }
 }
 
@@ -1984,9 +1987,10 @@ TEST_P(SharedDictionaryManagerTest, ClearDataDoNotInvalidateActiveDictionary) {
   net::TestCompletionCallback read_callback;
   EXPECT_EQ(net::OK,
             read_callback.GetResult(dict->ReadAll(read_callback.callback())));
-  EXPECT_EQ(kTestData2,
-            std::string(reinterpret_cast<const char*>(dict->data()->data()),
-                        dict->size()));
+  EXPECT_EQ(
+      kTestData2,
+      std::string(reinterpret_cast<const char*>(dict->data()->data().data()),
+                  dict->size()));
 }
 
 TEST_P(SharedDictionaryManagerTest, ClearDataForIsolationKey) {
diff --git a/services/network/shared_dictionary/shared_dictionary_on_disk_unittest.cc b/services/network/shared_dictionary/shared_dictionary_on_disk_unittest.cc
index ed22d44ba5266..932b5c4b8eebd 100644
--- a/services/network/shared_dictionary/shared_dictionary_on_disk_unittest.cc
+++ b/services/network/shared_dictionary/shared_dictionary_on_disk_unittest.cc
@@ -113,11 +113,11 @@ TEST(SharedDictionaryOnDiskTest, AsyncOpenEntryAsyncReadData) {
       .Run(disk_cache::EntryResult::MakeOpened(entry.release()));
   ASSERT_TRUE(buffer);
   ASSERT_TRUE(read_all_callback);
-  memcpy(buffer->data(), kTestData.c_str(), kTestData.size());
+  memcpy(buffer->data().data(), kTestData.c_str(), kTestData.size());
   std::move(read_all_callback).Run(base::checked_cast<int>(expected_size));
   EXPECT_TRUE(read_all_finished);
   EXPECT_EQ(kTestData,
-            std::string(dictionary->data()->data(), dictionary->size()));
+            std::string(dictionary->data()->data().data(), dictionary->size()));
 
   // ReadAll() synchronously returns OK now.
   EXPECT_EQ(net::OK, dictionary->ReadAll(base::BindLambdaForTesting(
@@ -173,11 +173,11 @@ TEST(SharedDictionaryOnDiskTest, SyncOpenEntryAsyncReadData) {
 
   ASSERT_TRUE(buffer);
   ASSERT_TRUE(read_all_callback);
-  memcpy(buffer->data(), kTestData.c_str(), kTestData.size());
+  memcpy(buffer->data().data(), kTestData.c_str(), kTestData.size());
   std::move(read_all_callback).Run(base::checked_cast<int>(expected_size));
   EXPECT_TRUE(read_all_finished);
   EXPECT_EQ(kTestData,
-            std::string(dictionary->data()->data(), dictionary->size()));
+            std::string(dictionary->data()->data().data(), dictionary->size()));
 
   // ReadAll() synchronously returns OK now.
   EXPECT_EQ(net::OK, dictionary->ReadAll(base::BindLambdaForTesting(
@@ -214,7 +214,7 @@ TEST(SharedDictionaryOnDiskTest, AsyncOpenEntrySyncReadData) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(expected_size), buf_len);
-        memcpy(buf->data(), kTestData.c_str(), kTestData.size());
+        memcpy(buf->data().data(), kTestData.c_str(), kTestData.size());
         return base::checked_cast<int>(expected_size);
       });
 
@@ -235,7 +235,7 @@ TEST(SharedDictionaryOnDiskTest, AsyncOpenEntrySyncReadData) {
       .Run(disk_cache::EntryResult::MakeOpened(entry.release()));
   EXPECT_TRUE(read_all_finished);
   EXPECT_EQ(kTestData,
-            std::string(dictionary->data()->data(), dictionary->size()));
+            std::string(dictionary->data()->data().data(), dictionary->size()));
 
   // ReadAll() synchronously returns OK now.
   EXPECT_EQ(net::OK, dictionary->ReadAll(base::BindLambdaForTesting(
@@ -264,7 +264,7 @@ TEST(SharedDictionaryOnDiskTest, SyncOpenEntrySyncReadData) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(expected_size), buf_len);
-        memcpy(buf->data(), kTestData.c_str(), kTestData.size());
+        memcpy(buf->data().data(), kTestData.c_str(), kTestData.size());
         return base::checked_cast<int>(expected_size);
       });
 
@@ -283,7 +283,7 @@ TEST(SharedDictionaryOnDiskTest, SyncOpenEntrySyncReadData) {
   EXPECT_EQ(net::OK, dictionary->ReadAll(base::BindLambdaForTesting(
                          [&](int rv) { ASSERT_TRUE(false); })));
   EXPECT_EQ(kTestData,
-            std::string(dictionary->data()->data(), dictionary->size()));
+            std::string(dictionary->data()->data().data(), dictionary->size()));
 }
 
 TEST(SharedDictionaryOnDiskTest, AsyncOpenEntryFailure) {
diff --git a/services/network/shared_dictionary/shared_dictionary_writer_in_memory.cc b/services/network/shared_dictionary/shared_dictionary_writer_in_memory.cc
index 74bf6a7239029..d5b806f52a38b 100644
--- a/services/network/shared_dictionary/shared_dictionary_writer_in_memory.cc
+++ b/services/network/shared_dictionary/shared_dictionary_writer_in_memory.cc
@@ -70,7 +70,8 @@ void SharedDictionaryWriterInMemory::Finish() {
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(total_size_);
   size_t written_size = 0;
   for (const auto& item : data_) {
-    memcpy(buffer->data() + written_size, item.c_str(), item.size());
+    memcpy(buffer->data().subspan(written_size).data(), item.c_str(),
+           item.size());
     written_size += item.size();
   }
 
diff --git a/services/network/shared_dictionary/shared_dictionary_writer_in_memory_unittest.cc b/services/network/shared_dictionary/shared_dictionary_writer_in_memory_unittest.cc
index 96bcc10332cbe..0a511a557ff29 100644
--- a/services/network/shared_dictionary/shared_dictionary_writer_in_memory_unittest.cc
+++ b/services/network/shared_dictionary/shared_dictionary_writer_in_memory_unittest.cc
@@ -41,10 +41,9 @@ TEST(SharedDictionaryWriterInMemory, SimpleWrite) {
                   const net::SHA256HashValue& hash) {
                 EXPECT_EQ(SharedDictionaryWriterInMemory::Result::kSuccess,
                           result);
-                EXPECT_EQ(
-                    kTestData,
-                    std::string(reinterpret_cast<const char*>(buffer->data()),
-                                size));
+                EXPECT_EQ(kTestData, std::string(reinterpret_cast<const char*>(
+                                                     buffer->data().data()),
+                                                 size));
                 EXPECT_EQ(GetHash(kTestData), hash);
                 finish_callback_called = true;
               }));
@@ -63,10 +62,10 @@ TEST(SharedDictionaryWriterInMemory, MultipleWrite) {
                   const net::SHA256HashValue& hash) {
                 EXPECT_EQ(SharedDictionaryWriterInMemory::Result::kSuccess,
                           result);
-                EXPECT_EQ(
-                    kTestData1 + kTestData2,
-                    std::string(reinterpret_cast<const char*>(buffer->data()),
-                                size));
+                EXPECT_EQ(kTestData1 + kTestData2,
+                          std::string(reinterpret_cast<const char*>(
+                                          buffer->data().data()),
+                                      size));
                 EXPECT_EQ(GetHash(kTestData1 + kTestData2), hash);
                 finish_callback_called = true;
               }));
diff --git a/services/network/shared_dictionary/shared_dictionary_writer_on_disk_unittest.cc b/services/network/shared_dictionary/shared_dictionary_writer_on_disk_unittest.cc
index fe85079ad2ee3..89964c90aad52 100644
--- a/services/network/shared_dictionary/shared_dictionary_writer_on_disk_unittest.cc
+++ b/services/network/shared_dictionary/shared_dictionary_writer_on_disk_unittest.cc
@@ -156,9 +156,9 @@ void SharedDictionaryWriterOnDiskTest::RunSimpleWriteTest(
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData.size()), buf_len);
-        EXPECT_EQ(
-            kTestData,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         if (sync_write_data) {
           return base::checked_cast<int>(kTestData.size());
         }
@@ -359,9 +359,9 @@ void SharedDictionaryWriterOnDiskTest::RunWriteDataFailureTest(
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData.size()), buf_len);
-        EXPECT_EQ(
-            kTestData,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         if (sync_write_data) {
           return net::ERR_FAILED;
         }
@@ -454,9 +454,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, MultipleWrite) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), buf_len);
-        EXPECT_EQ(
-            kTestData1,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData1,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         write_data_callback1 = std::move(callback);
         return net::ERR_IO_PENDING;
       })
@@ -466,9 +466,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, MultipleWrite) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData2.size()), buf_len);
-        EXPECT_EQ(
-            kTestData2,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData2,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         write_data_callback2 = std::move(callback);
         return net::ERR_IO_PENDING;
       });
@@ -530,9 +530,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, MultipleWriteSyncWrite) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), buf_len);
-        EXPECT_EQ(
-            kTestData1,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData1,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         return base::checked_cast<int>(kTestData1.size());
       })
       .WillOnce([&](int index, int offset, net::IOBuffer* buf, int buf_len,
@@ -541,9 +541,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, MultipleWriteSyncWrite) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData2.size()), buf_len);
-        EXPECT_EQ(
-            kTestData2,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData2,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         return base::checked_cast<int>(kTestData2.size());
       });
 
@@ -601,9 +601,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, AsyncWriteFailureOnMultipleWrites) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), buf_len);
-        EXPECT_EQ(
-            kTestData1,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData1,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         write_data_callback1 = std::move(callback);
         return net::ERR_IO_PENDING;
       })
@@ -613,9 +613,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, AsyncWriteFailureOnMultipleWrites) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData2.size()), buf_len);
-        EXPECT_EQ(
-            kTestData2,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData2,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         write_data_callback2 = std::move(callback);
         return net::ERR_IO_PENDING;
       });
@@ -677,9 +677,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, SyncWriteFailureOnMultipleWrites) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), buf_len);
-        EXPECT_EQ(
-            kTestData1,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData1,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         return net::ERR_FAILED;
       });
 
@@ -932,9 +932,9 @@ TEST_F(SharedDictionaryWriterOnDiskTest, ErrorSizeExceedsLimitAfterOnEntry) {
         EXPECT_EQ(1, index);
         EXPECT_EQ(0, offset);
         EXPECT_EQ(base::checked_cast<int>(kTestData1.size()), buf_len);
-        EXPECT_EQ(
-            kTestData1,
-            std::string(reinterpret_cast<const char*>(buf->data()), buf_len));
+        EXPECT_EQ(kTestData1,
+                  std::string(reinterpret_cast<const char*>(buf->data().data()),
+                              buf_len));
         write_data_callback = std::move(callback);
         return net::ERR_IO_PENDING;
       });
diff --git a/services/network/udp_socket.cc b/services/network/udp_socket.cc
index fd6d45b22874b..c95c9897432f2 100644
--- a/services/network/udp_socket.cc
+++ b/services/network/udp_socket.cc
@@ -384,7 +384,7 @@ void UDPSocket::DoSendToOrWrite(
   // |data| points to a range of bytes in the received message and will be
   // freed when this method returns, so copy out the bytes now.
   auto buffer = base::MakeRefCounted<net::IOBufferWithSize>(data.size());
-  memcpy(buffer.get()->data(), data.data(), data.size());
+  memcpy(buffer.get()->data().data(), data.data(), data.size());
 
   if (send_buffer_.get()) {
     auto request = std::make_unique<PendingSendRequest>();
@@ -437,7 +437,7 @@ void UDPSocket::OnRecvFromCompleted(uint32_t buffer_size, int net_result) {
         net::OK,
         is_bound_ ? std::make_optional(recvfrom_address_) : std::nullopt,
         base::span<const uint8_t>(
-            reinterpret_cast<const uint8_t*>(recvfrom_buffer_->data()),
+            reinterpret_cast<const uint8_t*>(recvfrom_buffer_->data().data()),
             static_cast<size_t>(net_result)));
   } else {
     listener_->OnReceived(net_result, std::nullopt, std::nullopt);
diff --git a/services/network/udp_socket_unittest.cc b/services/network/udp_socket_unittest.cc
index 5c1a8cb5358b5..92b4108d81a3f 100644
--- a/services/network/udp_socket_unittest.cc
+++ b/services/network/udp_socket_unittest.cc
@@ -117,8 +117,8 @@ class HangingUDPSocket : public SocketWrapperTestImpl {
       const net::IPEndPoint& address,
       net::CompletionOnceCallback callback,
       const net::NetworkTrafficAnnotationTag& traffic_annotation) override {
-    EXPECT_EQ(expected_data_,
-              std::vector<unsigned char>(buf->data(), buf->data() + buf_len));
+    EXPECT_EQ(expected_data_, std::vector<unsigned char>(
+                                  buf->data().data(), buf->data() + buf_len));
     if (should_complete_requests_)
       return net::OK;
     pending_io_buffers_.push_back(buf);
@@ -350,8 +350,8 @@ TEST_F(UDPSocketTest, TestBufferValid) {
   // and that buffer still contains the exact same data.
   net::IOBuffer* buf = socket_raw_ptr->pending_io_buffers()[0];
   int buf_len = socket_raw_ptr->pending_io_buffer_lengths()[0];
-  EXPECT_EQ(test_msg,
-            std::vector<unsigned char>(buf->data(), buf->data() + buf_len));
+  EXPECT_EQ(test_msg, std::vector<unsigned char>(buf->data().data(),
+                                                 buf->data() + buf_len));
 }
 
 // Test that exercises the queuing of send requests and makes sure
diff --git a/services/network/url_loader_unittest.cc b/services/network/url_loader_unittest.cc
index 1a08dee871c34..0cc9ef48b1095 100644
--- a/services/network/url_loader_unittest.cc
+++ b/services/network/url_loader_unittest.cc
@@ -243,7 +243,7 @@ class URLRequestMultipleWritesJob : public net::URLRequestJob {
       std::string packet = packets_.front();
       packets_.pop_front();
       CHECK_GE(buf_size, static_cast<int>(packet.length()));
-      memcpy(buf->data(), packet.c_str(), packet.length());
+      memcpy(buf->data().data(), packet.c_str(), packet.length());
       result = packet.length();
     }
 
@@ -323,7 +323,7 @@ class URLRequestEternalSyncReadsJob : public net::URLRequestJob {
   int ReadRawData(net::IOBuffer* buf, int buf_size) override {
     DCHECK_GT(buf_size, 0);
     if (fill_entire_buffer_) {
-      memset(buf->data(), 'a', buf_size);
+      memset(buf->data().data(), 'a', buf_size);
       return buf_size;
     }
 
@@ -412,7 +412,7 @@ class URLRequestSimulatedCacheJob : public net::URLRequestJob {
 
     // Pretend this is the entire network stack, which has sent the buffer
     // to some worker thread to be written to disk.
-    memset(buf->data(), 'a', buf_size);
+    memset(buf->data().data(), 'a', buf_size);
     *simulated_cache_dest_ = buf;
 
     // The network stack will not report the read result until the write
diff --git a/storage/browser/blob/blob_reader.cc b/storage/browser/blob/blob_reader.cc
index 94b4376bb19df..eb53b9cdbb97b 100644
--- a/storage/browser/blob/blob_reader.cc
+++ b/storage/browser/blob/blob_reader.cc
@@ -556,7 +556,7 @@ void BlobReader::ReadBytesItem(const BlobDataItem& item, int bytes_to_read) {
   TRACE_EVENT1("Blob", "BlobReader::ReadBytesItem", "uuid", blob_data_->uuid());
   DCHECK_GE(read_buf_->BytesRemaining(), bytes_to_read);
 
-  memcpy(read_buf_->data(),
+  memcpy(read_buf_->data().data(),
          item.bytes().data() + item.offset() + current_item_offset_,
          bytes_to_read);
 
diff --git a/storage/browser/blob/blob_reader_unittest.cc b/storage/browser/blob/blob_reader_unittest.cc
index 2fdbb10f05a63..144f28659aaab 100644
--- a/storage/browser/blob/blob_reader_unittest.cc
+++ b/storage/browser/blob/blob_reader_unittest.cc
@@ -157,7 +157,7 @@ class FakeFileStreamReader : public FileStreamReader {
                net::CompletionOnceCallback done) {
     CHECK_GE(buf_length, 0);
     int length = std::min(buf_length, buffer_->BytesRemaining());
-    memcpy(buf->data(), buffer_->data(), length);
+    memcpy(buf->data().data(), buffer_->data().data(), length);
     buffer_->DidConsume(length);
     if (done.is_null()) {
       return length;
@@ -327,7 +327,7 @@ TEST_F(BlobReaderTest, BasicMemory) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kDataSize, static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "Hello!!!", kDataSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "Hello!!!", kDataSize));
 }
 
 TEST_F(BlobReaderTest, BasicFile) {
@@ -358,7 +358,7 @@ TEST_F(BlobReaderTest, BasicFile) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kData.size(), static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "FileData!!!", kData.size()));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "FileData!!!", kData.size()));
 }
 
 TEST_F(BlobReaderTest, BasicFileSystem) {
@@ -392,7 +392,7 @@ TEST_F(BlobReaderTest, BasicFileSystem) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kData.size(), static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "FileData!!!", kData.size()));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "FileData!!!", kData.size()));
 }
 
 TEST_F(BlobReaderTest, BasicReadableDataHandle) {
@@ -420,7 +420,7 @@ TEST_F(BlobReaderTest, BasicReadableDataHandle) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kData.size(), static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "Test Blob Data", kData.size()));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "Test Blob Data", kData.size()));
 }
 
 TEST_F(BlobReaderTest, ReadableDataHandleWithSideData) {
@@ -474,7 +474,7 @@ TEST_F(BlobReaderTest, BufferLargerThanMemory) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kDataSize, static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "Hello!!!", kDataSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "Hello!!!", kDataSize));
 }
 
 TEST_F(BlobReaderTest, MemoryRange) {
@@ -503,7 +503,7 @@ TEST_F(BlobReaderTest, MemoryRange) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kReadLength, static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "llo!", kReadLength));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "llo!", kReadLength));
 }
 
 TEST_F(BlobReaderTest, BufferSmallerThanMemory) {
@@ -529,7 +529,7 @@ TEST_F(BlobReaderTest, BufferSmallerThanMemory) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kBufferSize, static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "Hell", kBufferSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "Hell", kBufferSize));
 
   bytes_read = 0;
   EXPECT_EQ(BlobReader::Status::DONE,
@@ -538,7 +538,7 @@ TEST_F(BlobReaderTest, BufferSmallerThanMemory) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kBufferSize, static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "o!!!", kBufferSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "o!!!", kBufferSize));
 }
 
 TEST_F(BlobReaderTest, SegmentedBufferAndMemory) {
@@ -617,7 +617,7 @@ TEST_F(BlobReaderTest, FileAsync) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kData.size(), static_cast<size_t>(async_bytes_read));
   EXPECT_EQ(0, bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "FileData!!!", kData.size()));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "FileData!!!", kData.size()));
 }
 
 TEST_F(BlobReaderTest, FileSystemAsync) {
@@ -657,7 +657,7 @@ TEST_F(BlobReaderTest, FileSystemAsync) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kData.size(), static_cast<size_t>(async_bytes_read));
   EXPECT_EQ(0, bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "FileData!!!", kData.size()));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "FileData!!!", kData.size()));
 }
 
 TEST_F(BlobReaderTest, ReadableDataHandleSingle) {
@@ -792,7 +792,7 @@ TEST_F(BlobReaderTest, ReadableDataHandleMultipleSlices) {
   EXPECT_EQ(0, async_bytes_read);
   EXPECT_EQ(kData.size(), static_cast<size_t>(bytes_read));
 
-  EXPECT_EQ(0, memcmp(buffer->data(), kData.data(), kData.size()));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), kData.data(), kData.size()));
 }
 
 TEST_F(BlobReaderTest, FileRange) {
@@ -837,7 +837,7 @@ TEST_F(BlobReaderTest, FileRange) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kReadLength, static_cast<size_t>(async_bytes_read));
   EXPECT_EQ(0, bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "leD", kReadLength));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "leD", kReadLength));
 }
 
 TEST_F(BlobReaderTest, ReadableDataHandleRange) {
@@ -865,7 +865,7 @@ TEST_F(BlobReaderTest, ReadableDataHandleRange) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kReadLength, static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(0, memcmp(buffer->data(), "st ", kReadLength));
+  EXPECT_EQ(0, memcmp(buffer->data().data(), "st ", kReadLength));
 }
 
 TEST_F(BlobReaderTest, FileSomeAsyncSegmentedOffsetsUnknownSizes) {
@@ -992,8 +992,8 @@ TEST_F(BlobReaderTest, MixedContent) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(0, bytes_read);
   EXPECT_EQ(kDataSize, static_cast<size_t>(async_bytes_read));
-  EXPECT_EQ(0, memcmp(buffer->data(), "Hello there. This is multi-content.",
-                      kDataSize));
+  EXPECT_EQ(0, memcmp(buffer->data().data(),
+                      "Hello there. This is multi-content.", kDataSize));
 }
 
 TEST_F(BlobReaderTest, StateErrors) {
@@ -1216,7 +1216,7 @@ TEST_F(BlobReaderTest, ReadFromIncompleteBlob) {
   EXPECT_EQ(net::OK, reader_->net_error());
   EXPECT_EQ(kDataSize, static_cast<size_t>(bytes_read));
   EXPECT_EQ(0, async_bytes_read);
-  EXPECT_EQ(kData, std::string(buffer->data(), kDataSize));
+  EXPECT_EQ(kData, std::string(buffer->data().data(), kDataSize));
   EXPECT_EQ(net::OK, size_result);
 }
 
diff --git a/storage/browser/file_system/file_stream_test_utils.cc b/storage/browser/file_system/file_stream_test_utils.cc
index 0db5f33aea4d1..2412dd69dd159 100644
--- a/storage/browser/file_system/file_stream_test_utils.cc
+++ b/storage/browser/file_system/file_stream_test_utils.cc
@@ -36,7 +36,7 @@ base::expected<std::string, net::Error> ReadFromReader(FileStreamReader& reader,
       break;
     }
     total_bytes_read += rv;
-    result.append(buf->data(), rv);
+    result.append(buf->data().data(), rv);
   }
   return result;
 }
diff --git a/storage/browser/file_system/memory_file_stream_writer_unittest.cc b/storage/browser/file_system/memory_file_stream_writer_unittest.cc
index 342ad0b246705..53ffa9a243cf6 100644
--- a/storage/browser/file_system/memory_file_stream_writer_unittest.cc
+++ b/storage/browser/file_system/memory_file_stream_writer_unittest.cc
@@ -72,7 +72,7 @@ class MemoryFileStreamWriterTest : public FileStreamWriterTest {
     EXPECT_EQ(info.size,
               file_util_->ReadFile(path, 0, content.get(), info.size));
 
-    return std::string(content->data(), info.size);
+    return std::string(content->data().data(), info.size);
   }
 
  private:
diff --git a/storage/browser/file_system/obfuscated_file_util_memory_delegate.cc b/storage/browser/file_system/obfuscated_file_util_memory_delegate.cc
index c2dd737969319..7207941468fef 100644
--- a/storage/browser/file_system/obfuscated_file_util_memory_delegate.cc
+++ b/storage/browser/file_system/obfuscated_file_util_memory_delegate.cc
@@ -576,15 +576,17 @@ int ObfuscatedFileUtilMemoryDelegate::WriteFile(
   }
 
   if (offset_u == dp->entry->file_content.size()) {
-    dp->entry->file_content.insert(dp->entry->file_content.end(), buf->data(),
-                                   buf->data() + buf_len);
+    dp->entry->file_content.insert(dp->entry->file_content.end(),
+                                   buf->data().data(),
+                                   buf->data().subspan(buf_len).data());
   } else {
     if (last_position > dp->entry->file_content.size())
       dp->entry->file_content.resize(last_position);
 
     // if |offset_u| is larger than the original file size, there will be null
     // bytes between the end of the file and |offset_u|.
-    memcpy(dp->entry->file_content.data() + offset, buf->data(), buf_len);
+    memcpy(dp->entry->file_content.data() + offset, buf->data().data(),
+           buf_len);
   }
   return buf_len;
 }
diff --git a/storage/browser/file_system/obfuscated_file_util_memory_delegate_unittest.cc b/storage/browser/file_system/obfuscated_file_util_memory_delegate_unittest.cc
index 097da6cac7127..55c24bb81376c 100644
--- a/storage/browser/file_system/obfuscated_file_util_memory_delegate_unittest.cc
+++ b/storage/browser/file_system/obfuscated_file_util_memory_delegate_unittest.cc
@@ -354,7 +354,7 @@ TEST_F(ObfuscatedFileUtilMemoryDelegateTest, CopyForeignFile) {
   EXPECT_EQ(test_data_len, file_util()->ReadFile(valid_to_file, 0,
                                                  content.get(), test_data_len));
   EXPECT_EQ(std::string(test_data),
-            std::string(content->data(), test_data_len));
+            std::string(content->data().data(), test_data_len));
 }
 
 TEST_F(ObfuscatedFileUtilMemoryDelegateTest, CopyFileNonExistingFile) {
diff --git a/ui/base/webui/i18n_source_stream.cc b/ui/base/webui/i18n_source_stream.cc
index f4319c4e1b380..acb19dd10f4cd 100644
--- a/ui/base/webui/i18n_source_stream.cc
+++ b/ui/base/webui/i18n_source_stream.cc
@@ -42,7 +42,7 @@ base::expected<size_t, net::Error> I18nSourceStream::FilterData(
     size_t* consumed_bytes,
     bool upstream_end_reached) {
   // |input_| is often empty (or it may have something from the prior call).
-  input_.append(input_buffer->data(), input_buffer_size);
+  input_.append(input_buffer->data().data(), input_buffer_size);
   *consumed_bytes = input_buffer_size;
 
   // The replacement tag starts with '$' and ends with '}'. The white-space
@@ -62,7 +62,7 @@ base::expected<size_t, net::Error> I18nSourceStream::FilterData(
 
   output_.append(ReplaceTemplateExpressions(to_process, *replacements_));
   size_t bytes_out = std::min(output_.size(), output_buffer_size);
-  output_.copy(output_buffer->data(), bytes_out);
+  output_.copy(output_buffer->data().data(), bytes_out);
   output_.erase(0, bytes_out);
   return bytes_out;
 }
```

## Build Failure Log

```

11.53s Build Failure: 1 done 1 failed 53943 remaining - 0.09/s
 1 steps failed: exit=1
see ./out/linux/siso_output for full command line and output
 or ./out/linux/siso.INFO
use ./out/linux/siso_failed_commands.sh to re-run failed commands
real	0m11.827s
user	1m30.028s
sys	0m35.002s
ninja: Entering directory `out/linux'
init credentials done 38.53712ms
reapi instance: projects/rbe-chrome-untrusted/instances/default_instance
loading fs state done 1.157925844s
loading/recompacting deps log done 1.283420958s
load siso config done 82.088236ms
load build.ninja done 687.24835ms
schedule pending:0+ready:1 (node:310590 edge:2)
build start: Ready 1 Pending 1
rebuild manifest finished	
schedule pending:0+ready:1 (node:310590 edge:9)
build start: Ready 15287 Pending 102644
FAILED: 017f4b17-aba1-4e5f-82c6-7d7d792238c1 "./obj/net/dns/dns/mdns_cache.o" CXX obj/net/dns/dns/mdns_cache.o
err: exit=1
../../third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/net/dns/dns/mdns_cache.o.d -DDCHECK_ALWAYS_ON=1 -DUSE_UDEV -DUSE_AURA=1 -DUSE_GLIB=1 -DUSE_OZONE=1 -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_GNU_SOURCE -DCR_CLANG_REVISION=\"llvmorg-21-init-5118-g52cd27e6-2\" -D_LIBCPP_HARDENING_MODE=_LIBCPP_HARDENING_MODE_EXTENSIVE -DCOMPONENT_BUILD -D_LIBCPP_INSTRUMENTED_WITH_ASAN=0 -DCR_LIBCXX_REVISION=4f05e20cbe1d02fa0871ac88b30eead9e38cab3a -DTMP_REBUILD_HACK -DCR_SYSROOT_KEY=20250129T203412Z-1 -D_DEBUG -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DGLIB_VERSION_MAX_ALLOWED=GLIB_VERSION_2_56 -DGLIB_VERSION_MIN_REQUIRED=GLIB_VERSION_2_56 -DGOOGLE_PROTOBUF_NO_RTTI -DHAVE_PTHREAD -DPROTOBUF_USE_DLLS -DABSL_CONSUME_DLL -DABSL_FLAGS_STRIP_NAMES=0 -DCR_CXX_INCLUDE=\"third_party/rust/chromium_crates_io/vendor/cxx-1.0.146/include/cxx.h\" -DBORINGSSL_SHARED_LIBRARY -DNET_IMPLEMENTATION -DENABLE_BUILT_IN_DNS -DUSE_GIO -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DUSE_CHROMIUM_ICU=1 -DU_ENABLE_TRACING=1 -DU_ENABLE_RESOURCE_TRACING=0 -DICU_UTIL_DATA_IMPL=ICU_UTIL_DATA_FILE -I../.. -Igen -I../../buildtools/third_party/libc++ -I../../third_party/perfetto/include -Igen/third_party/perfetto/build_config -Igen/third_party/perfetto -I../../net/third_party/quiche/overrides -I../../net/third_party/quiche/src/quiche/common/platform/default -I../../net/third_party/quiche/src -I../../third_party/protobuf/src -I../../third_party/abseil-cpp -I../../base/allocator/partition_allocator/src -Igen/base/allocator/partition_allocator/src -I../../third_party/boringssl/src/include -Igen/net/third_party/quiche/src -I../../third_party/zlib -I../../third_party/ced/src -I../../third_party/icu/source/common -I../../third_party/icu/source/i18n -I../../third_party/brotli/include -Wall -Wextra -Wimplicit-fallthrough -Wextra-semi -Wunreachable-code-aggressive -Wthread-safety -Wgnu -Wno-gnu-anonymous-struct -Wno-gnu-conditional-omitted-operand -Wno-gnu-include-next -Wno-gnu-label-as-value -Wno-gnu-redeclared-enum -Wno-gnu-statement-expression -Wno-gnu-zero-variadic-macro-arguments -Wno-zero-length-array -Wno-missing-field-initializers -Wno-unused-parameter -Wno-psabi -Wloop-analysis -Wno-unneeded-internal-declaration -Wno-cast-function-type -Wno-thread-safety-reference-return -Wno-nontrivial-memcall -Wshadow -Werror -fno-delete-null-pointer-checks -fno-strict-overflow -fno-ident -fno-strict-aliasing -fstack-protector -funwind-tables -fPIC -pthread -fcolor-diagnostics -fmerge-all-constants -fno-sized-deallocation -fcrash-diagnostics-dir=../../tools/clang/crashreports -mllvm -instcombine-lower-dbg-declare=0 -mllvm -split-threshold-for-reg-with-hint=0 -ffp-contract=off -Wa,--crel,--allow-experimental-crel -fcomplete-member-pointers -m64 -msse3 -Wno-builtin-macro-redefined -D__DATE__= -D__TIME__= -D__TIMESTAMP__= -ffile-compilation-dir=. -no-canonical-prefixes -ftrivial-auto-var-init=pattern -O0 -fno-omit-frame-pointer -gdwarf-4 -g2 -gdwarf-aranges -gsplit-dwarf -ggnu-pubnames -Xclang -fuse-ctor-homing -fvisibility=hidden -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -Xclang -add-plugin -Xclang find-bad-constructs -Xclang -plugin-arg-find-bad-constructs -Xclang span-ctor-from-string-literal -Xclang -plugin-arg-find-bad-constructs -Xclang raw-ref-template-as-trivial-member -Xclang -plugin-arg-find-bad-constructs -Xclang raw-span-template-as-trivial-member -Xclang -plugin-arg-find-bad-constructs -Xclang check-stack-allocated -Xclang -plugin-arg-find-bad-constructs -Xclang check-ipc -Xclang -add-plugin -Xclang raw-ptr-plugin -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-raw-ptr-to-stack-allocated -Xclang -plugin-arg-raw-ptr-plugin -Xclang disable-check-raw-ptr-to-stack-allocated-error -Xclang -plugin-arg-raw-ptr-plugin -Xclang raw-ptr-exclude-path=../../third_party/dawn/ -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-raw-ptr-fields -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-span-fields -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-raw-ref-fields -DUNSAFE_BUFFERS_BUILD -Xclang -add-plugin -Xclang unsafe-buffers -Xclang -plugin-arg-unsafe-buffers -Xclang ../../build/config/unsafe_buffers_paths.txt -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/glib-2.0 -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/lib/x86_64-linux-gnu/glib-2.0/include -Wexit-time-destructors -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/glib-2.0 -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/lib/x86_64-linux-gnu/glib-2.0/include -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/libmount -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/blkid -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/gio-unix-2.0 -Wno-invalid-offsetof -Wenum-compare-conditional -Wno-c++11-narrowing-const-reference -Wno-missing-template-arg-list-after-template-kw -Wno-undefined-bool-conversion -Wno-tautological-undefined-compare -std=c++20 -Wno-trigraphs -gsimple-template-names -fno-exceptions -fno-rtti -nostdinc++ -isystem../../third_party/libc++/src/include -isystem../../third_party/libc++abi/src/include --sysroot=../../build/linux/debian_bullseye_amd64-sysroot -fvisibility-inlines-hidden  -c ../../net/dns/mdns_cache.cc -o obj/net/dns/dns/mdns_cache.o
build step: cxx "./obj/net/dns/dns/mdns_cache.o"
siso_rule: clang/cxx
stderr:
In file included from ../../net/dns/mdns_cache.cc:18:
In file included from ../../net/dns/record_rdata.h:20:
../../net/base/io_buffer.h:97:36: error: reinterpret_cast from 'base::span<uint8_t>' (aka 'span<unsigned char>') to 'char *' is not allowed
   97 |   base::span<char> data() { return reinterpret_cast<char*>(bytes()); }
      |                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1 error generated.
build failed	
local:1 remote:0 cache:0 fallback:0 retry:0 skip:63987
reapi: ops: 242(err:226) / r:0(err:0) 0B / w:8(err:3) 14.44KiB
fs: ops: 16912(err:6534) / r:4068(err:0) 41.44MiB / w:0(err:0) 0B
```
