# Build Failure Analysis: 2025_03_19_patch_606

## First error

Overlapping replacements: ./media/formats/mp4/es_descriptor_unittest.cc at offset 1473, length 14: "(buffer.size() * sizeof(decltype(buffer)::value_type))" and offset 1479, length 0: ".data()"

## Category
Overlapping replacements between RewriteArraySizeof and AppendDataCall.

## Reason
The rewriter is attempting to rewrite `sizeof(buffer)` to `buffer.size() * sizeof(decltype(buffer)::value_type))` and also add `.data()` to the `buffer` variable. The replacements are overlapping because they both want to modify the same region of the code.

## Solution
The rewriter should avoid overlapping replacements. This likely involves ensuring that the replacements generated by RewriteArraySizeof and AppendDataCall do not overlap. If the rewriter is attempting to rewrite `sizeof(buffer)` and also trying to add `.data()` to buffer, it should ensure that the replacements don't overlap. One way to avoid the conflict is to check if buffer is an array before rewriting the size.

## Note
This error message indicates that there are conflicting text replacements being generated by the rewriter. Specifically, the RewriteArraySizeof and AppendDataCall transformations are trying to modify the same region of the source code, leading to the overlapping replacement error.