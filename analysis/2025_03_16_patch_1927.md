# Build Failure: 2025_03_16_patch_1927

## Chromium Revision

`e88b975115b94830474e3ccc5731d1909543c0de`

## Code Changes (Diff)

```diff
diff --git a/gpu/command_buffer/tests/compressed_texture_test.cc b/gpu/command_buffer/tests/compressed_texture_test.cc
index 6cf51c0ffd084..67cfb4c54e209 100644
--- a/gpu/command_buffer/tests/compressed_texture_test.cc
+++ b/gpu/command_buffer/tests/compressed_texture_test.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/40285824): Remove this and convert code to safer constructs.
 #pragma allow_unsafe_buffers
@@ -238,8 +240,7 @@ TEST_P(CompressedTextureTest, Draw) {
     origin[0] = kBlockSize * i;
     ToRGB888(kPalette[i], expected_rgba);
     EXPECT_TRUE(GLTestHelper::CheckPixels(origin[0], origin[1], kBlockSize,
-                                          kBlockSize, 0, expected_rgba,
-                                          nullptr));
+                                          kBlockSize, 0, expected_rgba, {}));
   }
   GLTestHelper::CheckGLError("CompressedTextureTest.Draw", __LINE__);
 }
diff --git a/gpu/command_buffer/tests/gl_angle_shader_pixel_local_storage_unittest.cc b/gpu/command_buffer/tests/gl_angle_shader_pixel_local_storage_unittest.cc
index 78f5894e2795f..fb0488b24d98c 100644
--- a/gpu/command_buffer/tests/gl_angle_shader_pixel_local_storage_unittest.cc
+++ b/gpu/command_buffer/tests/gl_angle_shader_pixel_local_storage_unittest.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/390223051): Remove C-library calls to fix the errors.
 #pragma allow_unsafe_libc_calls
@@ -293,7 +295,7 @@ void main() {
   glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D,
                          tex, 0);
   EXPECT_TRUE(GLTestHelper::CheckPixels(
-      0, 0, 10, 10, 0, std::array<uint8_t, 4>{255, 0, 255, 0}.data(), nullptr));
+      0, 0, 10, 10, 0, std::array<uint8_t, 4>{255, 0, 255, 0}.data(), {}));
 }
 
 // Verifies that the PLS ban on FBO 0 is also enforced when FBO "0" is emulated
diff --git a/gpu/command_buffer/tests/gl_bind_uniform_location_unittest.cc b/gpu/command_buffer/tests/gl_bind_uniform_location_unittest.cc
index 925b5ed32afb7..7fc8d6b7bb09d 100644
--- a/gpu/command_buffer/tests/gl_bind_uniform_location_unittest.cc
+++ b/gpu/command_buffer/tests/gl_bind_uniform_location_unittest.cc
@@ -7,6 +7,7 @@
 #include <GLES2/gl2extchromium.h>
 #include <stdint.h>
 
+#include "base/containers/span.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
 #include "gpu/command_buffer/tests/gl_test_utils.h"
 #include "testing/gmock/include/gmock/gmock.h"
@@ -96,7 +97,7 @@ TEST_P(BindUniformLocationTest, Basic) {
 
   static const uint8_t expected[] = {64, 128, 192, 255};
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kResolution, kResolution, 1,
-                                        expected, nullptr));
+                                        expected, {}));
 
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
@@ -269,7 +270,7 @@ TEST_P(BindUniformLocationTest, MAYBE_Compositor) {
 
   static const uint8_t expected[] = {204, 204, 204, 204};
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kResolution, kResolution, 1,
-                                        expected, nullptr));
+                                        expected, {}));
 
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
diff --git a/gpu/command_buffer/tests/gl_chromium_framebuffer_multisample_unittest.cc b/gpu/command_buffer/tests/gl_chromium_framebuffer_multisample_unittest.cc
index 358fd8d7d59f6..2d650b1435482 100644
--- a/gpu/command_buffer/tests/gl_chromium_framebuffer_multisample_unittest.cc
+++ b/gpu/command_buffer/tests/gl_chromium_framebuffer_multisample_unittest.cc
@@ -7,6 +7,7 @@
 #include <GLES2/gl2extchromium.h>
 #include <stdint.h>
 
+#include "base/containers/span.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
 #include "gpu/command_buffer/tests/gl_test_utils.h"
 #include "testing/gmock/include/gmock/gmock.h"
@@ -144,8 +145,8 @@ TEST_F(GLChromiumFramebufferMultisampleTest, DrawAndResolve) {
   const uint8_t black[] = {0, 0, 0, 0};
   glBindFramebuffer(GL_READ_FRAMEBUFFER, resolve_fbo);
   EXPECT_TRUE(GLTestHelper::CheckPixels(width / 4, (3 * height) / 4, 1, 1, 0,
-                                        green, nullptr));
-  EXPECT_TRUE(GLTestHelper::CheckPixels(width - 1, 0, 1, 1, 0, black, nullptr));
+                                        green, {}));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(width - 1, 0, 1, 1, 0, black, {}));
 }
 
 }  // namespace gpu
diff --git a/gpu/command_buffer/tests/gl_clear_framebuffer_unittest.cc b/gpu/command_buffer/tests/gl_clear_framebuffer_unittest.cc
index 6ae914e77237b..e6fddd6636d6b 100644
--- a/gpu/command_buffer/tests/gl_clear_framebuffer_unittest.cc
+++ b/gpu/command_buffer/tests/gl_clear_framebuffer_unittest.cc
@@ -3,6 +3,8 @@
 // found in the LICENSE file.
 
 #ifndef GL_GLEXT_PROTOTYPES
+#include "base/containers/span.h"
+
 #define GL_GLEXT_PROTOTYPES
 #endif
 
@@ -114,8 +116,8 @@ TEST_P(GLClearFramebufferTest, ClearColor) {
 
   // Verify.
   const uint8_t expected[] = {255, 128, 64, 128};
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 1 /* tolerance */, expected,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 1 /* tolerance */, expected, {}));
 }
 
 TEST_P(GLClearFramebufferTest, ClearColorWithMask) {
@@ -125,8 +127,8 @@ TEST_P(GLClearFramebufferTest, ClearColorWithMask) {
 
   // Verify.
   const uint8_t expected[] = {255, 0, 0, 0};
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, expected,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, expected, {}));
 }
 
 // crbug.com/434094
@@ -145,8 +147,8 @@ TEST_P(GLClearFramebufferTest, ClearColorWithScissor) {
 
   // Verify.
   const uint8_t expected[] = {255, 255, 255, 255};
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, expected,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, expected, {}));
 
   glScissor(0, 0, 0, 0);
   glEnable(GL_SCISSOR_TEST);
@@ -154,8 +156,8 @@ TEST_P(GLClearFramebufferTest, ClearColorWithScissor) {
   glClear(GL_COLOR_BUFFER_BIT);
 
   // Verify - no changes.
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, expected,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, expected, {}));
 }
 #endif
 
@@ -173,7 +175,7 @@ TEST_P(GLClearFramebufferTest, ClearDepthStencil) {
   const uint8_t kRed[] = {255, 0, 0, 255};
   const uint8_t kGreen[] = {0, 255, 0, 255};
   EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kRed, nullptr));
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kRed, {}));
 
   glClearStencil(kStencilRef);
   glClear(GL_STENCIL_BUFFER_BIT);
@@ -185,13 +187,13 @@ TEST_P(GLClearFramebufferTest, ClearDepthStencil) {
   DrawQuad();
   // Verify - stencil should have failed, so still red.
   EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kRed, nullptr));
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kRed, {}));
 
   glStencilFunc(GL_EQUAL, kStencilRef, 0xFFFFFFFF);
   DrawQuad();
   // Verify - stencil should have passed, so green.
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kGreen,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kGreen, {}));
 
   glEnable(GL_DEPTH_TEST);
   glClearDepthf(0.0f);
@@ -201,15 +203,15 @@ TEST_P(GLClearFramebufferTest, ClearDepthStencil) {
   SetDrawColor(1.0f, 0.0f, 0.0f, 1.0f);
   DrawQuad();
   // Verify - depth test should have failed, so still green.
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kGreen,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kGreen, {}));
 
   glClearDepthf(0.9f);
   glClear(GL_DEPTH_BUFFER_BIT);
   DrawQuad();
   // Verify - depth test should have passed, so red.
   EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kRed, nullptr));
+      GLTestHelper::CheckPixels(0, 0, 1, 1, 0 /* tolerance */, kRed, {}));
 }
 
 TEST_P(GLClearFramebufferTest, SeparateFramebufferClear) {
@@ -237,7 +239,7 @@ TEST_P(GLClearFramebufferTest, SeparateFramebufferClear) {
 
   gl_.BindOffscreenFramebuffer(GL_READ_FRAMEBUFFER);
   const uint8_t kRed[] = {255, 0, 0, 255};
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, kRed, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, kRed, {}));
 
   // Bind complete, but smaller read framebuffer, should not affect clear.
   GLuint texture;
@@ -257,7 +259,7 @@ TEST_P(GLClearFramebufferTest, SeparateFramebufferClear) {
 
   gl_.BindOffscreenFramebuffer(GL_READ_FRAMEBUFFER);
   const uint8_t kGreen[] = {0, 255, 0, 255};
-  EXPECT_TRUE(GLTestHelper::CheckPixels(3, 3, 1, 1, 0, kGreen, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(3, 3, 1, 1, 0, kGreen, {}));
 }
 
 class ES3ClearBufferTest : public testing::Test {
diff --git a/gpu/command_buffer/tests/gl_copy_texture_CHROMIUM_unittest.cc b/gpu/command_buffer/tests/gl_copy_texture_CHROMIUM_unittest.cc
index af3630f49aae1..4e2e7d2a40570 100644
--- a/gpu/command_buffer/tests/gl_copy_texture_CHROMIUM_unittest.cc
+++ b/gpu/command_buffer/tests/gl_copy_texture_CHROMIUM_unittest.cc
@@ -2,6 +2,10 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include <array>
+
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/40285824): Remove this and convert code to safer constructs.
 #pragma allow_unsafe_buffers
@@ -153,7 +157,11 @@ std::string GetFragmentShaderSource(GLenum target, GLenum format, bool is_es3) {
   return source;
 }
 
-void setColor(uint8_t r, uint8_t g, uint8_t b, uint8_t a, uint8_t* color) {
+void setColor(uint8_t r,
+              uint8_t g,
+              uint8_t b,
+              uint8_t a,
+              base::span<uint8_t> color) {
   color[0] = r;
   color[1] = g;
   color[2] = b;
@@ -163,8 +171,8 @@ void setColor(uint8_t r, uint8_t g, uint8_t b, uint8_t a, uint8_t* color) {
 void getExpectedColorAndMask(GLenum src_internal_format,
                              GLenum dest_internal_format,
                              const uint8_t* color,
-                             uint8_t* expected_color,
-                             uint8_t* expected_mask) {
+                             base::span<uint8_t> expected_color,
+                             base::span<uint8_t> expected_mask) {
   uint8_t adjusted_color[4];
   switch (src_internal_format) {
     case GL_ALPHA:
@@ -289,14 +297,14 @@ void getTextureDataAndExpectedRGBAs(FormatType src_format_type,
                                     GLsizei height,
                                     std::vector<uint8_t>* texture_data,
                                     std::vector<uint8_t>* expected_rgba_pixels,
-                                    uint8_t* expected_mask) {
+                                    base::span<uint8_t> expected_mask) {
   DCHECK(texture_data);
   DCHECK(expected_rgba_pixels);
 
   const uint32_t src_channel_count = gles2::GLES2Util::ElementsPerGroup(
       src_format_type.format, src_format_type.type);
   constexpr uint8_t color[4] = {1u, 63u, 127u, 255u};
-  uint8_t expected_color[4];
+  std::array<uint8_t, 4> expected_color;
   constexpr uint8_t alt_color[4] = {200u, 100u, 0u, 255u};
 
   getExpectedColorAndMask(src_format_type.internal_format,
@@ -364,7 +372,7 @@ void getTextureDataAndExpectedRGBAs(FormatType src_format_type,
         reinterpret_cast<uint32_t*>(texture_data->data());
     for (uint32_t p = 0; p < num_pixels; ++p) {
       texture_data32[p] = color_rgb10_a2;
-      memcpy(expected_rgba_pixels->data() + p * 4, expected_color, 4);
+      memcpy(expected_rgba_pixels->data() + p * 4, expected_color.data(), 4);
     }
     return;
   }
@@ -825,7 +833,7 @@ TEST_P(GLCopyTextureCHROMIUMTest, Basic) {
   EXPECT_EQ(static_cast<GLenum>(GL_FRAMEBUFFER_COMPLETE),
             glCheckFramebufferStatus(GL_FRAMEBUFFER));
 
-  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, pixels, nullptr);
+  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, pixels, {});
   EXPECT_TRUE(GL_NO_ERROR == glGetError());
 }
 
@@ -929,7 +937,7 @@ TEST_P(GLCopyTextureCHROMIUMTest, ImmutableTexture) {
         EXPECT_EQ(static_cast<GLenum>(GL_FRAMEBUFFER_COMPLETE),
                   glCheckFramebufferStatus(GL_FRAMEBUFFER));
 
-        GLTestHelper::CheckPixels(0, 0, 1, 1, 0, pixels, nullptr);
+        GLTestHelper::CheckPixels(0, 0, 1, 1, 0, pixels, {});
         EXPECT_TRUE(GL_NO_ERROR == glGetError());
       }
       glDeleteTextures(2, textures_);
@@ -1255,7 +1263,7 @@ TEST_F(GLCopyTextureCHROMIUMTest, RedefineDestinationTexture) {
   EXPECT_EQ(static_cast<GLenum>(GL_FRAMEBUFFER_COMPLETE),
             glCheckFramebufferStatus(GL_FRAMEBUFFER));
 
-  GLTestHelper::CheckPixels(1, 1, 1, 1, 0, &pixels[12], nullptr);
+  GLTestHelper::CheckPixels(1, 1, 1, 1, 0, &pixels[12], {});
 
   glDeleteTextures(2, textures_);
   glDeleteFramebuffers(1, &framebuffer_id_);
@@ -1480,7 +1488,7 @@ TEST_P(GLCopyTextureCHROMIUMTest, FBOStatePreserved) {
   uint8_t expected_color[4] = {255u, 255u, 0, 255u};
   glClearColor(1.0, 1.0, 0, 1.0);
   glClear(GL_COLOR_BUFFER_BIT);
-  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, nullptr);
+  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, {});
 
   if (copy_type == TexImage) {
     glCopyTextureCHROMIUM(textures_[0], 0, GL_TEXTURE_2D, textures_[1], 0,
@@ -1494,12 +1502,12 @@ TEST_P(GLCopyTextureCHROMIUMTest, FBOStatePreserved) {
   EXPECT_TRUE(glIsFramebuffer(framebuffer_id));
 
   // Ensure that reading from the framebuffer produces correct pixels.
-  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, nullptr);
+  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, {});
 
   uint8_t expected_color2[4] = {255u, 0, 255u, 255u};
   glClearColor(1.0, 0, 1.0, 1.0);
   glClear(GL_COLOR_BUFFER_BIT);
-  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color2, nullptr);
+  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color2, {});
 
   GLint bound_fbo = 0;
   glGetIntegerv(GL_FRAMEBUFFER_BINDING, &bound_fbo);
@@ -1588,9 +1596,9 @@ TEST_P(GLCopyTextureCHROMIUMTest, ProgramStatePreservation) {
       0, 0, 0, 0,
   };
   glClear(GL_COLOR_BUFFER_BIT);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, zero, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, zero, {}));
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected, {}));
 
   // Call copyTextureCHROMIUM
   uint8_t pixels[1 * 4] = {255u, 0u, 0u, 255u};
@@ -1610,9 +1618,9 @@ TEST_P(GLCopyTextureCHROMIUMTest, ProgramStatePreservation) {
 
   // test using program after
   glClear(GL_COLOR_BUFFER_BIT);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, zero, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, zero, {}));
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected, {}));
 
   glDeleteTextures(2, textures_);
   glDeleteFramebuffers(1, &framebuffer_id_);
@@ -1801,10 +1809,10 @@ TEST_F(GLCopyTextureCHROMIUMTest, CopySubTextureOffset) {
   uint8_t red[1 * 4] = {255u, 0u, 0u, 255u};
   uint8_t green[1 * 4] = {0u, 255u, 0u, 255u};
   uint8_t blue[1 * 4] = {0u, 0u, 255u, 255u};
-  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, transparent, nullptr);
-  GLTestHelper::CheckPixels(1, 1, 1, 1, 0, red, nullptr);
-  GLTestHelper::CheckPixels(1, 0, 1, 1, 0, green, nullptr);
-  GLTestHelper::CheckPixels(0, 1, 1, 1, 0, blue, nullptr);
+  GLTestHelper::CheckPixels(0, 0, 1, 1, 0, transparent, {});
+  GLTestHelper::CheckPixels(1, 1, 1, 1, 0, red, {});
+  GLTestHelper::CheckPixels(1, 0, 1, 1, 0, green, {});
+  GLTestHelper::CheckPixels(0, 1, 1, 1, 0, blue, {});
   EXPECT_TRUE(GL_NO_ERROR == glGetError());
 
   glDeleteTextures(2, textures_);
diff --git a/gpu/command_buffer/tests/gl_cube_map_texture_unittest.cc b/gpu/command_buffer/tests/gl_cube_map_texture_unittest.cc
index 8a24e8cd71407..c533510f4b2ae 100644
--- a/gpu/command_buffer/tests/gl_cube_map_texture_unittest.cc
+++ b/gpu/command_buffer/tests/gl_cube_map_texture_unittest.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/40285824): Remove this and convert code to safer constructs.
 #pragma allow_unsafe_buffers
@@ -117,7 +119,7 @@ TEST_P(GLCubeMapTextureTest, DISABLED_ReadPixels) {
   EXPECT_EQ(static_cast<GLenum>(GL_FRAMEBUFFER_COMPLETE),
             glCheckFramebufferStatus(GL_FRAMEBUFFER));
 
-  GLTestHelper::CheckPixels(0, 0, width_, width_, 0, pixels_, nullptr);
+  GLTestHelper::CheckPixels(0, 0, width_, width_, 0, pixels_, {});
   EXPECT_EQ(static_cast<GLenum>(GL_NO_ERROR), glGetError());
 }
 
diff --git a/gpu/command_buffer/tests/gl_ext_blend_func_extended_unittest.cc b/gpu/command_buffer/tests/gl_ext_blend_func_extended_unittest.cc
index af512dba16da0..578b1355fdee2 100644
--- a/gpu/command_buffer/tests/gl_ext_blend_func_extended_unittest.cc
+++ b/gpu/command_buffer/tests/gl_ext_blend_func_extended_unittest.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/40285824): Remove this and convert code to safer constructs.
 #pragma allow_unsafe_buffers
@@ -201,9 +203,8 @@ class EXTBlendFuncExtendedDrawTest : public testing::TestWithParam<bool> {
                          GL_ONE_MINUS_SRC1_ALPHA_EXT>(kDst, kSrc, kSrc1, color);
 
     EXPECT_TRUE(GLTestHelper::CheckPixels(kWidth / 4, (3 * kHeight) / 4, 1, 1,
-                                          1, color, nullptr));
-    EXPECT_TRUE(
-        GLTestHelper::CheckPixels(kWidth - 1, 0, 1, 1, 1, color, nullptr));
+                                          1, color, {}));
+    EXPECT_TRUE(GLTestHelper::CheckPixels(kWidth - 1, 0, 1, 1, 1, color, {}));
   }
 
  protected:
diff --git a/gpu/command_buffer/tests/gl_ext_srgb_unittest.cc b/gpu/command_buffer/tests/gl_ext_srgb_unittest.cc
index ba12d6e87db0e..6e03d557335f2 100644
--- a/gpu/command_buffer/tests/gl_ext_srgb_unittest.cc
+++ b/gpu/command_buffer/tests/gl_ext_srgb_unittest.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/390223051): Remove C-library calls to fix the errors.
 #pragma allow_unsafe_libc_calls
@@ -71,10 +73,10 @@ TEST_F(GLEXTSRGBTest, TexImageSRGBALPHAFormat) {
   EXPECT_EQ(static_cast<GLenum>(GL_FRAMEBUFFER_COMPLETE),
             glCheckFramebufferStatus(GL_FRAMEBUFFER));
 
-  GLTestHelper::CheckPixels(0, 0, kSubImageX, kHeight, 0, kImageColor, nullptr);
-  GLTestHelper::CheckPixels(0, 0, kWidth, kSubImageY, 0, kImageColor, nullptr);
+  GLTestHelper::CheckPixels(0, 0, kSubImageX, kHeight, 0, kImageColor, {});
+  GLTestHelper::CheckPixels(0, 0, kWidth, kSubImageY, 0, kImageColor, {});
   GLTestHelper::CheckPixels(kSubImageX, kSubImageY, kSubImageWidth,
-                            kSubImageHeight, 0, kSubImageColor, nullptr);
+                            kSubImageHeight, 0, kSubImageColor, {});
 }
 
 }  // namespace gpu
diff --git a/gpu/command_buffer/tests/gl_lose_context_chromium_unittest.cc b/gpu/command_buffer/tests/gl_lose_context_chromium_unittest.cc
index 74bdd60023ebb..e955c36f20b82 100644
--- a/gpu/command_buffer/tests/gl_lose_context_chromium_unittest.cc
+++ b/gpu/command_buffer/tests/gl_lose_context_chromium_unittest.cc
@@ -7,6 +7,7 @@
 #include <GLES2/gl2extchromium.h>
 #include <stdint.h>
 
+#include "base/containers/span.h"
 #include "gpu/command_buffer/service/feature_info.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
 #include "gpu/command_buffer/tests/gl_test_utils.h"
@@ -54,18 +55,16 @@ TEST_F(GLLoseContextTest, ShareGroup) {
       GLTestHelper::kCheckClearValue, GLTestHelper::kCheckClearValue,
   };
   // Expect the read will fail.
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_no_draw, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_no_draw, {}));
   gl1b_.MakeCurrent();
   // Expect the read will fail.
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_no_draw, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_no_draw, {}));
   gl2_.MakeCurrent();
   uint8_t expected_draw[] = {
       0, 0, 0, 0,
   };
   // Expect the read will succeed.
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_draw, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_draw, {}));
 }
 
 }  // namespace gpu
diff --git a/gpu/command_buffer/tests/gl_map_buffer_range_unittest.cc b/gpu/command_buffer/tests/gl_map_buffer_range_unittest.cc
index 4803e7b83123a..2e821f2afa3d2 100644
--- a/gpu/command_buffer/tests/gl_map_buffer_range_unittest.cc
+++ b/gpu/command_buffer/tests/gl_map_buffer_range_unittest.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/40285824): Remove this and convert code to safer constructs.
 #pragma allow_unsafe_buffers
@@ -119,13 +121,13 @@ TEST_F(ES3MapBufferRangeTest, DrawArraysAndInstanced) {
   glDrawArrays(GL_TRIANGLES, 0, 6);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawArraysInstancedANGLE(GL_TRIANGLES, 0, 6, kPrimCount);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glMapBufferRange(GL_ARRAY_BUFFER, 0, 6, GL_MAP_READ_BIT);
   GLTestHelper::CheckGLError("no errors", __LINE__);
@@ -134,13 +136,13 @@ TEST_F(ES3MapBufferRangeTest, DrawArraysAndInstanced) {
   glDrawArrays(GL_TRIANGLES, 0, 6);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawArraysInstancedANGLE(GL_TRIANGLES, 0, 6, kPrimCount);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   // The following test is necessary to make sure draw calls do not just check
   // bound buffers, but actual buffers that are attached to the enabled vertex
@@ -151,13 +153,13 @@ TEST_F(ES3MapBufferRangeTest, DrawArraysAndInstanced) {
   glDrawArrays(GL_TRIANGLES, 0, 6);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawArraysInstancedANGLE(GL_TRIANGLES, 0, 6, kPrimCount);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glBindBuffer(GL_ARRAY_BUFFER, buffer);
   glUnmapBuffer(GL_ARRAY_BUFFER);
@@ -167,13 +169,13 @@ TEST_F(ES3MapBufferRangeTest, DrawArraysAndInstanced) {
   glDrawArrays(GL_TRIANGLES, 0, 6);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawArraysInstancedANGLE(GL_TRIANGLES, 0, 6, kPrimCount);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 }
 
 TEST_F(ES3MapBufferRangeTest, DrawElementsAndInstanced) {
@@ -200,14 +202,14 @@ TEST_F(ES3MapBufferRangeTest, DrawElementsAndInstanced) {
   glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawElementsInstancedANGLE(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0,
                                kPrimCount);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glMapBufferRange(GL_ARRAY_BUFFER, 0, 6, GL_MAP_READ_BIT);
   GLTestHelper::CheckGLError("no errors", __LINE__);
@@ -216,14 +218,14 @@ TEST_F(ES3MapBufferRangeTest, DrawElementsAndInstanced) {
   glDrawArrays(GL_TRIANGLES, 0, 6);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawElementsInstancedANGLE(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0,
                                kPrimCount);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   // The following test is necessary to make sure draw calls do not just check
   // bound buffers, but actual buffers that are attached to the enabled vertex
@@ -234,14 +236,14 @@ TEST_F(ES3MapBufferRangeTest, DrawElementsAndInstanced) {
   glDrawArrays(GL_TRIANGLES, 0, 6);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawElementsInstancedANGLE(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0,
                                kPrimCount);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glBindBuffer(GL_ARRAY_BUFFER, buffers[0]);
 
@@ -252,14 +254,14 @@ TEST_F(ES3MapBufferRangeTest, DrawElementsAndInstanced) {
   glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawElementsInstancedANGLE(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0,
                                kPrimCount);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glMapBufferRange(GL_ELEMENT_ARRAY_BUFFER, 0, 6, GL_MAP_READ_BIT);
   GLTestHelper::CheckGLError("no errors", __LINE__);
@@ -268,14 +270,14 @@ TEST_F(ES3MapBufferRangeTest, DrawElementsAndInstanced) {
   glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawElementsInstancedANGLE(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0,
                                kPrimCount);
   EXPECT_EQ(static_cast<GLenum>(GL_INVALID_OPERATION), glGetError());
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kBlackColor, nullptr));
+                                        kBlackColor, {}));
 
   glUnmapBuffer(GL_ELEMENT_ARRAY_BUFFER);
   GLTestHelper::CheckGLError("no errors", __LINE__);
@@ -284,14 +286,14 @@ TEST_F(ES3MapBufferRangeTest, DrawElementsAndInstanced) {
   glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   glDrawElementsInstancedANGLE(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, 0,
                                kPrimCount);
   GLTestHelper::CheckGLError("no errors", __LINE__);
   EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kCanvasSize, kCanvasSize, 1,
-                                        kRedColor, nullptr));
+                                        kRedColor, {}));
 }
 
 TEST_F(ES3MapBufferRangeTest, ReadPixels) {
diff --git a/gpu/command_buffer/tests/gl_pointcoord_unittest.cc b/gpu/command_buffer/tests/gl_pointcoord_unittest.cc
index 53b285095c931..74f5cc2acd7cb 100644
--- a/gpu/command_buffer/tests/gl_pointcoord_unittest.cc
+++ b/gpu/command_buffer/tests/gl_pointcoord_unittest.cc
@@ -8,6 +8,7 @@
 
 #include <array>
 
+#include "base/containers/span.h"
 #include "build/build_config.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
 #include "gpu/command_buffer/tests/gl_test_utils.h"
@@ -146,7 +147,7 @@ TEST_F(PointCoordTest, MAYBE_RenderTo) {
               static_cast<uint8_t>(s * 255),
               static_cast<uint8_t>((1 - t) * 255), 0, 255,
           };
-          GLTestHelper::CheckPixels(xf, yf, 1, 1, 4, color, nullptr);
+          GLTestHelper::CheckPixels(xf, yf, 1, 1, 4, color, {});
         }
       }
     }
diff --git a/gpu/command_buffer/tests/gl_program_unittest.cc b/gpu/command_buffer/tests/gl_program_unittest.cc
index 7817cc87d812f..15b1abd1d2c85 100644
--- a/gpu/command_buffer/tests/gl_program_unittest.cc
+++ b/gpu/command_buffer/tests/gl_program_unittest.cc
@@ -7,6 +7,7 @@
 #include <GLES2/gl2extchromium.h>
 #include <stdint.h>
 
+#include "base/containers/span.h"
 #include "gpu/command_buffer/service/context_group.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
 #include "gpu/command_buffer/tests/gl_test_utils.h"
@@ -131,8 +132,7 @@ TEST_F(GLProgramTest, NewShaderInCurrentProgram) {
   uint8_t expected_color[] = {
       0, 0, 255, 255,
   };
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, {}));
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
 
@@ -200,8 +200,7 @@ TEST_F(GLProgramTest, UniformsInCurrentProgram) {
   uint8_t expected_color[] = {
       0, 0, 255, 255,
   };
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_color, {}));
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
 
diff --git a/gpu/command_buffer/tests/gl_stream_draw_unittest.cc b/gpu/command_buffer/tests/gl_stream_draw_unittest.cc
index 636e0041c3801..60427231bbbff 100644
--- a/gpu/command_buffer/tests/gl_stream_draw_unittest.cc
+++ b/gpu/command_buffer/tests/gl_stream_draw_unittest.cc
@@ -6,6 +6,7 @@
 #include <GLES2/gl2ext.h>
 #include <stdint.h>
 
+#include "base/containers/span.h"
 #include "build/build_config.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
 #include "gpu/command_buffer/tests/gl_test_utils.h"
@@ -79,11 +80,11 @@ TEST_F(GLStreamDrawTest, Basic) {
   GLTestHelper::SetupColorsForUnitQuad(color_loc, float_red, GL_STREAM_DRAW);
   glDrawArrays(GL_TRIANGLES, 0, 6);
   EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_red, nullptr));
+      GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_red, {}));
   GLTestHelper::SetupColorsForUnitQuad(color_loc, float_green, GL_STATIC_DRAW);
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_green,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_green, {}));
 
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
@@ -114,14 +115,14 @@ TEST_F(GLStreamDrawTest, DrawElements) {
       GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STREAM_DRAW);
   glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, nullptr);
   EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_red, nullptr));
+      GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_red, {}));
   GLTestHelper::SetupColorsForUnitQuad(color_loc, float_green, GL_STATIC_DRAW);
 
   glBufferData(
       GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);
   glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_BYTE, nullptr);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_green,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_green, {}));
 
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
@@ -161,13 +162,13 @@ TEST_F(GLStreamDrawTest, VertexArrayObjects) {
   for (int ii = 0; ii < 2; ++ii) {
     glBindVertexArrayOES(vaos[0]);
     glDrawArrays(GL_TRIANGLES, 0, 6);
-    EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_red,
-                                          nullptr));
+    EXPECT_TRUE(
+        GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_red, {}));
 
     glBindVertexArrayOES(vaos[1]);
     glDrawArrays(GL_TRIANGLES, 0, 6);
-    EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_green,
-                                          nullptr));
+    EXPECT_TRUE(
+        GLTestHelper::CheckPixels(0, 0, kSize, kSize, 0, expected_green, {}));
   }
 
   GLTestHelper::CheckGLError("no errors", __LINE__);
diff --git a/gpu/command_buffer/tests/gl_test_utils.cc b/gpu/command_buffer/tests/gl_test_utils.cc
index 069feec8dc2ac..fed5a474185d0 100644
--- a/gpu/command_buffer/tests/gl_test_utils.cc
+++ b/gpu/command_buffer/tests/gl_test_utils.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/40285824): Remove this and convert code to safer constructs.
 #pragma allow_unsafe_buffers
@@ -228,7 +230,7 @@ bool GLTestHelper::CheckPixels(GLint x,
                                GLsizei height,
                                GLint tolerance,
                                const uint8_t* color,
-                               const uint8_t* mask) {
+                               base::span<const uint8_t> mask) {
   std::vector<uint8_t> colors(width * height * 4);
   for (int i = 0; i < width * height * 4; i += 4)
     memcpy(&colors[i], color, 4);
@@ -241,7 +243,7 @@ bool GLTestHelper::CheckPixels(GLint x,
                                GLsizei height,
                                GLint tolerance,
                                const std::vector<uint8_t>& expected,
-                               const uint8_t* mask) {
+                               base::span<const uint8_t> mask) {
   GLsizei size = width * height * 4;
   std::vector<uint8_t> pixels(size, kCheckClearValue);
   glReadPixels(x, y, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels.data());
@@ -255,7 +257,7 @@ bool GLTestHelper::CheckPixels(GLint x,
         uint8_t expected_component = expected[offset + jj];
         int diff = actual - expected_component;
         diff = diff < 0 ? -diff: diff;
-        if ((!mask || mask[jj]) && diff > tolerance) {
+        if ((mask.empty() || mask[jj]) && diff > tolerance) {
           EXPECT_EQ(static_cast<int>(expected_component),
                     static_cast<int>(actual))
               << " at " << (xx + x) << ", " << (yy + y) << " channel " << jj;
diff --git a/gpu/command_buffer/tests/gl_test_utils.h b/gpu/command_buffer/tests/gl_test_utils.h
index 79f9630656f18..e58ef46beba8d 100644
--- a/gpu/command_buffer/tests/gl_test_utils.h
+++ b/gpu/command_buffer/tests/gl_test_utils.h
@@ -13,6 +13,7 @@
 #include <string_view>
 #include <vector>
 
+#include "base/containers/span.h"
 #include "base/memory/raw_ptr.h"
 #include "build/build_config.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
@@ -75,7 +76,7 @@ class GLTestHelper {
                           GLsizei height,
                           GLint tolerance,
                           const uint8_t* color,
-                          const uint8_t* mask);
+                          base::span<const uint8_t> mask);
 
   static bool CheckPixels(GLint x,
                           GLint y,
@@ -83,7 +84,7 @@ class GLTestHelper {
                           GLsizei height,
                           GLint tolerance,
                           const std::vector<uint8_t>& expected,
-                          const uint8_t* mask);
+                          base::span<const uint8_t> mask);
 
   // Uses ReadPixels to save an area of the current FBO/Backbuffer.
   static bool SaveBackbufferAsBMP(const char* filename, int width, int height);
diff --git a/gpu/command_buffer/tests/gl_texture_storage_unittest.cc b/gpu/command_buffer/tests/gl_texture_storage_unittest.cc
index 421b60acc2fad..d7b2fcbb2b849 100644
--- a/gpu/command_buffer/tests/gl_texture_storage_unittest.cc
+++ b/gpu/command_buffer/tests/gl_texture_storage_unittest.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/390223051): Remove C-library calls to fix the errors.
 #pragma allow_unsafe_libc_calls
@@ -128,7 +130,7 @@ TEST_F(TextureStorageTest, CorrectPixels) {
                   2, 2,
                   GL_RGBA, GL_UNSIGNED_BYTE,
                   source_pixels);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 2, 2, 0, source_pixels, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 2, 2, 0, source_pixels, {}));
 }
 
 TEST_F(TextureStorageTest, IsImmutable) {
@@ -258,8 +260,7 @@ TEST_F(TextureStorageTest, LuminanceEmulation) {
   BlitTexture();
 
   const uint8_t swizzled_pixel[4] = {1, 1, 1, 255};
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 2, 2, 0, swizzled_pixel, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 2, 2, 0, swizzled_pixel, {}));
 }
 
 TEST_F(TextureStorageTest, AlphaEmulation) {
@@ -292,8 +293,7 @@ TEST_F(TextureStorageTest, AlphaEmulation) {
   BlitTexture();
 
   const uint8_t swizzled_pixel[4] = {0, 0, 0, 1};
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 2, 2, 0, swizzled_pixel, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 2, 2, 0, swizzled_pixel, {}));
 }
 
 TEST_F(TextureStorageTest, LuminanceAlphaEmulation) {
@@ -326,8 +326,7 @@ TEST_F(TextureStorageTest, LuminanceAlphaEmulation) {
   BlitTexture();
 
   const uint8_t swizzled_pixel[4] = {1, 1, 1, 2};
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 2, 2, 0, swizzled_pixel, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 2, 2, 0, swizzled_pixel, {}));
 }
 
 }  // namespace gpu
diff --git a/gpu/command_buffer/tests/gl_unittest.cc b/gpu/command_buffer/tests/gl_unittest.cc
index 41af10235df44..5dd8db782b7e9 100644
--- a/gpu/command_buffer/tests/gl_unittest.cc
+++ b/gpu/command_buffer/tests/gl_unittest.cc
@@ -7,6 +7,7 @@
 #include <stdint.h>
 
 #include "base/containers/heap_array.h"
+#include "base/containers/span.h"
 #include "gpu/command_buffer/service/feature_info.h"
 #include "gpu/command_buffer/tests/gl_manager.h"
 #include "gpu/command_buffer/tests/gl_test_utils.h"
@@ -31,7 +32,7 @@ TEST_F(GLTest, Basic) {
   uint8_t expected[] = {
       0, 255, 0, 255,
   };
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected, {}));
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
 
@@ -59,7 +60,7 @@ TEST_F(GLTest, BasicFBO) {
   uint8_t expected[] = {
       0, 255, 0, 255,
   };
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 16, 16, 0, expected, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 16, 16, 0, expected, {}));
   glDeleteFramebuffers(1, &fbo);
   glDeleteTextures(1, &tex);
   GLTestHelper::CheckGLError("no errors", __LINE__);
@@ -90,13 +91,12 @@ TEST_F(GLTest, SimpleShader) {
   };
   glClearColor(0.5f, 0.0f, 1.0f, 0.0f);
   glClear(GL_COLOR_BUFFER_BIT);
-  EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, 1, 1, 1, expected_clear, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 1, expected_clear, {}));
   uint8_t expected_draw[] = {
       0, 255, 0, 255,
   };
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_draw, nullptr));
+  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, 1, 1, 0, expected_draw, {}));
 }
 
 TEST_F(GLTest, FeatureFlagsMatchCapabilities) {
diff --git a/gpu/command_buffer/tests/gl_virtual_contexts_unittest.cc b/gpu/command_buffer/tests/gl_virtual_contexts_unittest.cc
index d14b13222b18d..1e3c13769abab 100644
--- a/gpu/command_buffer/tests/gl_virtual_contexts_unittest.cc
+++ b/gpu/command_buffer/tests/gl_virtual_contexts_unittest.cc
@@ -2,6 +2,8 @@
 // Use of this source code is governed by a BSD-style license that can be
 // found in the LICENSE file.
 
+#include "base/containers/span.h"
+
 #ifdef UNSAFE_BUFFERS_BUILD
 // TODO(crbug.com/40285824): Remove this and convert code to safer constructs.
 #pragma allow_unsafe_buffers
@@ -156,7 +158,7 @@ void TestDraw(int size) {
   glClearColor(0.5f, 0.0f, 1.0f, 0.0f);
   glClear(GL_COLOR_BUFFER_BIT);
   EXPECT_TRUE(
-      GLTestHelper::CheckPixels(0, 0, size, size, 1, expected_clear, nullptr));
+      GLTestHelper::CheckPixels(0, 0, size, size, 1, expected_clear, {}));
   glDrawArrays(GL_TRIANGLES, 0, 6);
 }
 
@@ -195,7 +197,7 @@ TEST_P(GLVirtualContextsTest, Basic) {
     GLManager* gl_manager = test.manager;
     gl_manager->MakeCurrent();
     EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, test.size, test.size, 0,
-                                          test.color, nullptr));
+                                          test.color, {}));
   }
 
   for (int ii = 0; ii < kNumTests; ++ii) {
@@ -227,16 +229,16 @@ TEST_P(GLVirtualContextsTest, VertexArrayObjectRestore) {
   gl1_.MakeCurrent();
   // Test to ensure that vao1 is still the active VAO for this context.
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize1, kSize1, 0, kExpectedRed,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize1, kSize1, 0, kExpectedRed, {}));
   glFinish();
   GLTestHelper::CheckGLError("no errors", __LINE__);
 
   gl2_.MakeCurrent();
   // Test to ensure that vao2 is still the active VAO for this context.
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize2, kSize2, 0, kExpectedGreen,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize2, kSize2, 0, kExpectedGreen, {}));
   glFinish();
   GLTestHelper::CheckGLError("no errors", __LINE__);
 }
@@ -265,8 +267,8 @@ TEST_P(GLVirtualContextsTest, VertexArrayObjectRestoreRebind) {
   glBindVertexArrayOES(0);
   glBindVertexArrayOES(vao1);
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize1, kSize1, 0, kExpectedRed,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize1, kSize1, 0, kExpectedRed, {}));
   glFinish();
   GLTestHelper::CheckGLError("no errors", __LINE__);
 
@@ -276,8 +278,8 @@ TEST_P(GLVirtualContextsTest, VertexArrayObjectRestoreRebind) {
   glBindVertexArrayOES(0);
   glBindVertexArrayOES(vao2);
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize2, kSize2, 0, kExpectedGreen,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize2, kSize2, 0, kExpectedGreen, {}));
   glFinish();
 
   GLTestHelper::CheckGLError("no errors", __LINE__);
@@ -304,8 +306,8 @@ TEST_P(GLVirtualContextsTest, VertexArrayObjectRestoreDefault) {
   gl1_.MakeCurrent();
   // Test to ensure that default VAO on gl1_ is still valid.
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize1, kSize1, 0, kExpectedRed,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize1, kSize1, 0, kExpectedRed, {}));
   glFinish();
 
   gl2_.MakeCurrent();
@@ -314,8 +316,8 @@ TEST_P(GLVirtualContextsTest, VertexArrayObjectRestoreDefault) {
   // bound during the context switch.
   glBindVertexArrayOES(0);
   glDrawArrays(GL_TRIANGLES, 0, 6);
-  EXPECT_TRUE(GLTestHelper::CheckPixels(0, 0, kSize2, kSize2, 0, kExpectedGreen,
-                                        nullptr));
+  EXPECT_TRUE(
+      GLTestHelper::CheckPixels(0, 0, kSize2, kSize2, 0, kExpectedGreen, {}));
   glFinish();
 
   GLTestHelper::CheckGLError("no errors", __LINE__);
```

## Build Failure Log

```
Missing "use_remoteexec=true". No remote execution
[31;1moffline mode[0m

20.07s Build Failure: 50 done 1 failed 6551 remaining - 2.49/s
 1 steps failed: exit=1
see ./out/linux/siso_output for full command line and output
 or ./out/linux/siso.INFO
use ./out/linux/siso_failed_commands.sh to re-run failed commands

real	0m20.318s
user	6m38.330s
sys	1m7.729s
ninja: Entering directory `out/linux'


loading fs state done 880.567113ms
loading/recompacting deps log done 2.028734516s
load siso config done 85.292317ms
load build.ninja done 627.876338ms
schedule pending:0+ready:1 (node:310461 edge:2)

build start: Ready 1 Pending 1
rebuild manifest finished	
schedule pending:0+ready:1 (node:310461 edge:9)

build start: Ready 15286 Pending 102625
[0/57537] 8.97s S CXX obj/gpu/command_buffer/client/raster_sources/raster_implementation.o
[0/42499] 11.45s S CXX obj/gpu/test_support/raster_in_process_context.o
[0/41357] 11.84s S CXX obj/services/viz/public/cpp/gpu/gpu/context_provider_command_buffer.o
[0/39395] 12.01s S LINK ./bluetooth_metrics_hash
[0/38349] 12.10s F LINK ./bluetooth_metrics_hash
[1/37143] 12.48s S CXX obj/gpu/gl_tests/gl_unallocated_texture_unittest.o
[1/37114] 12.48s S CXX obj/gpu/gl_tests/gl_test_utils.o
[1/37031] 12.50s S CXX obj/gpu/gl_tests/gl_chromium_framebuffer_multisample_unittest.o
[1/36997] 12.51s S CXX obj/cc/cc_unittests/transfer_cache_unittest.o
[1/36961] 12.52s S CXX obj/gpu/gl_tests/gl_ext_blend_func_extended_unittest.o
[1/36850] 12.54s S CXX obj/gpu/gl_tests/gl_unittest.o
[1/36705] 12.55s S CXX obj/gpu/gl_tests/gl_angle_shader_pixel_local_storage_unittest.o
[1/36641] 12.56s S CXX obj/gpu/gl_tests/gl_virtual_contexts_unittest.o
[1/36557] 12.57s S CXX obj/gpu/gl_tests/occlusion_query_unittest.o
[1/36482] 12.57s S CXX obj/gpu/gl_tests/gl_webgl_multi_draw_test.o
[1/36458] 12.58s S CXX obj/gpu/gl_tests/gl_set_aggressively_free_resources_unittest.o
[1/36416] 12.59s S CXX obj/gpu/gl_tests/gl_texture_storage_unittest.o
[1/36057] 12.83s S CXX obj/gpu/gl_tests/gl_ext_srgb_unittest.o
[1/35996] 12.84s S CXX obj/gpu/gl_tests/gl_shared_resources_unittest.o
[1/35979] 12.84s S CXX obj/gpu/gl_tests/gl_virtual_contexts_ext_window_rectangles_unittest.o
[1/35861] 12.88s S CXX obj/gpu/gl_tests/gl_offscreen_surface_unittest.o
[1/35672] 12.91s S CXX obj/gpu/gl_tests/gl_readback_unittest.o
[1/35432] 12.97s S CXX obj/gpu/gl_tests/gl_query_unittest.o
[1/35345] 12.98s S CXX obj/gpu/gl_tests/raster_in_process_context_tests.o
[1/34990] 13.07s S CXX obj/gpu/gl_tests/gl_bgra_mipmap_unittest.o
[1/34988] 13.07s S CXX obj/gpu/gl_tests/gl_stream_draw_unittest.o
[1/34929] 13.08s S CXX obj/gpu/gl_tests/gl_discardable_textures_unittest.o
[1/34724] 13.13s S CXX obj/gpu/gl_tests/gl_ext_multisample_compatibility_unittest.o
[1/34707] 13.13s S CXX obj/gpu/gl_tests/gl_cube_map_texture_unittest.o
[1/34410] 13.19s S CXX obj/gpu/gl_tests/gl_program_unittest.o
[1/33497] 13.48s S CXX obj/gpu/gl_tests/gl_clear_framebuffer_unittest.o
[1/33405] 13.49s S CXX obj/gpu/gl_tests/gl_pointcoord_unittest.o
[1/33303] 13.50s S CXX obj/cc/cc_unittests/oop_pixeltest.o
[1/32750] 13.66s S CXX obj/gpu/gpu_unittests/raster_implementation_unittest.o
[1/32741] 13.66s S CXX obj/gpu/gl_tests/gl_oob_attrib_unittest.o
[1/31170] 13.82s S CXX obj/gpu/gl_tests/gl_object_bindings_unittest.o
[1/30814] 13.88s S CXX obj/gpu/gl_tests/gl_map_buffer_range_unittest.o
[1/30796] 13.88s S CXX obj/gpu/gl_tests/gl_request_extension_unittest.o
[1/30709] 13.88s S CXX obj/gpu/gl_tests/gl_tests_main.o
[1/28137] 14.23s S CXX obj/gpu/gl_tests/gl_depth_texture_unittest.o
[1/27724] 14.25s S CXX obj/gpu/gl_tests/gl_deschedule_unittest.o
[1/27718] 14.25s S CXX obj/gpu/gl_tests/es3_misc_functions_unittest.o
[1/27129] 14.36s S CXX obj/gpu/gl_tests/compressed_texture_test.o
[1/26828] 14.42s S CXX obj/gpu/gl_tests/gl_lose_context_chromium_unittest.o
[1/25213] 14.62s S CXX obj/components/viz/test/test_support/test_in_process_context_provider.o
[1/25147] 14.62s S CXX obj/gpu/gl_tests/gl_gpu_memory_buffer_unittest.o
[1/25058] 14.63s F CXX obj/gpu/command_buffer/client/raster_sources/raster_implementation.o
[2/24714] 14.74s S CXX obj/gpu/gl_tests/gl_copy_texture_CHROMIUM_unittest.o
[2/24253] 14.86s S CXX obj/gpu/gl_tests/gl_test_setup_helper.o
[2/23875] 14.92s S CXX obj/gpu/gl_tests/gl_ext_window_rectangles_unittest.o
[2/23759] 14.92s S CXX obj/gpu/gl_tests/gl_bind_uniform_location_unittest.o
[2/23242] 14.95s S SOLINK ./libdevice_fido.so
[2/16181] 16.11s F SOLINK ./libdevice_fido.so
[3/12453] 16.77s F CXX obj/gpu/gl_tests/gl_chromium_framebuffer_multisample_unittest.o
[4/12282] 16.89s F CXX obj/gpu/gl_tests/gl_angle_shader_pixel_local_storage_unittest.o
[5/12253] 16.93s F CXX obj/gpu/gl_tests/gl_ext_srgb_unittest.o
[6/11993] 16.95s F CXX obj/gpu/gl_tests/gl_virtual_contexts_ext_window_rectangles_unittest.o
[7/11949] 16.95s F CXX obj/gpu/gl_tests/occlusion_query_unittest.o
[8/10585] 17.13s F CXX obj/gpu/gl_tests/gl_unittest.o
[9/9124] 17.26s F CXX obj/gpu/gl_tests/gl_virtual_contexts_unittest.o
[10/8814] 17.32s F CXX obj/gpu/gl_tests/gl_stream_draw_unittest.o
[11/8814] 17.32s F CXX obj/gpu/gl_tests/gl_unallocated_texture_unittest.o
[12/8809] 17.33s F CXX obj/gpu/gl_tests/gl_offscreen_surface_unittest.o
[13/8482] 17.35s F CXX obj/gpu/gl_tests/gl_texture_storage_unittest.o
[14/8472] 17.35s F CXX obj/gpu/gl_tests/gl_webgl_multi_draw_test.o
[15/8368] 17.40s F CXX obj/gpu/gl_tests/gl_test_utils.o
[16/8365] 17.40s F CXX obj/gpu/gl_tests/gl_set_aggressively_free_resources_unittest.o
[17/8350] 17.43s F CXX obj/gpu/gl_tests/gl_bgra_mipmap_unittest.o
[18/8131] 17.47s F CXX obj/gpu/gl_tests/gl_discardable_textures_unittest.o
[19/8040] 17.55s F CXX obj/gpu/gl_tests/gl_program_unittest.o
[20/7797] 17.62s F CXX obj/gpu/gl_tests/gl_ext_multisample_compatibility_unittest.o
[21/7603] 17.73s F CXX obj/gpu/gl_tests/gl_query_unittest.o
[22/7564] 17.76s F CXX obj/gpu/gl_tests/gl_shared_resources_unittest.o
[23/7535] 17.78s F CXX obj/gpu/test_support/raster_in_process_context.o
[24/7426] 17.81s S SOLINK ./libgpu_raster.so
[24/7417] 17.83s F CXX obj/gpu/gl_tests/gl_readback_unittest.o
[25/7403] 17.84s F CXX obj/gpu/gl_tests/gl_ext_blend_func_extended_unittest.o
[26/7245] 17.92s F SOLINK ./libgpu_raster.so
[27/7208] 17.93s S SOLINK ./libviz_common.so
[27/7119] 17.95s F CXX obj/gpu/gl_tests/gl_pointcoord_unittest.o
[28/6732] 18.09s F SOLINK ./libviz_common.so
[29/6732] 18.09s S SOLINK ./libcomponents_viz_client.so
[29/6732] 18.09s S SOLINK ./libgpu_ipc_service.so
[29/6731] 18.15s F CXX obj/gpu/gl_tests/gl_clear_framebuffer_unittest.o
[30/6731] 18.16s F CXX obj/gpu/gl_tests/gl_cube_map_texture_unittest.o
[31/6731] 18.18s F SOLINK ./libcomponents_viz_client.so
[32/6730] 18.19s S SOLINK ./libmedia.so
[32/6729] 18.24s F SOLINK ./libgpu_ipc_service.so
[33/6728] 18.24s S SOLINK ./libgpu_ipc_gl_in_process_context.so
[33/6728] 18.24s S LINK ./vulkan_tests
[33/6728] 18.27s F CXX obj/gpu/gl_tests/gl_map_buffer_range_unittest.o
[34/6728] 18.29s F CXX obj/gpu/gl_tests/gl_oob_attrib_unittest.o
[35/6728] 18.32s F CXX obj/gpu/gl_tests/gl_object_bindings_unittest.o
[36/6728] 18.36s F SOLINK ./libgpu_ipc_gl_in_process_context.so
[37/6728] 18.36s S SOLINK ./libgpu_ipc_gpu_thread_holder.so
[37/6728] 18.41s F LINK ./vulkan_tests
[38/6728] 18.46s F SOLINK ./libgpu_ipc_gpu_thread_holder.so
[39/6728] 18.46s S AR obj/gpu/libtest_support.a
[39/6728] 18.48s F AR obj/gpu/libtest_support.a
[40/6728] 18.55s F CXX obj/gpu/gl_tests/gl_request_extension_unittest.o
[41/6728] 18.70s F SOLINK ./libmedia.so
[42/6723] 18.70s S SOLINK_MODULE ClearKeyCdm/_platform_specific/linux_x64/libclearkeycdm.so
[42/6723] 18.70s S SOLINK ./libmedia_webrtc.so
[42/6713] 18.70s S SOLINK ./libmedia_gpu_buffer_validation.so
[42/6710] 18.70s S LINK ./ac3_util_fuzzer
[42/6680] 18.70s S SOLINK ./libcc.so
[42/6680] 18.70s S SOLINK ./libcomponents_soda.so
[42/6617] 18.71s S SOLINK ./libaudio_public_cpp.so
[42/6617] 18.71s S SOLINK ./libservices_audio_testing_api_support.so
[42/6617] 18.71s S LINK ./enterprise_companion_tests
[42/6617] 18.71s S LINK ./session_authz_playground
[42/6617] 18.71s S LINK ./remoting_perftests
[42/6617] 18.71s S SOLINK ./libremoting_core.so
[42/6617] 18.71s S LINK ./it2me_standalone_host_main
[42/6617] 18.71s S LINK ./it2me_cli_host
[42/6617] 18.71s S SOLINK ./libmedia_capture_capture_lib.so
[42/6617] 18.77s F SOLINK_MODULE ClearKeyCdm/_platform_specific/linux_x64/libclearkeycdm.so
[43/6615] 18.79s F SOLINK ./libmedia_gpu_buffer_validation.so
[44/6603] 18.79s S SOLINK ./libmedia_gpu.so
[44/6603] 18.79s F SOLINK ./libmedia_webrtc.so
[45/6603] 18.80s F SOLINK ./libcomponents_soda.so
[46/6601] 18.82s F LINK ./ac3_util_fuzzer
[47/6601] 18.84s F CXX obj/gpu/gl_tests/compressed_texture_test.o
[48/6601] 18.86s F CXX obj/gpu/gl_tests/raster_in_process_context_tests.o
[49/6601] 18.95s F CXX obj/gpu/gl_tests/gl_copy_texture_CHROMIUM_unittest.o	
FAILED: b47b87dc-5456-41b1-a634-f7036e6b2462 "./obj/gpu/gl_tests/gl_copy_texture_CHROMIUM_unittest.o" CXX obj/gpu/gl_tests/gl_copy_texture_CHROMIUM_unittest.o
err: exit=1
../../third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/gpu/gl_tests/gl_copy_texture_CHROMIUM_unittest.o.d -DGL_GLEXT_PROTOTYPES -DDCHECK_ALWAYS_ON=1 -DUSE_UDEV -DUSE_AURA=1 -DUSE_GLIB=1 -DUSE_OZONE=1 -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_GNU_SOURCE -DCR_CLANG_REVISION=\"llvmorg-21-init-1655-g7b473dfe-1\" -D_LIBCPP_HARDENING_MODE=_LIBCPP_HARDENING_MODE_EXTENSIVE -DCOMPONENT_BUILD -D_LIBCPP_INSTRUMENTED_WITH_ASAN=0 -DCR_LIBCXX_REVISION=4f05e20cbe1d02fa0871ac88b30eead9e38cab3a -DTMP_REBUILD_HACK -DCR_SYSROOT_KEY=20250129T203412Z-1 -D_DEBUG -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DGLIB_VERSION_MAX_ALLOWED=GLIB_VERSION_2_56 -DGLIB_VERSION_MIN_REQUIRED=GLIB_VERSION_2_56 -DSK_ENABLE_SKSL -DSK_UNTIL_CRBUG_1187654_IS_FIXED -DSK_USER_CONFIG_HEADER=\"../../skia/config/SkUserConfig.h\" -DSK_WIN_FONTMGR_NO_SIMULATIONS -DSK_DISABLE_LEGACY_INIT_DECODERS -DSK_CODEC_DECODES_JPEG -DSK_CODEC_ENCODES_JPEG -DSKIA_DLL -DSKCMS_API=__attribute__\(\(visibility\(\"default\"\)\)\) -DSK_GAMMA_EXPONENT=1.2 -DSK_GAMMA_CONTRAST=0.2 -DSK_GANESH -DSK_GPU_WORKAROUNDS_HEADER=\"gpu/config/gpu_driver_bug_workaround_autogen.h\" -DSK_GL -DSK_VULKAN=1 -DSK_GRAPHITE -DSK_DAWN -DVK_USE_PLATFORM_XCB_KHR -DVK_USE_PLATFORM_WAYLAND_KHR -DCHROMIUM -DLIBYUV_DISABLE_NEON -DLIBYUV_DISABLE_SVE -DLIBYUV_DISABLE_SME -DLIBYUV_DISABLE_LSX -DLIBYUV_DISABLE_LASX -DABSL_CONSUME_DLL -DABSL_FLAGS_STRIP_NAMES=0 -DCR_CXX_INCLUDE=\"third_party/rust/chromium_crates_io/vendor/cxx-1.0.146/include/cxx.h\" -DBORINGSSL_SHARED_LIBRARY -DWGPU_SHARED_LIBRARY -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DUSE_CHROMIUM_ICU=1 -DU_ENABLE_TRACING=1 -DU_ENABLE_RESOURCE_TRACING=0 -DICU_UTIL_DATA_IMPL=ICU_UTIL_DATA_FILE -DCRASHPAD_ZLIB_SOURCE_EXTERNAL -DGTEST_API_= -DGTEST_HAS_POSIX_RE=0 -DGTEST_LANG_CXX11=1 -DGTEST_HAS_TR1_TUPLE=0 -DGTEST_HAS_ABSL -DGTEST_NO_ABSL_FLAGS -DUNIT_TEST -DANGLE_DELEGATE_WORKERS=1 -DANGLE_USE_ABSEIL -DABSL_ALLOCATOR_NOTHROW=1 -DGOOGLE_PROTOBUF_NO_RTTI -DHAVE_PTHREAD -DPROTOBUF_USE_DLLS -DVK_NO_PROTOTYPES -DUSE_VULKAN_XCB -DDAWN_NATIVE_SHARED_LIBRARY -I../.. -Igen -I../../buildtools/third_party/libc++ -I../../third_party/khronos -I../../gpu -I../../third_party/perfetto/include -Igen/third_party/perfetto/build_config -Igen/third_party/perfetto -I../../third_party/skia -Igen/third_party/skia -I../../third_party/wuffs/src/release/c -I../../third_party/vulkan/include -I../../third_party/vulkan-headers/src/include -I../../third_party/wayland/src/src -I../../third_party/wayland/include/src -Igen/third_party/dawn/include -I../../third_party/dawn/include -I../../net/third_party/quiche/overrides -I../../net/third_party/quiche/src/quiche/common/platform/default -I../../net/third_party/quiche/src -I../../third_party/libyuv/include -I../../third_party/google_benchmark/src/include -I../../base/allocator/partition_allocator/src -Igen/base/allocator/partition_allocator/src -I../../third_party/abseil-cpp -I../../third_party/boringssl/src/include -I../../third_party/protobuf/src -I../../third_party/ipcz/include -I../../third_party/icu/source/common -I../../third_party/icu/source/i18n -I../../third_party/ced/src -I../../third_party/crashpad/crashpad -I../../third_party/crashpad/crashpad/compat/linux -I../../third_party/crashpad/crashpad/compat/non_win -I../../third_party/zlib -I../../third_party/angle/include -I../../third_party/mesa_headers -I../../third_party/googletest/custom -I../../third_party/googletest/src/googlemock/include -I../../third_party/googletest/src/googletest/include -I../../third_party/re2/src -I../../third_party/angle/src/common/base -I../../third_party/angle/src/common/third_party/xxhash -Igen/net/third_party/quiche/src -I../../third_party/wayland/include -I../../third_party/wayland/src/cursor -I../../third_party/wayland/src/egl -Igen/third_party/wayland/src/protocol -Wall -Wextra -Wimplicit-fallthrough -Wextra-semi -Wunreachable-code-aggressive -Wthread-safety -Wgnu -Wno-gnu-anonymous-struct -Wno-gnu-conditional-omitted-operand -Wno-gnu-include-next -Wno-gnu-label-as-value -Wno-gnu-redeclared-enum -Wno-gnu-statement-expression -Wno-gnu-zero-variadic-macro-arguments -Wno-zero-length-array -Wno-missing-field-initializers -Wno-unused-parameter -Wno-psabi -Wloop-analysis -Wno-unneeded-internal-declaration -Wno-cast-function-type -Wno-thread-safety-reference-return -Wno-nontrivial-memcall -Wshadow -Werror -fno-delete-null-pointer-checks -fno-strict-overflow -fno-ident -fno-strict-aliasing -fstack-protector -funwind-tables -fPIC -pthread -fcolor-diagnostics -fmerge-all-constants -fno-sized-deallocation -fcrash-diagnostics-dir=../../tools/clang/crashreports -mllvm -instcombine-lower-dbg-declare=0 -mllvm -split-threshold-for-reg-with-hint=0 -ffp-contract=off -Wa,--crel,--allow-experimental-crel -fcomplete-member-pointers -m64 -msse3 -Wno-builtin-macro-redefined -D__DATE__= -D__TIME__= -D__TIMESTAMP__= -ffile-compilation-dir=. -no-canonical-prefixes -ftrivial-auto-var-init=pattern -O0 -fno-omit-frame-pointer -gdwarf-4 -g2 -gdwarf-aranges -gsplit-dwarf -ggnu-pubnames -Xclang -fuse-ctor-homing -fvisibility=hidden -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -Xclang -add-plugin -Xclang find-bad-constructs -Xclang -plugin-arg-find-bad-constructs -Xclang span-ctor-from-string-literal -Xclang -plugin-arg-find-bad-constructs -Xclang raw-ref-template-as-trivial-member -Xclang -plugin-arg-find-bad-constructs -Xclang raw-span-template-as-trivial-member -Xclang -plugin-arg-find-bad-constructs -Xclang check-stack-allocated -Xclang -plugin-arg-find-bad-constructs -Xclang check-ipc -Xclang -add-plugin -Xclang raw-ptr-plugin -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-raw-ptr-to-stack-allocated -Xclang -plugin-arg-raw-ptr-plugin -Xclang disable-check-raw-ptr-to-stack-allocated-error -Xclang -plugin-arg-raw-ptr-plugin -Xclang raw-ptr-exclude-path=../../third_party/dawn/ -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-raw-ptr-fields -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-span-fields -Xclang -plugin-arg-raw-ptr-plugin -Xclang check-raw-ref-fields -DUNSAFE_BUFFERS_BUILD -Xclang -add-plugin -Xclang unsafe-buffers -Xclang -plugin-arg-unsafe-buffers -Xclang ../../build/config/unsafe_buffers_paths.txt -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/glib-2.0 -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/lib/x86_64-linux-gnu/glib-2.0/include -Wno-redundant-parens -Wno-redundant-parens -Wno-inconsistent-missing-override -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/nss -isystem../../build/linux/debian_bullseye_amd64-sysroot/usr/include/nspr -Wno-invalid-offsetof -Wenum-compare-conditional -Wno-c++11-narrowing-const-reference -Wno-missing-template-arg-list-after-template-kw -Wno-undefined-bool-conversion -Wno-tautological-undefined-compare -std=c++20 -Wno-trigraphs -gsimple-template-names -fno-exceptions -fno-rtti -nostdinc++ -isystem../../third_party/libc++/src/include -isystem../../third_party/libc++abi/src/include --sysroot=../../build/linux/debian_bullseye_amd64-sysroot -fvisibility-inlines-hidden  -c ../../gpu/command_buffer/tests/gl_copy_texture_CHROMIUM_unittest.cc -o obj/gpu/gl_tests/gl_copy_texture_CHROMIUM_unittest.o
build step: cxx "./obj/gpu/gl_tests/gl_copy_texture_CHROMIUM_unittest.o"
siso_rule: clang/cxx
stderr:
../../gpu/command_buffer/tests/gl_copy_texture_CHROMIUM_unittest.cc:334:20: error: incompatible operand types ('uint8_t[4]' (aka 'unsigned char[4]') and 'std::array<uint8_t, 4>' (aka 'array<unsigned char, 4>'))
  334 |               (alt ? alt_expected_color : expected_color)[j];
      |                    ^ ~~~~~~~~~~~~~~~~~~   ~~~~~~~~~~~~~~
1 error generated.


[50/6601] 18.99s F CXX obj/gpu/gl_tests/gl_ext_window_rectangles_unittest.o
[50/6601] 18.99s F CXX obj/gpu/gl_tests/gl_deschedule_unittest.o
[50/6601] 18.99s F CXX obj/gpu/gl_tests/gl_test_setup_helper.o
[50/6601] 19.00s F CXX obj/gpu/gl_tests/gl_lose_context_chromium_unittest.o
[50/6601] 19.00s F CXX obj/gpu/gl_tests/gl_depth_texture_unittest.o
[50/6601] 19.00s F CXX obj/gpu/gpu_unittests/raster_implementation_unittest.o
[50/6601] 19.01s F CXX obj/components/viz/test/test_support/test_in_process_context_provider.o
[50/6601] 19.01s F CXX obj/gpu/gl_tests/gl_gpu_memory_buffer_unittest.o
[50/6601] 19.01s F CXX obj/gpu/gl_tests/es3_misc_functions_unittest.o
[50/6601] 19.02s F CXX obj/gpu/gl_tests/gl_tests_main.o
[50/6601] 19.02s F CXX obj/cc/cc_unittests/oop_pixeltest.o
[50/6601] 19.02s F CXX obj/services/viz/public/cpp/gpu/gpu/context_provider_command_buffer.o
[50/6601] 19.03s F SOLINK ./libcc.so
[50/6601] 19.03s F CXX obj/gpu/gl_tests/gl_bind_uniform_location_unittest.o
[50/6601] 19.03s F CXX obj/cc/cc_unittests/transfer_cache_unittest.o
[50/6601] 19.14s F SOLINK ./libservices_audio_testing_api_support.so
[50/6601] 19.14s F SOLINK ./libaudio_public_cpp.so
[50/6601] 19.27s F SOLINK ./libmedia_capture_capture_lib.so
[50/6601] 19.35s F SOLINK ./libremoting_core.so
[50/6601] 19.38s F SOLINK ./libmedia_gpu.so
[50/6601] 19.40s F LINK ./enterprise_companion_tests
[50/6601] 19.42s F LINK ./remoting_perftests
[50/6601] 19.43s F LINK ./session_authz_playground
[50/6601] 19.45s F LINK ./it2me_standalone_host_main
[50/6601] 19.45s F LINK ./it2me_cli_host
build failed	

	
local:50 remote:0 cache:0 fallback:0 retry:0 skip:111310
fs: ops: 1576(err:1080) / r:708(err:0) 402.95MiB / w:27(err:0) 701.16KiB


```
